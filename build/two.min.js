(function(){function n(b,k,q){if(b===k)return 0!==b||1/b==1/k;if(null==b||null==k)return b===k;b._chain&&(b=b._wrapped);k._chain&&(k=k._wrapped);if(b.isEqual&&d.isFunction(b.isEqual))return b.isEqual(k);if(k.isEqual&&d.isFunction(k.isEqual))return k.isEqual(b);var I=a.call(b);if(I!=a.call(k))return!1;switch(I){case "[object String]":return b==String(k);case "[object Number]":return b!=+b?k!=+k:0==b?1/b==1/k:b==+k;case "[object Date]":case "[object Boolean]":return+b==+k;case "[object RegExp]":return b.source==
k.source&&b.global==k.global&&b.multiline==k.multiline&&b.ignoreCase==k.ignoreCase}if("object"!=typeof b||"object"!=typeof k)return!1;for(var c=q.length;c--;)if(q[c]==b)return!0;q.push(b);var c=0,f=!0;if("[object Array]"==I){if(c=b.length,f=c==k.length)for(;c--&&(f=c in b==c in k&&n(b[c],k[c],q)););}else{if("constructor"in b!="constructor"in k||b.constructor!=k.constructor)return!1;for(var l in b)if(d.has(b,l)&&(c++,!(f=d.has(k,l)&&n(b[l],k[l],q))))break;if(f){for(l in k)if(d.has(k,l)&&!c--)break;
f=!c}}q.pop();return f}var e=this,j=e._,m={},h=Array.prototype,c=Object.prototype,g=h.slice,f=h.unshift,a=c.toString,l=c.hasOwnProperty,x=h.forEach,y=h.map,A=h.reduce,p=h.reduceRight,t=h.filter,G=h.every,D=h.some,H=h.indexOf,L=h.lastIndexOf,c=Array.isArray,B=Object.keys,s=Function.prototype.bind,d=function(b){return new C(b)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports._=d):e._=d;d.VERSION="1.3.3";var r=d.each=d.forEach=function(b,
k,q){if(null!=b)if(x&&b.forEach===x)b.forEach(k,q);else if(b.length===+b.length)for(var a=0,c=b.length;a<c&&!(a in b&&k.call(q,b[a],a,b)===m);a++);else for(a in b)if(d.has(b,a)&&k.call(q,b[a],a,b)===m)break};d.map=d.collect=function(b,k,d){var a=[];if(null==b)return a;if(y&&b.map===y)return b.map(k,d);r(b,function(b,c,f){a[a.length]=k.call(d,b,c,f)});b.length===+b.length&&(a.length=b.length);return a};d.reduce=d.foldl=d.inject=function(b,k,q,a){var c=2<arguments.length;null==b&&(b=[]);if(A&&b.reduce===
A)return a&&(k=d.bind(k,a)),c?b.reduce(k,q):b.reduce(k);r(b,function(b,d,f){c?q=k.call(a,q,b,d,f):(q=b,c=!0)});if(!c)throw new TypeError("Reduce of empty array with no initial value");return q};d.reduceRight=d.foldr=function(b,k,q,a){var c=2<arguments.length;null==b&&(b=[]);if(p&&b.reduceRight===p)return a&&(k=d.bind(k,a)),c?b.reduceRight(k,q):b.reduceRight(k);var f=d.toArray(b).reverse();a&&!c&&(k=d.bind(k,a));return c?d.reduce(f,k,q,a):d.reduce(f,k)};d.find=d.detect=function(b,k,d){var a;u(b,function(b,
c,f){if(k.call(d,b,c,f))return a=b,!0});return a};d.filter=d.select=function(b,d,q){var a=[];if(null==b)return a;if(t&&b.filter===t)return b.filter(d,q);r(b,function(b,c,f){d.call(q,b,c,f)&&(a[a.length]=b)});return a};d.reject=function(b,d,q){var a=[];if(null==b)return a;r(b,function(b,c,f){d.call(q,b,c,f)||(a[a.length]=b)});return a};d.every=d.all=function(b,d,q){var a=!0;if(null==b)return a;if(G&&b.every===G)return b.every(d,q);r(b,function(b,c,f){if(!(a=a&&d.call(q,b,c,f)))return m});return!!a};
var u=d.some=d.any=function(b,k,a){k||(k=d.identity);var c=!1;if(null==b)return c;if(D&&b.some===D)return b.some(k,a);r(b,function(b,d,f){if(c||(c=k.call(a,b,d,f)))return m});return!!c};d.include=d.contains=function(b,d){var a=!1;return null==b?a:H&&b.indexOf===H?-1!=b.indexOf(d):a=u(b,function(b){return b===d})};d.invoke=function(b,k){var a=g.call(arguments,2);return d.map(b,function(b){return(d.isFunction(k)?k||b:b[k]).apply(b,a)})};d.pluck=function(b,k){return d.map(b,function(b){return b[k]})};
d.max=function(b,k,a){if(!k&&d.isArray(b)&&b[0]===+b[0])return Math.max.apply(Math,b);if(!k&&d.isEmpty(b))return-Infinity;var c={computed:-Infinity};r(b,function(b,d,f){d=k?k.call(a,b,d,f):b;d>=c.computed&&(c={value:b,computed:d})});return c.value};d.min=function(b,k,a){if(!k&&d.isArray(b)&&b[0]===+b[0])return Math.min.apply(Math,b);if(!k&&d.isEmpty(b))return Infinity;var c={computed:Infinity};r(b,function(b,d,f){d=k?k.call(a,b,d,f):b;d<c.computed&&(c={value:b,computed:d})});return c.value};d.shuffle=
function(b){var d=[],a;r(b,function(b,c){a=Math.floor(Math.random()*(c+1));d[c]=d[a];d[a]=b});return d};d.sortBy=function(b,k,a){var c=d.isFunction(k)?k:function(b){return b[k]};return d.pluck(d.map(b,function(b,d,k){return{value:b,criteria:c.call(a,b,d,k)}}).sort(function(b,d){var k=b.criteria,a=d.criteria;return void 0===k?1:void 0===a?-1:k<a?-1:k>a?1:0}),"value")};d.groupBy=function(b,k){var a={},c=d.isFunction(k)?k:function(b){return b[k]};r(b,function(b,d){var k=c(b,d);(a[k]||(a[k]=[])).push(b)});
return a};d.sortedIndex=function(b,k,a){a||(a=d.identity);for(var c=0,f=b.length;c<f;){var l=c+f>>1;a(b[l])<a(k)?c=l+1:f=l}return c};d.toArray=function(b){return!b?[]:d.isArray(b)||d.isArguments(b)?g.call(b):b.toArray&&d.isFunction(b.toArray)?b.toArray():d.values(b)};d.size=function(b){return d.isArray(b)?b.length:d.keys(b).length};d.first=d.head=d.take=function(b,d,a){return null!=d&&!a?g.call(b,0,d):b[0]};d.initial=function(b,d,a){return g.call(b,0,b.length-(null==d||a?1:d))};d.last=function(b,
d,a){return null!=d&&!a?g.call(b,Math.max(b.length-d,0)):b[b.length-1]};d.rest=d.tail=function(b,d,a){return g.call(b,null==d||a?1:d)};d.compact=function(b){return d.filter(b,function(b){return!!b})};d.flatten=function(b,a){return d.reduce(b,function(b,c){if(d.isArray(c))return b.concat(a?c:d.flatten(c));b[b.length]=c;return b},[])};d.without=function(b){return d.difference(b,g.call(arguments,1))};d.uniq=d.unique=function(b,a,c){c=c?d.map(b,c):b;var f=[];3>b.length&&(a=!0);d.reduce(c,function(c,q,
l){if(a?d.last(c)!==q||!c.length:!d.include(c,q))c.push(q),f.push(b[l]);return c},[]);return f};d.union=function(){return d.uniq(d.flatten(arguments,!0))};d.intersection=d.intersect=function(b){var a=g.call(arguments,1);return d.filter(d.uniq(b),function(b){return d.every(a,function(a){return 0<=d.indexOf(a,b)})})};d.difference=function(b){var a=d.flatten(g.call(arguments,1),!0);return d.filter(b,function(b){return!d.include(a,b)})};d.zip=function(){for(var b=g.call(arguments),a=d.max(d.pluck(b,"length")),
c=Array(a),f=0;f<a;f++)c[f]=d.pluck(b,""+f);return c};d.indexOf=function(b,a,c){if(null==b)return-1;var f;if(c)return c=d.sortedIndex(b,a),b[c]===a?c:-1;if(H&&b.indexOf===H)return b.indexOf(a);c=0;for(f=b.length;c<f;c++)if(c in b&&b[c]===a)return c;return-1};d.lastIndexOf=function(b,d){if(null==b)return-1;if(L&&b.lastIndexOf===L)return b.lastIndexOf(d);for(var a=b.length;a--;)if(a in b&&b[a]===d)return a;return-1};d.range=function(b,d,a){1>=arguments.length&&(d=b||0,b=0);a=arguments[2]||1;for(var c=
Math.max(Math.ceil((d-b)/a),0),f=0,l=Array(c);f<c;)l[f++]=b,b+=a;return l};var v=function(){};d.bind=function(b,a){var c,f;if(b.bind===s&&s)return s.apply(b,g.call(arguments,1));if(!d.isFunction(b))throw new TypeError;f=g.call(arguments,2);return c=function(){if(!(this instanceof c))return b.apply(a,f.concat(g.call(arguments)));v.prototype=b.prototype;var d=new v,l=b.apply(d,f.concat(g.call(arguments)));return Object(l)===l?l:d}};d.bindAll=function(b){var a=g.call(arguments,1);0==a.length&&(a=d.functions(b));
r(a,function(a){b[a]=d.bind(b[a],b)});return b};d.memoize=function(b,a){var c={};a||(a=d.identity);return function(){var f=a.apply(this,arguments);return d.has(c,f)?c[f]:c[f]=b.apply(this,arguments)}};d.delay=function(b,d){var a=g.call(arguments,2);return setTimeout(function(){return b.apply(null,a)},d)};d.defer=function(b){return d.delay.apply(d,[b,1].concat(g.call(arguments,1)))};d.throttle=function(b,a){var c,f,l,g,e,h,p=d.debounce(function(){e=g=!1},a);return function(){c=this;f=arguments;l||
(l=setTimeout(function(){l=null;e&&b.apply(c,f);p()},a));g?e=!0:h=b.apply(c,f);p();g=!0;return h}};d.debounce=function(b,d,a){var c;return function(){var f=this,l=arguments;a&&!c&&b.apply(f,l);clearTimeout(c);c=setTimeout(function(){c=null;a||b.apply(f,l)},d)}};d.once=function(b){var d=!1,a;return function(){if(d)return a;d=!0;return a=b.apply(this,arguments)}};d.wrap=function(b,d){return function(){var a=[b].concat(g.call(arguments,0));return d.apply(this,a)}};d.compose=function(){var b=arguments;
return function(){for(var d=arguments,a=b.length-1;0<=a;a--)d=[b[a].apply(this,d)];return d[0]}};d.after=function(b,d){return 0>=b?d():function(){if(1>--b)return d.apply(this,arguments)}};d.keys=B||function(b){if(b!==Object(b))throw new TypeError("Invalid object");var a=[],c;for(c in b)d.has(b,c)&&(a[a.length]=c);return a};d.values=function(b){return d.map(b,d.identity)};d.functions=d.methods=function(b){var a=[],c;for(c in b)d.isFunction(b[c])&&a.push(c);return a.sort()};d.extend=function(b){r(g.call(arguments,
1),function(d){for(var a in d)b[a]=d[a]});return b};d.pick=function(b){var a={};r(d.flatten(g.call(arguments,1)),function(d){d in b&&(a[d]=b[d])});return a};d.defaults=function(b){r(g.call(arguments,1),function(d){for(var a in d)null==b[a]&&(b[a]=d[a])});return b};d.clone=function(b){return!d.isObject(b)?b:d.isArray(b)?b.slice():d.extend({},b)};d.tap=function(b,d){d(b);return b};d.isEqual=function(b,d){return n(b,d,[])};d.isEmpty=function(b){if(null==b)return!0;if(d.isArray(b)||d.isString(b))return 0===
b.length;for(var a in b)if(d.has(b,a))return!1;return!0};d.isElement=function(b){return!!(b&&1==b.nodeType)};d.isArray=c||function(b){return"[object Array]"==a.call(b)};d.isObject=function(b){return b===Object(b)};d.isArguments=function(b){return"[object Arguments]"==a.call(b)};d.isArguments(arguments)||(d.isArguments=function(b){return!(!b||!d.has(b,"callee"))});d.isFunction=function(b){return"[object Function]"==a.call(b)};d.isString=function(b){return"[object String]"==a.call(b)};d.isNumber=function(b){return"[object Number]"==
a.call(b)};d.isFinite=function(b){return d.isNumber(b)&&isFinite(b)};d.isNaN=function(b){return b!==b};d.isBoolean=function(b){return!0===b||!1===b||"[object Boolean]"==a.call(b)};d.isDate=function(b){return"[object Date]"==a.call(b)};d.isRegExp=function(b){return"[object RegExp]"==a.call(b)};d.isNull=function(b){return null===b};d.isUndefined=function(b){return void 0===b};d.has=function(b,d){return l.call(b,d)};d.noConflict=function(){e._=j;return this};d.identity=function(b){return b};d.times=
function(b,d,a){for(var c=0;c<b;c++)d.call(a,c)};d.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.result=function(b,a){if(null==b)return null;var c=b[a];return d.isFunction(c)?c.call(b):c};d.mixin=function(b){r(d.functions(b),function(a){var c=d[a]=b[a];C.prototype[a]=function(){var b=g.call(arguments);f.call(b,this._wrapped);return J(c.apply(d,b),this._chain)}})};var E=0;d.uniqueId=
function(b){var d=E++;return b?b+d:d};d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var w=/.^/,z={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},F;for(F in z)z[z[F]]=F;var M=/\\|'|\r|\n|\t|\u2028|\u2029/g,N=/\\(\\|'|r|n|t|u2028|u2029)/g,K=function(b){return b.replace(N,function(b,d){return z[d]})};d.template=function(b,a,c){c=d.defaults(c||{},d.templateSettings);b="__p+='"+b.replace(M,function(b){return"\\"+z[b]}).replace(c.escape||
w,function(b,d){return"'+\n_.escape("+K(d)+")+\n'"}).replace(c.interpolate||w,function(b,d){return"'+\n("+K(d)+")+\n'"}).replace(c.evaluate||w,function(b,d){return"';\n"+K(d)+"\n;__p+='"})+"';\n";c.variable||(b="with(obj||{}){\n"+b+"}\n");b="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+b+"return __p;\n";var f=new Function(c.variable||"obj","_",b);if(a)return f(a,d);a=function(b){return f.call(this,b,d)};a.source="function("+(c.variable||"obj")+"){\n"+b+"}";return a};
d.chain=function(b){return d(b).chain()};var C=function(b){this._wrapped=b};d.prototype=C.prototype;var J=function(b,a){return a?d(b).chain():b};d.mixin(d);r("pop push reverse shift sort splice unshift".split(" "),function(b){var d=h[b];C.prototype[b]=function(){var a=this._wrapped;d.apply(a,arguments);var c=a.length;("shift"==b||"splice"==b)&&0===c&&delete a[0];return J(a,this._chain)}});r(["concat","join","slice"],function(b){var d=h[b];C.prototype[b]=function(){return J(d.apply(this._wrapped,arguments),
this._chain)}});C.prototype.chain=function(){this._chain=!0;return this};C.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var n=[].slice,e=/\s+/,j=function(c,g,f,a){if(!f)return!0;if("object"===typeof f)for(var l in f)c[g].apply(c,[l,f[l]].concat(a));else if(e.test(f)){f=f.split(e);l=0;for(var h=f.length;l<h;l++)c[g].apply(c,[f[l]].concat(a))}else return!0},m=function(c,g,f){var a;c=-1;var l=g.length;switch(f.length){case 0:for(;++c<l;)(a=g[c]).callback.call(a.ctx);break;case 1:for(;++c<l;)(a=g[c]).callback.call(a.ctx,f[0]);break;case 2:for(;++c<l;)(a=g[c]).callback.call(a.ctx,f[0],f[1]);break;case 3:for(;++c<
l;)(a=g[c]).callback.call(a.ctx,f[0],f[1],f[2]);break;default:for(;++c<l;)(a=g[c]).callback.apply(a.ctx,f)}},h=Backbone.Events={on:function(c,g,f){if(!j(this,"on",c,[g,f])||!g)return this;this._events||(this._events={});(this._events[c]||(this._events[c]=[])).push({callback:g,context:f,ctx:f||this});return this},once:function(c,g,f){if(!j(this,"once",c,[g,f])||!g)return this;var a=this,l=_.once(function(){a.off(c,l);g.apply(this,arguments)});l._callback=g;this.on(c,l,f);return this},off:function(c,
g,f){var a,l,e,h,A,p,t,G;if(!this._events||!j(this,"off",c,[g,f]))return this;if(!c&&!g&&!f)return this._events={},this;h=c?[c]:_.keys(this._events);A=0;for(p=h.length;A<p;A++)if(c=h[A],a=this._events[c]){e=[];if(g||f){t=0;for(G=a.length;t<G;t++)l=a[t],(g&&g!==(l.callback._callback||l.callback)||f&&f!==l.context)&&e.push(l)}this._events[c]=e}return this},trigger:function(c){if(!this._events)return this;var e=n.call(arguments,1);if(!j(this,"trigger",c,e))return this;var f=this._events[c],a=this._events.all;
f&&m(this,f,e);a&&m(this,a,arguments);return this},listenTo:function(c,e,f){var a=this._listeners||(this._listeners={}),l=c._listenerId||(c._listenerId=_.uniqueId("l"));a[l]=c;c.on(e,f||this,this);return this},stopListening:function(c,e,f){var a=this._listeners;if(a){if(c)c.off(e,f,this),!e&&!f&&delete a[c._listenerId];else{for(var l in a)a[l].off(null,null,this);this._listeners={}}return this}}};h.bind=h.on;h.unbind=h.off})();(function(){for(var n=0,e=["ms","moz","webkit","o"],j=0;j<e.length&&!window.requestAnimationFrame;++j)window.requestAnimationFrame=window[e[j]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[j]+"CancelAnimationFrame"]||window[e[j]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var h=(new Date).getTime(),c=Math.max(0,16-(h-n)),g=window.setTimeout(function(){e(h+c)},c);n=h+c;return g});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(e){clearTimeout(e)})})();(function(){function n(){var a=document.body.getBoundingClientRect(),c=this.width=a.width,a=this.height=a.height;this.renderer.setSize(c,a);this.trigger(f.Events.resize,c,a)}var e=this,j=e.Two||{},m=2*Math.PI,h=Math.cos,c=Math.sin,g={hasEventListeners:_.isFunction(e.addEventListener),bind:function(a,c,f,e){this.hasEventListeners?a.addEventListener(c,f,!!e):a.attachEvent("on"+c,f);return this},unbind:function(a,c,f,e){this.hasEventListeners?a.removeEventListeners(c,f,!!e):a.detachEvent("on"+c,f);return this}},
f=e.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:f.Types.svg,autostart:!0});this.type=a.type;this.renderer=new f[this.type](this);this.playing=a.autostart;this.frameCount=0;a.fullscreen?(a=_.bind(n,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),g.bind(window,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);this.scene=new f.Group;this.renderer.add(this.scene);
f.Instances.push(this)};_.extend(f,{Array:e.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,Instances:[],noConflict:function(){e.Two=j;return this}});_.extend(f.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){this.playing=!0;return this.trigger(f.Events.play)},
pause:function(){this.playing=!1;return this.trigger(f.Events.pause)},update:function(){this.frameCount++;var a=this.width,c=this.height,e=this.renderer;(a!==e.width||c!==e.height)&&e.setSize(a,c);return this.trigger(f.Events.update,this.frameCount)},render:function(){this.renderer.render();return this.trigger(f.Events.render,this.frameCount)},add:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));this.scene.add(c);return this},makeLine:function(a,c,e,h){e=(e-a)/2;h=(h-c)/2;var g=[new f.Vector(-e,
-h),new f.Vector(e,h)],g=(new f.Polygon(g)).noFill();g.translation.set(a+e,c+h);this.scene.add(g);return g},makeRectangle:function(a,c,e,h){e/=2;h/=2;h=[new f.Vector(e,h),new f.Vector(-e,h),new f.Vector(-e,-h),new f.Vector(e,-h)];h=new f.Polygon(h,!0);h.translation.set(a,c);this.scene.add(h);return h},makeCircle:function(a,c,f){return this.makeEllipse(a,c,f,f)},makeEllipse:function(a,e,g,j){var A=f.Resolution,p=_.map(_.range(A),function(a){var e=a/A*m;a=g*h(e);e=j*c(e);return new f.Vector(a,e)},this),
p=new f.Polygon(p,!0,!0);p.translation.set(a,e);this.scene.add(p);return p},makeCurve:function(a){var c=arguments.length,e=a;if(!_.isArray(a))for(var e=[],h=0;h<c;h+=2){var g=arguments[h];if(!_.isNumber(g))break;e.push(new f.Vector(g,arguments[h+1]))}var c=arguments[c-1],e=new f.Polygon(e,!(_.isBoolean(c)&&c),!0),c=e.getBoundingClientRect(),p=c.left+c.width/2,j=c.top+c.height/2;_.each(e.vertices,function(a){a.x-=p;a.y-=j});e.translation.set(p,j);this.scene.add(e);return e},makePolygon:function(a){var c=
arguments.length,e=a;if(!_.isArray(a))for(var e=[],h=0;h<c;h+=2){var g=arguments[h];if(!_.isNumber(g))break;e.push(new f.Vector(g,arguments[h+1]))}var c=arguments[c-1],e=new f.Polygon(e,!(_.isBoolean(c)&&c)),c=e.getBoundingClientRect(),p=c.left+c.width/2,j=c.top+c.height/2;_.each(e.vertices,function(a){a.x-=p;a.y-=j});e.translation.set(p,j);this.scene.add(e);return e},makeGroup:function(){var a=new f.Group;this.scene.add(a);a.add(_.toArray(arguments));return a}});(function(){_.each(f.Instances,function(a){a.playing&&
a.update().render()});requestAnimationFrame(arguments.callee)})()})();(function(){function n(a){var c={},f=a.translation,e=a.rotation,h=a.scale,g=a.stroke,l=a.linewidth,j=a.fill,m=a.opacity,d=a.visible,n=a.cap,u=a.join,v=a.miter,E=a.curved,w=a.closed,z=a.vertices;a.id&&(c.id=y.Identifier+a.id);f&&(_.isNumber(h)&&_.isNumber(e))&&(c.transform="translate("+f.x+","+f.y+") scale("+h+") rotate("+e+")");g&&(c.stroke=g);j&&(c.fill=j);m&&(c["stroke-opacity"]=c["fill-opacity"]=m);d&&(c.visibility=d?"visible":"hidden");n&&(c["stroke-linecap"]=n);u&&(c["stroke-linejoin"]=u);v&&
(c["stroke-miterlimit"]=v);l&&(c["stroke-width"]=l);z&&(c.d=x.toString(z,w,E));return c}function e(a,c){var e=a.x-c.x,h=a.y-c.y;return f(e*e+h*h)}function j(a,c){for(;0>a;)a+=c;return a%c}var m=0,h=Math.sin,c=Math.cos,g=Math.atan2,f=Math.sqrt,a=Math.PI,l=a/2,x={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(a,c){var f=a.toLowerCase(),e=document.createElementNS(this.ns,f);"svg"===f&&(c=_.defaults(c||{},{version:this.version}));_.isObject(c)&&
this.setAttributes(e,c);return e},setAttributes:function(a,c){_.each(c,function(a,c){this.setAttribute(c,a)},a);return this},removeAttributes:function(a,c){_.each(c,function(a){this.removeAttribute(a)},a);return this},toString:function(f,p,m){var n=f.length,D=n-1;if(!m)return _.map(f,function(a,d){var c;c=(0>=d?"M":"L")+(" "+a.x.toFixed(3)+" "+a.y.toFixed(3));d>=D&&p&&(c+=" Z");return c}).join(" ");var y=[];m=f.length;for(var x=m-1,B=0;B<m;B++){var s=f[B],s={x:s.x,y:s.y};y.push(s);var d=p?j(B-1,m):
Math.max(B-1,0),r=p?j(B+1,m):Math.min(B+1,x);var u=f[d],d=s,v=f[r],r=g(u.y-d.y,u.x-d.x),E=g(v.y-d.y,v.x-d.x),u=e(u,d),v=e(v,d),w=(r+E)/2,z=void 0,F=void 0;1E-4>u||1E-4>v?(d.u={x:d.x,y:d.y},d.v={x:d.x,y:d.y}):(u*=0.33,v*=0.33,w=E<r?w+l:w-l,z={x:d.x+c(w)*u,y:d.y+h(w)*u},w-=a,F={x:d.x+c(w)*v,y:d.y+h(w)*v},d.u=z,d.v=F);!s.u.x&&!s.u.y&&(s.u.x=s.x,s.u.y=s.y);!s.v.x&&!s.v.y&&(s.v.x=s.x,s.v.y=s.y)}return _.map(y,function(a,d){var c,f=p?j(d-1,n):Math.max(d-1,0),e=p?j(d+1,n):Math.min(d+1,D);c=y[f];var e=y[e],
f=c.v.x.toFixed(3),b=c.v.y.toFixed(3),h=a.u.x.toFixed(3),g=a.u.y.toFixed(3),l=a.x.toFixed(3),m=a.y.toFixed(3);c=0>=d?"M "+l+" "+m:"C "+f+" "+b+" "+h+" "+g+" "+l+" "+m;d>=D&&p&&(f=a.v.x.toFixed(3),b=a.v.y.toFixed(3),h=e.u.x.toFixed(3),g=e.u.y.toFixed(3),l=e.x.toFixed(3),m=e.y.toFixed(3),c=c+(" C "+f+" "+b+" "+h+" "+g+" "+l+" "+m)+" Z");return c}).join(" ")}},y=Two[Two.Types.svg]=function(a){this.two=a;this.domElement=x.createElement("svg");this.elements=[];this.commands=[]};_.extend(y,{Identifier:"two-"});
_.extend(y.prototype,Backbone.Events,{setSize:function(a,c){this.width=a;this.height=c;x.setAttributes(this.domElement,{width:a,height:c});return this},add:function(a){var c=a,f=this.elements,e=this.domElement;_.isArray(a)||(c=_.map(arguments,function(a){return a}));_.each(c,function(a){var c;c=a instanceof Two.Group;if(_.isUndefined(a.id)){var h=m;m++;a.id=h}c?(c="g",_.isUndefined(a.parent)&&(a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),a=n(a),delete a.stroke,
delete a.fill,delete a["fill-opacity"],delete a["stroke-opacity"],delete a["stroke-linecap"],delete a["stroke-linejoin"],delete a["stroke-miterlimit"],delete a["stroke-width"]):(c="path",a=n(a));a=x.createElement(c,a);e.appendChild(a);f.push(a)},this);return this},update:function(a,c,f){this.commands.push(arguments);return this},render:function(){var a=this.elements;_.each(this.commands,function(c){var f=c[1],e=c[2],h=c[3],g=c[4],l=a[c[0]];switch(f){case Two.Properties.hierarchy:_.each(e,function(c){l.appendChild(a[c])});
break;default:a:{c=f;switch(c){case "matrix":c="transform";e="matrix("+e+")";break;case "visible":c="visibility";e=e?"visible":"hidden";break;case "cap":c="stroke-linecap";break;case "join":c="stroke-linejoin";break;case "miter":c="stroke-miterlimit";break;case "linewidth":c="stroke-width";break;case "vertices":c="d";e=x.toString(e,h,g);break;case "opacity":x.setAttributes(l,{"stroke-opacity":opacity,"fill-opacity":opacity});break a}l.setAttribute(c,e)}}},this);this.commands.length=0;return this}})})();(function(){var n=Two.Vector=function(e,j){e=e||0;j=j||0;Object.defineProperty(this,"x",{get:function(){return e},set:function(j){e=j;this.trigger("change","x")}});Object.defineProperty(this,"y",{get:function(){return j},set:function(e){j=e;this.trigger("change","y")}})};_.extend(n,{});_.extend(n.prototype,Backbone.Events,{set:function(e,j){this.x=e;this.y=j;return this},copy:function(e){this.x=e.x;this.y=e.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new n(this.x,
this.y)},add:function(e,j){this.x=e.x+j.x;this.y=e.y+j.y;return this},addSelf:function(e){this.x+=e.x;this.y+=e.y;return this},sub:function(e,j){this.x=e.x-j.x;this.y=e.y-j.y;return this},subSelf:function(e){this.x-=e.x;this.y-=e.y;return this},multiplySelf:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){e?(this.x/=e,this.y/=e):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*
e.x+this.y*e.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var j=this.x-e.x;e=this.y-e.y;return j*j+e*e},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,j){return this.set((e.x-this.x)*
j+this.x,(e.y-this.y)*j+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var n=Math.cos,e=Math.sin,j=Math.tan,m=Two.Matrix=function(e,c,g,f,a,l){this.elements=new Two.Array(9);var j=e;_.isArray(j)||(j=_.toArray(arguments));this.identity().set(j)};_.extend(m,{Identity:[1,0,0,0,1,0,0,0,1]});_.extend(m.prototype,{set:function(e,c,g,f,a,l){var j=e;_.isArray(j)||(j=_.toArray(arguments));_.each(j,function(a,c){_.isNumber(a)&&(this.elements[c]=a)},this);return this},identity:function(){this.set(m.Identity);return this},multiply:function(e,c,g,f,a,l,j,m,
n){var p=arguments,t=p.length;if(1>=t)return _.each(this.elements,function(a,c){this.elements[c]=a*e},this),this;if(3>=t)return e=e||0,c=c||0,g=g||0,a=this.elements,{x:a[0]*e+a[1]*c+a[2]*g,y:a[3]*e+a[4]*c+a[5]*g,z:a[6]*e+a[7]*c+a[8]*g};t=this.elements;A0=t[0];A1=t[1];A2=t[2];A3=t[3];A4=t[4];A5=t[5];A6=t[6];A7=t[7];A8=t[8];B0=p[0];B1=p[1];B2=p[2];B3=p[3];B4=p[4];B5=p[5];B6=p[6];B7=p[7];B8=p[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;
this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this},scale:function(e,c){1>=arguments.length&&(c=e);return this.multiply(e,0,0,0,c,0,0,0,1)},rotate:function(h){var c=n(h);h=e(h);return this.multiply(c,-h,0,h,c,0,0,0,1)},translate:function(e,c){return this.multiply(1,0,e,0,1,c,0,0,1)},skewX:function(e){e=j(e);return this.multiply(1,
e,0,0,1,0,0,0,1)},skewY:function(e){e=j(e);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(){var e=this.elements,c=e[0].toFixed(3),g=e[1].toFixed(3),f=e[2].toFixed(3),a=e[3].toFixed(3),l=e[4].toFixed(3),e=e[5].toFixed(3);return[c,a,g,l,f,e].join(" ")},clone:function(){return new Two.Matrix(this.elements.slice(0))}})})();(function(){var n=Two.Shape=function(){this._matrix=new Two.Matrix;var e=_.debounce(_.bind(function(){var e=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation).toString();this.trigger(Two.Events.change,this.id,"matrix",e)},this),0);n.MakeGetterSetter(this,n.Properties);this._rotation="rotation";Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(j){this._rotation=j;e()}});this._scale="scale";Object.defineProperty(this,
"scale",{get:function(){return this._scale},set:function(j){this._scale=j;e()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.miter=this.join=this.cap="round";this.translation.bind(Two.Events.change,e)};_.extend(n,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(e,j){_.isArray(j)||(j=[j]);_.each(j,function(j){var h="_"+j;Object.defineProperty(e,
j,{get:function(){return this[h]},set:function(c){this[h]=c;this.trigger(Two.Events.change,this.id,j,c,this)}})})}});_.extend(n.prototype,Backbone.Events,{addTo:function(e){e.add(this);return this},noFill:function(){this.fill="none";return this},noStroke:function(){this.stroke="none";return this},clone:function(){var e=new n;e.translation.copy(this.translation);_.each(n.Properties,function(j){e[j]=this[j]},this);return this}})})();(function(){var n=Two.Group=function(){Two.Shape.call(this);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;this.children={}};_.extend(n,{});_.extend(n.prototype,Two.Shape.prototype,{add:function(e){var j=e,m=this.children,h=this.parent,c=[];_.isArray(e)||(j=_.toArray(arguments));var g=_.bind(function(c,a,e,g,h){this.trigger(Two.Events.change,c,a,e,g,h)},this);_.each(j,function(e){var a=e.id,j=e.parent;_.isUndefined(a)&&
(h.add(e),a=e.id);_.isUndefined(m[a])&&(j&&delete j.children[a],m[a]=e,e.parent=this,e.unbind(Two.Events.change).bind(Two.Events.change,g),c.push(a))},this);0<c.length&&this.trigger(Two.Events.change,this.id,"hierarchy",c);return this},getBoundingClientRect:function(){var e=Infinity,j=-Infinity,m=Infinity,h=-Infinity;_.each(this.children,function(c){c=c.getBoundingClientRect();m=Math.min(c.top,m);e=Math.min(c.left,e);j=Math.max(c.right,j);h=Math.max(c.bottom,h)},this);var c=this._matrix.multiply(e,
m,1),g=this._matrix.multiply(j,h,1);return{top:c.y,left:c.x,right:g.x,bottom:g.y,width:g.x-c.x,height:g.y-c.y}}})})();(function(){var n=Math.min,e=Math.max,j=Math.round,m=Two.Polygon=function(h,c,g){Two.Shape.call(this);c=!!c;g=!!g;var f=0,a=1,l=!1,m=_.debounce(_.bind(function(){var c,e;if(l){c=this.vertices.length;c-=1;e=j(f*c);c=j(a*c);for(h.length=0;e<c+1;e++){var g=this.vertices[e];h.push({x:g.x,y:g.y})}l=!1}this.trigger(Two.Events.change,this.id,"vertices",h,this.closed,this.curved)},this),0);Object.defineProperty(this,"closed",{get:function(){return c},set:function(a){c=!!a;m()}});Object.defineProperty(this,
"curved",{get:function(){return g},set:function(a){g=!!a;m()}});Object.defineProperty(this,"beginning",{get:function(){return f},set:function(a){f=n(e(a,0),1);l=!0;m()}});Object.defineProperty(this,"ending",{get:function(){return a},set:function(c){a=n(e(c,0),1);l=!0;m()}});this.vertices=h.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,m)},this)};_.extend(m,{});_.extend(m.prototype,Two.Shape.prototype,{clone:function(){var e=_.map(this.vertices,function(c){return new Two.Vector(c.x,
c.y)}),c=new m(e,this.closed,this.curved);_.each(Two.Shape.Properties,function(e){c[e]=this[e]},this);c.translation.copy(this.translation);c.rotation=this.rotation;c.scale=this.scale;return c},getBoundingClientRect:function(){var e=this.linewidth,c=Infinity,g=-Infinity,f=Infinity,a=-Infinity;_.each(this.vertices,function(e){var h=e.x;e=e.y;f=Math.min(e,f);c=Math.min(h,c);g=Math.max(h,g);a=Math.max(e,a)});var f=f-e,c=c-e,g=g+e,a=a+e,e=this._matrix.multiply(c,f,1),j=this._matrix.multiply(g,a,1);return{top:e.y,
left:e.x,right:j.x,bottom:j.y,width:j.x-e.x,height:j.y-e.y}}})})();
