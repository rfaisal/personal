(function(){function n(a,j,m){if(a===j)return 0!==a||1/a==1/j;if(null==a||null==j)return a===j;a._chain&&(a=a._wrapped);j._chain&&(j=j._wrapped);if(a.isEqual&&c.isFunction(a.isEqual))return a.isEqual(j);if(j.isEqual&&c.isFunction(j.isEqual))return j.isEqual(a);var t=b.call(a);if(t!=b.call(j))return!1;switch(t){case "[object String]":return a==String(j);case "[object Number]":return a!=+a?j!=+j:0==a?1/a==1/j:a==+j;case "[object Date]":case "[object Boolean]":return+a==+j;case "[object RegExp]":return a.source==
j.source&&a.global==j.global&&a.multiline==j.multiline&&a.ignoreCase==j.ignoreCase}if("object"!=typeof a||"object"!=typeof j)return!1;for(var d=m.length;d--;)if(m[d]==a)return!0;m.push(a);var d=0,f=!0;if("[object Array]"==t){if(d=a.length,f=d==j.length)for(;d--&&(f=d in a==d in j&&n(a[d],j[d],m)););}else{if("constructor"in a!="constructor"in j||a.constructor!=j.constructor)return!1;for(var e in a)if(c.has(a,e)&&(d++,!(f=c.has(j,e)&&n(a[e],j[e],m))))break;if(f){for(e in j)if(c.has(j,e)&&!d--)break;
f=!d}}m.pop();return f}var e=this,h=e._,k={},g=Array.prototype,f=Object.prototype,l=g.slice,d=g.unshift,b=f.toString,C=f.hasOwnProperty,p=g.forEach,v=g.map,r=g.reduce,q=g.reduceRight,w=g.filter,K=g.every,L=g.some,G=g.indexOf,H=g.lastIndexOf,f=Array.isArray,B=Object.keys,u=Function.prototype.bind,c=function(a){return new D(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=c),exports._=c):e._=c;c.VERSION="1.3.3";var s=c.each=c.forEach=function(a,
j,m){if(null!=a)if(p&&a.forEach===p)a.forEach(j,m);else if(a.length===+a.length)for(var t=0,b=a.length;t<b&&!(t in a&&j.call(m,a[t],t,a)===k);t++);else for(t in a)if(c.has(a,t)&&j.call(m,a[t],t,a)===k)break};c.map=c.collect=function(a,j,c){var t=[];if(null==a)return t;if(v&&a.map===v)return a.map(j,c);s(a,function(a,b,d){t[t.length]=j.call(c,a,b,d)});a.length===+a.length&&(t.length=a.length);return t};c.reduce=c.foldl=c.inject=function(a,j,m,t){var b=2<arguments.length;null==a&&(a=[]);if(r&&a.reduce===
r)return t&&(j=c.bind(j,t)),b?a.reduce(j,m):a.reduce(j);s(a,function(a,c,d){b?m=j.call(t,m,a,c,d):(m=a,b=!0)});if(!b)throw new TypeError("Reduce of empty array with no initial value");return m};c.reduceRight=c.foldr=function(a,j,m,b){var d=2<arguments.length;null==a&&(a=[]);if(q&&a.reduceRight===q)return b&&(j=c.bind(j,b)),d?a.reduceRight(j,m):a.reduceRight(j);var f=c.toArray(a).reverse();b&&!d&&(j=c.bind(j,b));return d?c.reduce(f,j,m,b):c.reduce(f,j)};c.find=c.detect=function(a,j,c){var b;z(a,function(a,
d,f){if(j.call(c,a,d,f))return b=a,!0});return b};c.filter=c.select=function(a,c,m){var b=[];if(null==a)return b;if(w&&a.filter===w)return a.filter(c,m);s(a,function(a,d,f){c.call(m,a,d,f)&&(b[b.length]=a)});return b};c.reject=function(a,c,m){var b=[];if(null==a)return b;s(a,function(a,d,f){c.call(m,a,d,f)||(b[b.length]=a)});return b};c.every=c.all=function(a,c,m){var b=!0;if(null==a)return b;if(K&&a.every===K)return a.every(c,m);s(a,function(a,d,f){if(!(b=b&&c.call(m,a,d,f)))return k});return!!b};
var z=c.some=c.any=function(a,j,m){j||(j=c.identity);var b=!1;if(null==a)return b;if(L&&a.some===L)return a.some(j,m);s(a,function(a,c,d){if(b||(b=j.call(m,a,c,d)))return k});return!!b};c.include=c.contains=function(a,c){var m=!1;return null==a?m:G&&a.indexOf===G?-1!=a.indexOf(c):m=z(a,function(a){return a===c})};c.invoke=function(a,j){var m=l.call(arguments,2);return c.map(a,function(a){return(c.isFunction(j)?j||a:a[j]).apply(a,m)})};c.pluck=function(a,j){return c.map(a,function(a){return a[j]})};
c.max=function(a,j,m){if(!j&&c.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!j&&c.isEmpty(a))return-Infinity;var b={computed:-Infinity};s(a,function(a,c,d){c=j?j.call(m,a,c,d):a;c>=b.computed&&(b={value:a,computed:c})});return b.value};c.min=function(a,j,m){if(!j&&c.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!j&&c.isEmpty(a))return Infinity;var b={computed:Infinity};s(a,function(a,c,d){c=j?j.call(m,a,c,d):a;c<b.computed&&(b={value:a,computed:c})});return b.value};c.shuffle=
function(a){var c=[],m;s(a,function(a,b){m=Math.floor(Math.random()*(b+1));c[b]=c[m];c[m]=a});return c};c.sortBy=function(a,j,b){var d=c.isFunction(j)?j:function(a){return a[j]};return c.pluck(c.map(a,function(a,c,j){return{value:a,criteria:d.call(b,a,c,j)}}).sort(function(a,c){var j=a.criteria,b=c.criteria;return void 0===j?1:void 0===b?-1:j<b?-1:j>b?1:0}),"value")};c.groupBy=function(a,j){var b={},d=c.isFunction(j)?j:function(a){return a[j]};s(a,function(a,c){var j=d(a,c);(b[j]||(b[j]=[])).push(a)});
return b};c.sortedIndex=function(a,j,b){b||(b=c.identity);for(var d=0,f=a.length;d<f;){var e=d+f>>1;b(a[e])<b(j)?d=e+1:f=e}return d};c.toArray=function(a){return!a?[]:c.isArray(a)||c.isArguments(a)?l.call(a):a.toArray&&c.isFunction(a.toArray)?a.toArray():c.values(a)};c.size=function(a){return c.isArray(a)?a.length:c.keys(a).length};c.first=c.head=c.take=function(a,c,b){return null!=c&&!b?l.call(a,0,c):a[0]};c.initial=function(a,c,b){return l.call(a,0,a.length-(null==c||b?1:c))};c.last=function(a,
c,b){return null!=c&&!b?l.call(a,Math.max(a.length-c,0)):a[a.length-1]};c.rest=c.tail=function(a,c,b){return l.call(a,null==c||b?1:c)};c.compact=function(a){return c.filter(a,function(a){return!!a})};c.flatten=function(a,j){return c.reduce(a,function(a,b){if(c.isArray(b))return a.concat(j?b:c.flatten(b));a[a.length]=b;return a},[])};c.without=function(a){return c.difference(a,l.call(arguments,1))};c.uniq=c.unique=function(a,b,d){d=d?c.map(a,d):a;var f=[];3>a.length&&(b=!0);c.reduce(d,function(d,m,
e){if(b?c.last(d)!==m||!d.length:!c.include(d,m))d.push(m),f.push(a[e]);return d},[]);return f};c.union=function(){return c.uniq(c.flatten(arguments,!0))};c.intersection=c.intersect=function(a){var b=l.call(arguments,1);return c.filter(c.uniq(a),function(a){return c.every(b,function(b){return 0<=c.indexOf(b,a)})})};c.difference=function(a){var b=c.flatten(l.call(arguments,1),!0);return c.filter(a,function(a){return!c.include(b,a)})};c.zip=function(){for(var a=l.call(arguments),b=c.max(c.pluck(a,"length")),
d=Array(b),f=0;f<b;f++)d[f]=c.pluck(a,""+f);return d};c.indexOf=function(a,b,d){if(null==a)return-1;var f;if(d)return d=c.sortedIndex(a,b),a[d]===b?d:-1;if(G&&a.indexOf===G)return a.indexOf(b);d=0;for(f=a.length;d<f;d++)if(d in a&&a[d]===b)return d;return-1};c.lastIndexOf=function(a,c){if(null==a)return-1;if(H&&a.lastIndexOf===H)return a.lastIndexOf(c);for(var b=a.length;b--;)if(b in a&&a[b]===c)return b;return-1};c.range=function(a,c,b){1>=arguments.length&&(c=a||0,a=0);b=arguments[2]||1;for(var d=
Math.max(Math.ceil((c-a)/b),0),f=0,e=Array(d);f<d;)e[f++]=a,a+=b;return e};var x=function(){};c.bind=function(a,b){var d,f;if(a.bind===u&&u)return u.apply(a,l.call(arguments,1));if(!c.isFunction(a))throw new TypeError;f=l.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(b,f.concat(l.call(arguments)));x.prototype=a.prototype;var c=new x,e=a.apply(c,f.concat(l.call(arguments)));return Object(e)===e?e:c}};c.bindAll=function(a){var b=l.call(arguments,1);0==b.length&&(b=c.functions(a));
s(b,function(b){a[b]=c.bind(a[b],a)});return a};c.memoize=function(a,b){var d={};b||(b=c.identity);return function(){var f=b.apply(this,arguments);return c.has(d,f)?d[f]:d[f]=a.apply(this,arguments)}};c.delay=function(a,c){var b=l.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},c)};c.defer=function(a){return c.delay.apply(c,[a,1].concat(l.call(arguments,1)))};c.throttle=function(a,b){var d,f,e,l,g,q,r=c.debounce(function(){g=l=!1},b);return function(){d=this;f=arguments;e||
(e=setTimeout(function(){e=null;g&&a.apply(d,f);r()},b));l?g=!0:q=a.apply(d,f);r();l=!0;return q}};c.debounce=function(a,c,b){var d;return function(){var f=this,e=arguments;b&&!d&&a.apply(f,e);clearTimeout(d);d=setTimeout(function(){d=null;b||a.apply(f,e)},c)}};c.once=function(a){var c=!1,b;return function(){if(c)return b;c=!0;return b=a.apply(this,arguments)}};c.wrap=function(a,c){return function(){var b=[a].concat(l.call(arguments,0));return c.apply(this,b)}};c.compose=function(){var a=arguments;
return function(){for(var c=arguments,b=a.length-1;0<=b;b--)c=[a[b].apply(this,c)];return c[0]}};c.after=function(a,c){return 0>=a?c():function(){if(1>--a)return c.apply(this,arguments)}};c.keys=B||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)c.has(a,d)&&(b[b.length]=d);return b};c.values=function(a){return c.map(a,c.identity)};c.functions=c.methods=function(a){var b=[],d;for(d in a)c.isFunction(a[d])&&b.push(d);return b.sort()};c.extend=function(a){s(l.call(arguments,
1),function(c){for(var b in c)a[b]=c[b]});return a};c.pick=function(a){var b={};s(c.flatten(l.call(arguments,1)),function(c){c in a&&(b[c]=a[c])});return b};c.defaults=function(a){s(l.call(arguments,1),function(c){for(var b in c)null==a[b]&&(a[b]=c[b])});return a};c.clone=function(a){return!c.isObject(a)?a:c.isArray(a)?a.slice():c.extend({},a)};c.tap=function(a,c){c(a);return a};c.isEqual=function(a,c){return n(a,c,[])};c.isEmpty=function(a){if(null==a)return!0;if(c.isArray(a)||c.isString(a))return 0===
a.length;for(var b in a)if(c.has(a,b))return!1;return!0};c.isElement=function(a){return!!(a&&1==a.nodeType)};c.isArray=f||function(a){return"[object Array]"==b.call(a)};c.isObject=function(a){return a===Object(a)};c.isArguments=function(a){return"[object Arguments]"==b.call(a)};c.isArguments(arguments)||(c.isArguments=function(a){return!(!a||!c.has(a,"callee"))});c.isFunction=function(a){return"[object Function]"==b.call(a)};c.isString=function(a){return"[object String]"==b.call(a)};c.isNumber=function(a){return"[object Number]"==
b.call(a)};c.isFinite=function(a){return c.isNumber(a)&&isFinite(a)};c.isNaN=function(a){return a!==a};c.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==b.call(a)};c.isDate=function(a){return"[object Date]"==b.call(a)};c.isRegExp=function(a){return"[object RegExp]"==b.call(a)};c.isNull=function(a){return null===a};c.isUndefined=function(a){return void 0===a};c.has=function(a,c){return C.call(a,c)};c.noConflict=function(){e._=h;return this};c.identity=function(a){return a};c.times=
function(a,c,b){for(var d=0;d<a;d++)c.call(b,d)};c.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};c.result=function(a,b){if(null==a)return null;var d=a[b];return c.isFunction(d)?d.call(a):d};c.mixin=function(a){s(c.functions(a),function(b){var f=c[b]=a[b];D.prototype[b]=function(){var a=l.call(arguments);d.call(a,this._wrapped);return I(f.apply(c,a),this._chain)}})};var E=0;c.uniqueId=
function(a){var c=E++;return a?a+c:c};c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var y=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},F;for(F in A)A[A[F]]=F;var M=/\\|'|\r|\n|\t|\u2028|\u2029/g,N=/\\(\\|'|r|n|t|u2028|u2029)/g,J=function(a){return a.replace(N,function(a,c){return A[c]})};c.template=function(a,b,d){d=c.defaults(d||{},c.templateSettings);a="__p+='"+a.replace(M,function(a){return"\\"+A[a]}).replace(d.escape||
y,function(a,c){return"'+\n_.escape("+J(c)+")+\n'"}).replace(d.interpolate||y,function(a,c){return"'+\n("+J(c)+")+\n'"}).replace(d.evaluate||y,function(a,c){return"';\n"+J(c)+"\n;__p+='"})+"';\n";d.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var f=new Function(d.variable||"obj","_",a);if(b)return f(b,c);b=function(a){return f.call(this,a,c)};b.source="function("+(d.variable||"obj")+"){\n"+a+"}";return b};
c.chain=function(a){return c(a).chain()};var D=function(a){this._wrapped=a};c.prototype=D.prototype;var I=function(a,b){return b?c(a).chain():a};c.mixin(c);s("pop push reverse shift sort splice unshift".split(" "),function(a){var c=g[a];D.prototype[a]=function(){var b=this._wrapped;c.apply(b,arguments);var d=b.length;("shift"==a||"splice"==a)&&0===d&&delete b[0];return I(b,this._chain)}});s(["concat","join","slice"],function(a){var c=g[a];D.prototype[a]=function(){return I(c.apply(this._wrapped,arguments),
this._chain)}});D.prototype.chain=function(){this._chain=!0;return this};D.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var n=[].slice,e=/\s+/,h=function(f,l,d,b){if(!d)return!0;if("object"===typeof d)for(var g in d)f[l].apply(f,[g,d[g]].concat(b));else if(e.test(d)){d=d.split(e);g=0;for(var p=d.length;g<p;g++)f[l].apply(f,[d[g]].concat(b))}else return!0},k=function(f,e,d){var b;f=-1;var g=e.length;switch(d.length){case 0:for(;++f<g;)(b=e[f]).callback.call(b.ctx);break;case 1:for(;++f<g;)(b=e[f]).callback.call(b.ctx,d[0]);break;case 2:for(;++f<g;)(b=e[f]).callback.call(b.ctx,d[0],d[1]);break;case 3:for(;++f<
g;)(b=e[f]).callback.call(b.ctx,d[0],d[1],d[2]);break;default:for(;++f<g;)(b=e[f]).callback.apply(b.ctx,d)}},g=Backbone.Events={on:function(f,e,d){if(!h(this,"on",f,[e,d])||!e)return this;this._events||(this._events={});(this._events[f]||(this._events[f]=[])).push({callback:e,context:d,ctx:d||this});return this},once:function(f,e,d){if(!h(this,"once",f,[e,d])||!e)return this;var b=this,g=_.once(function(){b.off(f,g);e.apply(this,arguments)});g._callback=e;this.on(f,g,d);return this},off:function(f,
e,d){var b,g,p,v,r,q,w,k;if(!this._events||!h(this,"off",f,[e,d]))return this;if(!f&&!e&&!d)return this._events={},this;v=f?[f]:_.keys(this._events);r=0;for(q=v.length;r<q;r++)if(f=v[r],b=this._events[f]){p=[];if(e||d){w=0;for(k=b.length;w<k;w++)g=b[w],(e&&e!==(g.callback._callback||g.callback)||d&&d!==g.context)&&p.push(g)}this._events[f]=p}return this},trigger:function(f){if(!this._events)return this;var e=n.call(arguments,1);if(!h(this,"trigger",f,e))return this;var d=this._events[f],b=this._events.all;
d&&k(this,d,e);b&&k(this,b,arguments);return this},listenTo:function(f,e,d){var b=this._listeners||(this._listeners={}),g=f._listenerId||(f._listenerId=_.uniqueId("l"));b[g]=f;f.on(e,d||this,this);return this},stopListening:function(f,e,d){var b=this._listeners;if(b){if(f)f.off(e,d,this),!e&&!d&&delete b[f._listenerId];else{for(var g in b)b[g].off(null,null,this);this._listeners={}}return this}}};g.bind=g.on;g.unbind=g.off})();(function(){for(var n=0,e=["ms","moz","webkit","o"],h=0;h<e.length&&!window.requestAnimationFrame;++h)window.requestAnimationFrame=window[e[h]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[h]+"CancelAnimationFrame"]||window[e[h]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var g=(new Date).getTime(),f=Math.max(0,16-(g-n)),h=window.setTimeout(function(){e(g+f)},f);n=g+f;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(e){clearTimeout(e)})})();(function(){function n(){var b=document.body.getBoundingClientRect(),e=this.width=b.width,b=this.height=b.height;this.renderer.setSize(e,b);this.trigger(d.Events.resize,e,b)}var e=this,h=e.Two||{},k=2*Math.PI,g=Math.cos,f=Math.sin,l={hasEventListeners:_.isFunction(e.addEventListener),bind:function(b,d,e,f){this.hasEventListeners?b.addEventListener(d,e,!!f):b.attachEvent("on"+d,e);return this},unbind:function(b,d,e,f){this.hasEventListeners?b.removeEventListeners(d,e,!!f):b.detachEvent("on"+d,e);return this}},
d=e.Two=function(b){b=_.defaults(b||{},{fullscreen:!1,width:640,height:480,type:d.Types.svg,autostart:!0});this.type=b.type;this.renderer=new d[this.type](this);this.playing=b.autostart;this.frameCount=0;b.fullscreen?(b=_.bind(n,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),l.bind(window,"resize",b),b()):(this.renderer.setSize(b.width,b.height),this.width=b.width,this.height=b.height);this.scene=new d.Group;this.renderer.add(this.scene);
d.Instances.push(this)};_.extend(d,{Array:e.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,Instances:[],noConflict:function(){e.Two=h;return this}});_.extend(d.prototype,Backbone.Events,{appendTo:function(b){b.appendChild(this.renderer.domElement);return this},play:function(){this.playing=!0;return this.trigger(d.Events.play)},
pause:function(){this.playing=!1;return this.trigger(d.Events.pause)},update:function(){this.frameCount++;var b=this.width,e=this.height,f=this.renderer;(b!==f.width||e!==f.height)&&f.setSize(b,e);return this.trigger(d.Events.update,this.frameCount)},render:function(){this.renderer.render();return this.trigger(d.Events.render,this.frameCount)},add:function(b){var d=b;_.isArray(b)||(d=_.toArray(arguments));this.scene.add(d);return this},makeLine:function(b,e,f,g){f=(f-b)/2;g=(g-e)/2;var r=[new d.Vector(-f,
-g),new d.Vector(f,g)],r=(new d.Polygon(r)).noFill();r.translation.set(b+f,e+g);this.scene.add(r);return r},makeRectangle:function(b,e,f,g){f/=2;g/=2;g=[new d.Vector(f,g),new d.Vector(-f,g),new d.Vector(-f,-g),new d.Vector(f,-g)];g=new d.Polygon(g,!0);g.translation.set(b,e);this.scene.add(g);return g},makeCircle:function(b,d,f){return this.makeEllipse(b,d,f,f)},makeEllipse:function(b,e,h,l){var r=d.Resolution,q=_.map(_.range(r),function(b){var e=b/r*k;b=h*g(e);e=l*f(e);return new d.Vector(b,e)},this),
q=new d.Polygon(q,!0,!0);q.translation.set(b,e);this.scene.add(q);return q},makeCurve:function(b){var e=arguments.length,f=b;if(!_.isArray(b))for(var f=[],g=0;g<e;g+=2){var r=arguments[g];if(!_.isNumber(r))break;f.push(new d.Vector(r,arguments[g+1]))}e=arguments[e-1];f=new d.Polygon(f,!(_.isBoolean(e)&&e),!0);this.scene.add(f);return f},makePolygon:function(b){var f=arguments.length,e=b;if(!_.isArray(b))for(var e=[],g=0;g<f;g+=2){var r=arguments[g];if(!_.isNumber(r))break;e.push(new d.Vector(r,arguments[g+
1]))}f=arguments[f-1];e=new d.Polygon(e,!(_.isBoolean(f)&&f));this.scene.add(e);return e},makeGroup:function(){var b=new d.Group;this.scene.add(b);b.add(_.toArray(arguments));return b}});(function(){_.each(d.Instances,function(b){b.playing&&b.update().render()});requestAnimationFrame(arguments.callee)})()})();(function(){function n(b){var d={},e=b.translation,f=b.rotation,g=b.scale,h=b.stroke,l=b.linewidth,k=b.fill,n=b.opacity,c=b.visible,s=b.cap,C=b.join,x=b.miter,E=b.curved,y=b.closed,A=b.vertices;b.id&&(d.id=v.Identifier+b.id);e&&(_.isNumber(g)&&_.isNumber(f))&&(d.transform="translate("+e.x+","+e.y+") scale("+g+") rotate("+f+")");h&&(d.stroke=h);k&&(d.fill=k);n&&(d["stroke-opacity"]=d["fill-opacity"]=n);c&&(d.visibility=c?"visible":"hidden");s&&(d["stroke-linecap"]=s);C&&(d["stroke-linejoin"]=C);x&&
(d["stroke-miterlimit"]=x);l&&(d["stroke-width"]=l);A&&(d.d=p.toString(A,y,E));return d}function e(b,e){var f=b.x-e.x,g=b.y-e.y;return d(f*f+g*g)}function h(b,d){for(;0>b;)b+=d;return b%d}var k=0,g=Math.sin,f=Math.cos,l=Math.atan2,d=Math.sqrt,b=Math.PI,C=b/2,p={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(b,d){var e=b.toLowerCase(),f=document.createElementNS(this.ns,e);"svg"===e&&(d=_.defaults(d||{},{version:this.version}));_.isObject(d)&&
this.setAttributes(f,d);return f},setAttributes:function(b,d){_.each(d,function(b,d){this.setAttribute(d,b)},b);return this},removeAttributes:function(b,d){_.each(d,function(b){this.removeAttribute(b)},b);return this},toString:function(d,q,k){var v=d.length,p=v-1;if(!k)return _.map(d,function(b,c){var d;d=(0>=c?"M":"L")+(" "+b.x.toFixed(3)+" "+b.y.toFixed(3));c>=p&&q&&(d+=" Z");return d}).join(" ");var n=[];k=d.length;for(var H=k-1,B=0;B<k;B++){var u=d[B],u={x:u.x,y:u.y};n.push(u);var c=q?h(B-1,k):
Math.max(B-1,0),s=q?h(B+1,k):Math.min(B+1,H);var z=d[c],c=u,x=d[s],s=l(z.y-c.y,z.x-c.x),E=l(x.y-c.y,x.x-c.x),z=e(z,c),x=e(x,c),y=(s+E)/2,A=void 0,F=void 0;1E-4>z||1E-4>x?(c.u={x:c.x,y:c.y},c.v={x:c.x,y:c.y}):(z*=0.33,x*=0.33,y=E<s?y+C:y-C,A={x:c.x+f(y)*z,y:c.y+g(y)*z},y-=b,F={x:c.x+f(y)*x,y:c.y+g(y)*x},c.u=A,c.v=F);!u.u.x&&!u.u.y&&(u.u.x=u.x,u.u.y=u.y);!u.v.x&&!u.v.y&&(u.v.x=u.x,u.v.y=u.y)}return _.map(n,function(b,c){var d,e=q?h(c-1,v):Math.max(c-1,0),f=q?h(c+1,v):Math.min(c+1,p);d=n[e];var f=n[f],
e=d.v.x.toFixed(3),a=d.v.y.toFixed(3),g=b.u.x.toFixed(3),l=b.u.y.toFixed(3),k=b.x.toFixed(3),r=b.y.toFixed(3);d=0>=c?"M "+k+" "+r:"C "+e+" "+a+" "+g+" "+l+" "+k+" "+r;c>=p&&q&&(e=b.v.x.toFixed(3),a=b.v.y.toFixed(3),g=f.u.x.toFixed(3),l=f.u.y.toFixed(3),k=f.x.toFixed(3),r=f.y.toFixed(3),d=d+(" C "+e+" "+a+" "+g+" "+l+" "+k+" "+r)+" Z");return d}).join(" ")}},v=Two[Two.Types.svg]=function(b){this.two=b;this.domElement=p.createElement("svg");this.elements=[];this.commands=[]};_.extend(v,{Identifier:"two-"});
_.extend(v.prototype,Backbone.Events,{setSize:function(b,d){this.width=b;this.height=d;p.setAttributes(this.domElement,{width:b,height:d});return this},add:function(b){var d=b,e=this.elements,f=this.domElement;_.isArray(b)||(d=_.map(arguments,function(b){return b}));_.each(d,function(b){var d;d=b instanceof Two.Group;if(_.isUndefined(b.id)){var g=k;k++;b.id=g}d?(d="g",_.isUndefined(b.parent)&&(b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),b=n(b),delete b.stroke,
delete b.fill,delete b["fill-opacity"],delete b["stroke-opacity"],delete b["stroke-linecap"],delete b["stroke-linejoin"],delete b["stroke-miterlimit"],delete b["stroke-width"]):(d="path",b=n(b));b=p.createElement(d,b);f.appendChild(b);e.push(b)},this);return this},update:function(b,d,e){this.commands.push(arguments);return this},render:function(){var b=this.elements;_.each(this.commands,function(d){var e=d[1],f=d[2],g=d[3],h=d[4],l=b[d[0]];switch(e){case Two.Properties.hierarchy:_.each(f,function(d){l.appendChild(b[d])});
break;default:a:{d=e;switch(d){case "matrix":d="transform";f="matrix("+f+")";break;case "visible":d="visibility";f=f?"visible":"hidden";break;case "cap":d="stroke-linecap";break;case "join":d="stroke-linejoin";break;case "miter":d="stroke-miterlimit";break;case "linewidth":d="stroke-width";break;case "vertices":d="d";f=p.toString(f,g,h);break;case "opacity":p.setAttributes(l,{"stroke-opacity":opacity,"fill-opacity":opacity});break a}l.setAttribute(d,f)}}},this);this.commands.length=0;return this}})})();(function(){var n=Two.Vector=function(e,h){e=e||0;h=h||0;Object.defineProperty(this,"x",{get:function(){return e},set:function(h){e=h;this.trigger("change","x")}});Object.defineProperty(this,"y",{get:function(){return h},set:function(e){h=e;this.trigger("change","y")}})};_.extend(n,{});_.extend(n.prototype,Backbone.Events,{set:function(e,h){this.x=e;this.y=h;return this},copy:function(e){this.x=e.x;this.y=e.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new n(this.x,
this.y)},add:function(e,h){this.x=e.x+h.x;this.y=e.y+h.y;return this},addSelf:function(e){this.x+=e.x;this.y+=e.y;return this},sub:function(e,h){this.x=e.x-h.x;this.y=e.y-h.y;return this},subSelf:function(e){this.x-=e.x;this.y-=e.y;return this},multiplySelf:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){e?(this.x/=e,this.y/=e):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*
e.x+this.y*e.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var h=this.x-e.x;e=this.y-e.y;return h*h+e*e},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,h){return this.set((e.x-this.x)*
h+this.x,(e.y-this.y)*h+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var n=Math.cos,e=Math.sin,h=Math.tan,k=Two.Matrix=function(e,f,h,d,b,k){this.elements=new Two.Array(9);var p=e;_.isArray(p)||(p=_.toArray(arguments));this.identity().set(p)};_.extend(k,{Identity:[1,0,0,0,1,0,0,0,1]});_.extend(k.prototype,{set:function(e,f,h,d,b,k){var p=e;_.isArray(p)||(p=_.toArray(arguments));_.each(p,function(b,d){_.isNumber(b)&&(this.elements[d]=b)},this);return this},identity:function(){this.set(k.Identity);return this},multiply:function(e,f,h,d,b,k,p,n,
r){var q=arguments;if(1>=q.length)return _.each(this.elements,function(b,d){this.elements[d]=b*e},this),this;var w=this.elements;A0=w[0];A1=w[1];A2=w[2];A3=w[3];A4=w[4];A5=w[5];A6=w[6];A7=w[7];A8=w[8];B0=q[0];B1=q[1];B2=q[2];B3=q[3];B4=q[4];B5=q[5];B6=q[6];B7=q[7];B8=q[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*
B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this},scale:function(e,f){1>=arguments.length&&(f=e);return this.multiply(e,0,0,0,f,0,0,0,1)},rotate:function(g){var f=n(g);g=e(g);return this.multiply(f,-g,0,g,f,0,0,0,1)},translate:function(e,f){return this.multiply(1,0,e,0,1,f,0,0,1)},skewX:function(e){e=h(e);return this.multiply(1,e,0,0,1,0,0,0,1)},skewY:function(e){e=h(e);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(){var e=this.elements,
f=e[0].toFixed(3),h=e[1].toFixed(3),d=e[2].toFixed(3),b=e[3].toFixed(3),k=e[4].toFixed(3),e=e[5].toFixed(3);return[f,b,h,k,d,e].join(" ")},clone:function(){return new Two.Matrix(this.elements.slice(0))}})})();(function(){var n=Two.Shape=function(){this._matrix=new Two.Matrix;var e=_.debounce(_.bind(function(){var e=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation).toString();this.trigger(Two.Events.change,this.id,"matrix",e)},this),0);n.MakeGetterSetter(this,n.Properties);this._rotation="rotation";Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(h){this._rotation=h;e()}});this._scale="scale";Object.defineProperty(this,
"scale",{get:function(){return this._scale},set:function(h){this._scale=h;e()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.miter=this.join=this.cap="round";this.translation.bind(Two.Events.change,e)};_.extend(n,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(e,h){_.isArray(h)||(h=[h]);_.each(h,function(h){var g="_"+h;Object.defineProperty(e,
h,{get:function(){return this[g]},set:function(e){this[g]=e;this.trigger(Two.Events.change,this.id,h,e,this)}})})}});_.extend(n.prototype,Backbone.Events,{addTo:function(e){e.add(this);return this},noFill:function(){this.fill="none";return this},noStroke:function(){this.stroke="none";return this},clone:function(){var e=new n;e.translation.copy(this.translation);_.each(n.Properties,function(h){e[h]=this[h]},this);return this}})})();(function(){var n=Two.Group=function(){Two.Shape.call(this);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;this.children={}};_.extend(n,{});_.extend(n.prototype,Two.Shape.prototype,{add:function(e){var h=e,k=this.children,g=this.parent,f=[];_.isArray(e)||(h=_.toArray(arguments));var l=_.bind(function(d,b,e,f,g){this.trigger(Two.Events.change,d,b,e,f,g)},this);_.each(h,function(d){var b=d.id,e=d.parent;_.isUndefined(b)&&
(g.add(d),b=d.id);_.isUndefined(k[b])&&(e&&delete e.children[b],k[b]=d,d.parent=this,d.unbind(Two.Events.change).bind(Two.Events.change,l),f.push(b))},this);0<f.length&&this.trigger(Two.Events.change,this.id,"hierarchy",f);return this},getBoundingClientRect:function(){var e=Infinity,h=-Infinity,k=Infinity,g=-Infinity,f=this.translation.x,l=this.translation.y,d=this.scale;_.each(this.children,function(b){b=b.getBoundingClientRect();k=Math.min(b.top,k);e=Math.min(b.left,e);h=Math.max(b.right,h);g=Math.max(b.bottom,
g)},this);k*=d;e*=d;h*=d;g*=d;k+=l;e+=f;h+=f;g+=l;return{top:k,left:e,right:h,bottom:g,width:h-e,height:g-k}}})})();(function(){var n=Math.min,e=Math.max,h=Math.round,k=Two.Polygon=function(g,f,l){Two.Shape.call(this);f=!!f;l=!!l;var d=0,b=1,k=!1,p=_.debounce(_.bind(function(){var e,f;if(k){e=this.vertices.length;e-=1;f=h(d*e);e=h(b*e);for(g.length=0;f<e+1;f++){var l=this.vertices[f];g.push({x:l.x,y:l.y})}k=!1}this.trigger(Two.Events.change,this.id,"vertices",g,this.closed,this.curved)},this),0);Object.defineProperty(this,"closed",{get:function(){return f},set:function(b){f=!!b;p()}});Object.defineProperty(this,
"curved",{get:function(){return l},set:function(b){l=!!b;p()}});Object.defineProperty(this,"beginning",{get:function(){return d},set:function(b){d=n(e(b,0),1);k=!0;p()}});Object.defineProperty(this,"ending",{get:function(){return b},set:function(d){b=n(e(d,0),1);k=!0;p()}});this.vertices=g.slice(0);_.each(this.vertices,function(b){b.bind(Two.Events.change,p)},this)};_.extend(k,{});_.extend(k.prototype,Two.Shape.prototype,{clone:function(){var e=_.map(this.vertices,function(e){return new Two.Vector(e.x,
e.y)}),f=new k(e,this.closed,this.curved);_.each(Two.Shape.Properties,function(e){f[e]=this[e]},this);f.translation.copy(this.translation);f.rotation=this.rotation;f.scale=this.scale;return f},getBoundingClientRect:function(){var e=Infinity,f=-Infinity,h=Infinity,d=-Infinity,b=this.translation.x,k=this.translation.y,n=this.linewidth,v=this.scale;_.each(this.vertices,function(b){var k=b.x;b=b.y;h=Math.min(b,h);e=Math.min(k,e);f=Math.max(k,f);d=Math.max(b,d)});h-=n;e-=n;f+=n;d+=n;h*=v;e*=v;f*=v;d*=
v;h+=k;e+=b;f+=b;d+=k;return{top:h,left:e,right:f,bottom:d,width:f-e,height:d-h}}})})();
