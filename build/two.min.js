(function(){function r(m,a,c){if(m===a)return 0!==m||1/m==1/a;if(null==m||null==a)return m===a;m._chain&&(m=m._wrapped);a._chain&&(a=a._wrapped);if(m.isEqual&&d.isFunction(m.isEqual))return m.isEqual(a);if(a.isEqual&&d.isFunction(a.isEqual))return a.isEqual(m);var j=q.call(m);if(j!=q.call(a))return!1;switch(j){case "[object String]":return m==String(a);case "[object Number]":return m!=+m?a!=+a:0==m?1/m==1/a:m==+a;case "[object Date]":case "[object Boolean]":return+m==+a;case "[object RegExp]":return m.source==
a.source&&m.global==a.global&&m.multiline==a.multiline&&m.ignoreCase==a.ignoreCase}if("object"!=typeof m||"object"!=typeof a)return!1;for(var b=c.length;b--;)if(c[b]==m)return!0;c.push(m);var b=0,e=!0;if("[object Array]"==j){if(b=m.length,e=b==a.length)for(;b--&&(e=b in m==b in a&&r(m[b],a[b],c)););}else{if("constructor"in m!="constructor"in a||m.constructor!=a.constructor)return!1;for(var n in m)if(d.has(m,n)&&(b++,!(e=d.has(a,n)&&r(m[n],a[n],c))))break;if(e){for(n in a)if(d.has(a,n)&&!b--)break;
e=!b}}c.pop();return e}var f=this,l=f._,p={},k=Array.prototype,b=Object.prototype,c=k.slice,e=k.unshift,q=b.toString,a=b.hasOwnProperty,n=k.forEach,y=k.map,s=k.reduce,j=k.reduceRight,z=k.filter,C=k.every,A=k.some,t=k.indexOf,w=k.lastIndexOf,b=Array.isArray,u=Object.keys,v=Function.prototype.bind,d=function(m){return new I(m)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports._=d):f._=d;d.VERSION="1.3.3";var x=d.each=d.forEach=function(m,
a,c){if(null!=m)if(n&&m.forEach===n)m.forEach(a,c);else if(m.length===+m.length)for(var b=0,j=m.length;b<j&&!(b in m&&a.call(c,m[b],b,m)===p);b++);else for(b in m)if(d.has(m,b)&&a.call(c,m[b],b,m)===p)break};d.map=d.collect=function(m,a,d){var c=[];if(null==m)return c;if(y&&m.map===y)return m.map(a,d);x(m,function(m,b,j){c[c.length]=a.call(d,m,b,j)});m.length===+m.length&&(c.length=m.length);return c};d.reduce=d.foldl=d.inject=function(m,a,c,b){var j=2<arguments.length;null==m&&(m=[]);if(s&&m.reduce===
s)return b&&(a=d.bind(a,b)),j?m.reduce(a,c):m.reduce(a);x(m,function(m,d,e){j?c=a.call(b,c,m,d,e):(c=m,j=!0)});if(!j)throw new TypeError("Reduce of empty array with no initial value");return c};d.reduceRight=d.foldr=function(m,a,c,b){var e=2<arguments.length;null==m&&(m=[]);if(j&&m.reduceRight===j)return b&&(a=d.bind(a,b)),e?m.reduceRight(a,c):m.reduceRight(a);var n=d.toArray(m).reverse();b&&!e&&(a=d.bind(a,b));return e?d.reduce(n,a,c,b):d.reduce(n,a)};d.find=d.detect=function(a,d,c){var b;B(a,function(a,
m,j){if(d.call(c,a,m,j))return b=a,!0});return b};d.filter=d.select=function(a,d,c){var b=[];if(null==a)return b;if(z&&a.filter===z)return a.filter(d,c);x(a,function(a,m,j){d.call(c,a,m,j)&&(b[b.length]=a)});return b};d.reject=function(a,d,c){var b=[];if(null==a)return b;x(a,function(a,m,j){d.call(c,a,m,j)||(b[b.length]=a)});return b};d.every=d.all=function(a,d,c){var b=!0;if(null==a)return b;if(C&&a.every===C)return a.every(d,c);x(a,function(a,m,j){if(!(b=b&&d.call(c,a,m,j)))return p});return!!b};
var B=d.some=d.any=function(a,c,b){c||(c=d.identity);var j=!1;if(null==a)return j;if(A&&a.some===A)return a.some(c,b);x(a,function(a,m,d){if(j||(j=c.call(b,a,m,d)))return p});return!!j};d.include=d.contains=function(a,d){var c=!1;return null==a?c:t&&a.indexOf===t?-1!=a.indexOf(d):c=B(a,function(a){return a===d})};d.invoke=function(a,b){var j=c.call(arguments,2);return d.map(a,function(a){return(d.isFunction(b)?b||a:a[b]).apply(a,j)})};d.pluck=function(a,c){return d.map(a,function(a){return a[c]})};
d.max=function(a,c,b){if(!c&&d.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!c&&d.isEmpty(a))return-Infinity;var j={computed:-Infinity};x(a,function(a,d,m){d=c?c.call(b,a,d,m):a;d>=j.computed&&(j={value:a,computed:d})});return j.value};d.min=function(a,c,b){if(!c&&d.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!c&&d.isEmpty(a))return Infinity;var j={computed:Infinity};x(a,function(a,d,m){d=c?c.call(b,a,d,m):a;d<j.computed&&(j={value:a,computed:d})});return j.value};d.shuffle=
function(a){var d=[],c;x(a,function(a,m){c=Math.floor(Math.random()*(m+1));d[m]=d[c];d[c]=a});return d};d.sortBy=function(a,c,b){var j=d.isFunction(c)?c:function(a){return a[c]};return d.pluck(d.map(a,function(a,d,m){return{value:a,criteria:j.call(b,a,d,m)}}).sort(function(a,d){var m=a.criteria,c=d.criteria;return void 0===m?1:void 0===c?-1:m<c?-1:m>c?1:0}),"value")};d.groupBy=function(a,c){var b={},j=d.isFunction(c)?c:function(a){return a[c]};x(a,function(a,d){var m=j(a,d);(b[m]||(b[m]=[])).push(a)});
return b};d.sortedIndex=function(a,c,b){b||(b=d.identity);for(var j=0,e=a.length;j<e;){var n=j+e>>1;b(a[n])<b(c)?j=n+1:e=n}return j};d.toArray=function(a){return!a?[]:d.isArray(a)||d.isArguments(a)?c.call(a):a.toArray&&d.isFunction(a.toArray)?a.toArray():d.values(a)};d.size=function(a){return d.isArray(a)?a.length:d.keys(a).length};d.first=d.head=d.take=function(a,d,b){return null!=d&&!b?c.call(a,0,d):a[0]};d.initial=function(a,d,b){return c.call(a,0,a.length-(null==d||b?1:d))};d.last=function(a,
d,b){return null!=d&&!b?c.call(a,Math.max(a.length-d,0)):a[a.length-1]};d.rest=d.tail=function(a,d,b){return c.call(a,null==d||b?1:d)};d.compact=function(a){return d.filter(a,function(a){return!!a})};d.flatten=function(a,c){return d.reduce(a,function(a,m){if(d.isArray(m))return a.concat(c?m:d.flatten(m));a[a.length]=m;return a},[])};d.without=function(a){return d.difference(a,c.call(arguments,1))};d.uniq=d.unique=function(a,c,b){b=b?d.map(a,b):a;var j=[];3>a.length&&(c=!0);d.reduce(b,function(b,e,
n){if(c?d.last(b)!==e||!b.length:!d.include(b,e))b.push(e),j.push(a[n]);return b},[]);return j};d.union=function(){return d.uniq(d.flatten(arguments,!0))};d.intersection=d.intersect=function(a){var b=c.call(arguments,1);return d.filter(d.uniq(a),function(a){return d.every(b,function(m){return 0<=d.indexOf(m,a)})})};d.difference=function(a){var b=d.flatten(c.call(arguments,1),!0);return d.filter(a,function(a){return!d.include(b,a)})};d.zip=function(){for(var a=c.call(arguments),b=d.max(d.pluck(a,"length")),
j=Array(b),e=0;e<b;e++)j[e]=d.pluck(a,""+e);return j};d.indexOf=function(a,c,b){if(null==a)return-1;var j;if(b)return b=d.sortedIndex(a,c),a[b]===c?b:-1;if(t&&a.indexOf===t)return a.indexOf(c);b=0;for(j=a.length;b<j;b++)if(b in a&&a[b]===c)return b;return-1};d.lastIndexOf=function(a,d){if(null==a)return-1;if(w&&a.lastIndexOf===w)return a.lastIndexOf(d);for(var b=a.length;b--;)if(b in a&&a[b]===d)return b;return-1};d.range=function(a,d,b){1>=arguments.length&&(d=a||0,a=0);b=arguments[2]||1;for(var c=
Math.max(Math.ceil((d-a)/b),0),j=0,e=Array(c);j<c;)e[j++]=a,a+=b;return e};var M=function(){};d.bind=function(a,b){var j,e;if(a.bind===v&&v)return v.apply(a,c.call(arguments,1));if(!d.isFunction(a))throw new TypeError;e=c.call(arguments,2);return j=function(){if(!(this instanceof j))return a.apply(b,e.concat(c.call(arguments)));M.prototype=a.prototype;var d=new M,n=a.apply(d,e.concat(c.call(arguments)));return Object(n)===n?n:d}};d.bindAll=function(a){var b=c.call(arguments,1);0==b.length&&(b=d.functions(a));
x(b,function(b){a[b]=d.bind(a[b],a)});return a};d.memoize=function(a,b){var c={};b||(b=d.identity);return function(){var j=b.apply(this,arguments);return d.has(c,j)?c[j]:c[j]=a.apply(this,arguments)}};d.delay=function(a,d){var b=c.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},d)};d.defer=function(a){return d.delay.apply(d,[a,1].concat(c.call(arguments,1)))};d.throttle=function(a,b){var c,j,e,n,u,v,q=d.debounce(function(){u=n=!1},b);return function(){c=this;j=arguments;e||
(e=setTimeout(function(){e=null;u&&a.apply(c,j);q()},b));n?u=!0:v=a.apply(c,j);q();n=!0;return v}};d.debounce=function(a,d,b){var c;return function(){var j=this,e=arguments;b&&!c&&a.apply(j,e);clearTimeout(c);c=setTimeout(function(){c=null;b||a.apply(j,e)},d)}};d.once=function(a){var d=!1,b;return function(){if(d)return b;d=!0;return b=a.apply(this,arguments)}};d.wrap=function(a,d){return function(){var b=[a].concat(c.call(arguments,0));return d.apply(this,b)}};d.compose=function(){var a=arguments;
return function(){for(var d=arguments,b=a.length-1;0<=b;b--)d=[a[b].apply(this,d)];return d[0]}};d.after=function(a,d){return 0>=a?d():function(){if(1>--a)return d.apply(this,arguments)}};d.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)d.has(a,c)&&(b[b.length]=c);return b};d.values=function(a){return d.map(a,d.identity)};d.functions=d.methods=function(a){var b=[],c;for(c in a)d.isFunction(a[c])&&b.push(c);return b.sort()};d.extend=function(a){x(c.call(arguments,
1),function(d){for(var b in d)a[b]=d[b]});return a};d.pick=function(a){var b={};x(d.flatten(c.call(arguments,1)),function(d){d in a&&(b[d]=a[d])});return b};d.defaults=function(a){x(c.call(arguments,1),function(d){for(var b in d)null==a[b]&&(a[b]=d[b])});return a};d.clone=function(a){return!d.isObject(a)?a:d.isArray(a)?a.slice():d.extend({},a)};d.tap=function(a,d){d(a);return a};d.isEqual=function(a,d){return r(a,d,[])};d.isEmpty=function(a){if(null==a)return!0;if(d.isArray(a)||d.isString(a))return 0===
a.length;for(var b in a)if(d.has(a,b))return!1;return!0};d.isElement=function(a){return!!(a&&1==a.nodeType)};d.isArray=b||function(a){return"[object Array]"==q.call(a)};d.isObject=function(a){return a===Object(a)};d.isArguments=function(a){return"[object Arguments]"==q.call(a)};d.isArguments(arguments)||(d.isArguments=function(a){return!(!a||!d.has(a,"callee"))});d.isFunction=function(a){return"[object Function]"==q.call(a)};d.isString=function(a){return"[object String]"==q.call(a)};d.isNumber=function(a){return"[object Number]"==
q.call(a)};d.isFinite=function(a){return d.isNumber(a)&&isFinite(a)};d.isNaN=function(a){return a!==a};d.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==q.call(a)};d.isDate=function(a){return"[object Date]"==q.call(a)};d.isRegExp=function(a){return"[object RegExp]"==q.call(a)};d.isNull=function(a){return null===a};d.isUndefined=function(a){return void 0===a};d.has=function(d,b){return a.call(d,b)};d.noConflict=function(){f._=l;return this};d.identity=function(a){return a};d.times=
function(a,d,b){for(var c=0;c<a;c++)d.call(b,c)};d.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.result=function(a,b){if(null==a)return null;var c=a[b];return d.isFunction(c)?c.call(a):c};d.mixin=function(a){x(d.functions(a),function(b){var j=d[b]=a[b];I.prototype[b]=function(){var a=c.call(arguments);e.call(a,this._wrapped);return O(j.apply(d,a),this._chain)}})};var H=0;d.uniqueId=
function(a){var d=H++;return a?a+d:d};d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/.^/,N={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},P;for(P in N)N[N[P]]=P;var V=/\\|'|\r|\n|\t|\u2028|\u2029/g,W=/\\(\\|'|r|n|t|u2028|u2029)/g,Q=function(a){return a.replace(W,function(a,d){return N[d]})};d.template=function(a,b,c){c=d.defaults(c||{},d.templateSettings);a="__p+='"+a.replace(V,function(a){return"\\"+N[a]}).replace(c.escape||
E,function(a,d){return"'+\n_.escape("+Q(d)+")+\n'"}).replace(c.interpolate||E,function(a,d){return"'+\n("+Q(d)+")+\n'"}).replace(c.evaluate||E,function(a,d){return"';\n"+Q(d)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var j=new Function(c.variable||"obj","_",a);if(b)return j(b,d);b=function(a){return j.call(this,a,d)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};
d.chain=function(a){return d(a).chain()};var I=function(a){this._wrapped=a};d.prototype=I.prototype;var O=function(a,b){return b?d(a).chain():a};d.mixin(d);x("pop push reverse shift sort splice unshift".split(" "),function(a){var d=k[a];I.prototype[a]=function(){var b=this._wrapped;d.apply(b,arguments);var c=b.length;("shift"==a||"splice"==a)&&0===c&&delete b[0];return O(b,this._chain)}});x(["concat","join","slice"],function(a){var d=k[a];I.prototype[a]=function(){return O(d.apply(this._wrapped,arguments),
this._chain)}});I.prototype.chain=function(){this._chain=!0;return this};I.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var r=[].slice,f=/\s+/,l=function(b,c,e,q){if(!e)return!0;if("object"===typeof e)for(var a in e)b[c].apply(b,[a,e[a]].concat(q));else if(f.test(e)){e=e.split(f);a=0;for(var n=e.length;a<n;a++)b[c].apply(b,[e[a]].concat(q))}else return!0},p=function(b,c,e){var q;b=-1;var a=c.length;switch(e.length){case 0:for(;++b<a;)(q=c[b]).callback.call(q.ctx);break;case 1:for(;++b<a;)(q=c[b]).callback.call(q.ctx,e[0]);break;case 2:for(;++b<a;)(q=c[b]).callback.call(q.ctx,e[0],e[1]);break;case 3:for(;++b<
a;)(q=c[b]).callback.call(q.ctx,e[0],e[1],e[2]);break;default:for(;++b<a;)(q=c[b]).callback.apply(q.ctx,e)}},k=Backbone.Events={on:function(b,c,e){if(!l(this,"on",b,[c,e])||!c)return this;this._events||(this._events={});(this._events[b]||(this._events[b]=[])).push({callback:c,context:e,ctx:e||this});return this},once:function(b,c,e){if(!l(this,"once",b,[c,e])||!c)return this;var q=this,a=_.once(function(){q.off(b,a);c.apply(this,arguments)});a._callback=c;this.on(b,a,e);return this},off:function(b,
c,e){var q,a,n,k,f,j,p,C;if(!this._events||!l(this,"off",b,[c,e]))return this;if(!b&&!c&&!e)return this._events={},this;k=b?[b]:_.keys(this._events);f=0;for(j=k.length;f<j;f++)if(b=k[f],q=this._events[b]){n=[];if(c||e){p=0;for(C=q.length;p<C;p++)a=q[p],(c&&c!==(a.callback._callback||a.callback)||e&&e!==a.context)&&n.push(a)}this._events[b]=n}return this},trigger:function(b){if(!this._events)return this;var c=r.call(arguments,1);if(!l(this,"trigger",b,c))return this;var e=this._events[b],q=this._events.all;
e&&p(this,e,c);q&&p(this,q,arguments);return this},listenTo:function(b,c,e){var q=this._listeners||(this._listeners={}),a=b._listenerId||(b._listenerId=_.uniqueId("l"));q[a]=b;b.on(c,e||this,this);return this},stopListening:function(b,c,e){var q=this._listeners;if(q){if(b)b.off(c,e,this),!c&&!e&&delete q[b._listenerId];else{for(var a in q)q[a].off(null,null,this);this._listeners={}}return this}}};k.bind=k.on;k.unbind=k.off})();(function(){for(var r=0,f=["ms","moz","webkit","o"],l=0;l<f.length&&!window.requestAnimationFrame;++l)window.requestAnimationFrame=window[f[l]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[f[l]+"CancelAnimationFrame"]||window[f[l]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(f){var k=(new Date).getTime(),b=Math.max(0,16-(k-r)),c=window.setTimeout(function(){f(k+b)},b);r=k+b;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(f){clearTimeout(f)})})();(function(){function r(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(j.Events.resize,b,a)}var f=this,l=f.Two||{},p=Math.sin,k=Math.cos,b=Math.atan2,c=Math.sqrt,e=Math.abs,q=Math.PI,a=2*q,n=q/2,y=Math.pow,s={hasEventListeners:_.isFunction(f.addEventListener),bind:function(a,b,d,c){this.hasEventListeners?a.addEventListener(b,d,!!c):a.attachEvent("on"+b,d);return this},unbind:function(a,b,d,c){this.hasEventListeners?
a.removeEventListeners(b,d,!!c):a.detachEvent("on"+b,d);return this}},j=f.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:j.Types.svg,autostart:!1});this.type=a.type;this.renderer=new j[this.type](this);j.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(r,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,
left:0,right:0,bottom:0,position:"fixed"}),s.bind(window,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);this.scene=new j.Group;this.renderer.add(this.scene);j.Instances.push(this)};_.extend(j,{Array:f.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,
Instances:[],noConflict:function(){f.Two=l;return this},Utils:{Curve:{CollinearityEpsilon:y(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},setPlaying:function(a){_.defer(_.bind(function(){this.playing=!!a},this))},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";_.each(a.attributes,function(a){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;
break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});return b},read:{svg:function(){return j.Utils.read.g.apply(this,arguments)},g:function(a){var b=new j.Group;this.add(b);_.each(a.childNodes,function(a){if(a.localName){var c=a.localName.toLowerCase();c in j.Utils.read&&(a=j.Utils.read[c].call(this,
a),b.add(a))}},this);return j.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var d=a.points,c=_.map(_.range(d.numberOfItems),function(a){a=d.getItem(a);return new j.Vector(a.x,a.y)}),c=(new j.Polygon(c,!b)).noStroke();return j.Utils.applySvgAttributes(a,c)},polyline:function(a){return j.Utils.read.polygon(a,!0)},path:function(a){var b=a.getAttribute("d"),b=_.flatten(_.map(_.compact(b.split(/M/g)),function(a){a=_.map(_.compact(a.split(/m/g)),function(a,d){return 0>=d?a:"m"+a});a[0]="M"+a[0];
return a})),d=new j.Vector,c=new j.Vector;return _.map(b,function(b){var e,n=!1,q=!1;b=_.flatten(_.map(b.match(/[a-z][^a-z]*/ig),function(a){var b,k,f=a[0],u=f.toLowerCase();e=a.slice(1).trim().split(/[\s,]+|(?=[+\-])/);n=f===u;var v,s,m;switch(u){case "z":q=!0;break;case "m":case "l":k=parseFloat(e[0]);b=parseFloat(e[1]);b=new j.Vector(k,b);n&&b.addSelf(d);d.copy(b);break;case "h":case "v":k="h"===u?"x":"y";a="x"===k?"y":"x";b=new j.Vector;b[k]=parseFloat(e[0]);b[a]=d[a];n&&(b[k]+=d[k]);d.copy(b);
break;case "s":case "c":b=d.x;a=d.y;"c"===u?(f=parseFloat(e[0]),k=parseFloat(e[1]),u=parseFloat(e[2]),v=parseFloat(e[3]),s=parseFloat(e[4]),m=parseFloat(e[5])):(v=(new j.Vector).copy(d).subSelf(c),f=parseFloat(v.x),k=parseFloat(v.y),u=parseFloat(e[0]),v=parseFloat(e[1]),s=parseFloat(e[2]),m=parseFloat(e[3]));n&&(f+=b,k+=a,u+=b,v+=a,s+=b,m+=a);b=j.Utils.subdivide(b,a,f,k,u,v,s,m);d.set(s,m);c.set(u,v);break;case "t":case "q":b=d.x;a=d.y;c.isZero()?(f=b,k=a):(f=c.x,a=c.y);"q"===u?(u=parseFloat(e[0]),
v=parseFloat(e[1]),s=parseFloat(e[1]),m=parseFloat(e[2])):(v=(new j.Vector).copy(d).subSelf(c),u=parseFloat(v.x),v=parseFloat(v.y),s=parseFloat(e[0]),m=parseFloat(e[1]));n&&(f+=b,k+=a,u+=b,v+=a,s+=b,m+=a);b=j.Utils.subdivide(b,a,f,k,u,v,s,m);d.set(s,m);c.set(u,v);break;case "a":throw new j.Utils.Error("not yet able to interpret Elliptical Arcs.");}return b}));_.isUndefined(b[b.length-1])&&b.pop();b=(new j.Polygon(b,q)).noStroke();return j.Utils.applySvgAttributes(a,b)})},circle:function(b){var c=
parseFloat(b.getAttribute("cx")),d=parseFloat(b.getAttribute("cy")),e=parseFloat(b.getAttribute("r")),n=j.Resolution,q=_.map(_.range(n),function(b){var d=b/n*a;b=e*k(d);d=e*p(d);return new j.Vector(b,d)},this),q=(new j.Polygon(q,!0,!0)).noStroke();q.translation.set(c,d);return j.Utils.applySvgAttributes(b,q)},ellipse:function(b){var c=parseFloat(b.getAttribute("cx")),d=parseFloat(b.getAttribute("cy")),e=parseFloat(b.getAttribute("rx")),n=parseFloat(b.getAttribute("ry")),q=j.Resolution,f=_.map(_.range(q),
function(b){var d=b/q*a;b=e*k(d);d=n*p(d);return new j.Vector(b,d)},this),f=(new j.Polygon(f,!0,!0)).noStroke();f.translation.set(c,d);return j.Utils.applySvgAttributes(b,f)},rect:function(a){var b=parseFloat(a.getAttribute("x")),d=parseFloat(a.getAttribute("y")),c=parseFloat(a.getAttribute("width")),e=parseFloat(a.getAttribute("height")),c=c/2,e=e/2,n=[new j.Vector(c,e),new j.Vector(-c,e),new j.Vector(-c,-e),new j.Vector(c,-e)],n=(new j.Polygon(n,!0)).noStroke();n.translation.set(b+c,d+e);return j.Utils.applySvgAttributes(a,
n)},line:function(a){var b=parseFloat(a.getAttribute("x1")),d=parseFloat(a.getAttribute("y1")),c=parseFloat(a.getAttribute("x2")),e=parseFloat(a.getAttribute("y2")),c=(c-b)/2,e=(e-d)/2,n=[new j.Vector(-c,-e),new j.Vector(c,e)],n=(new j.Polygon(n)).noFill();n.translation.set(b+c,d+e);return j.Utils.applySvgAttributes(a,n)}},subdivide:function(c,n,d,k,f,s,y,l,p){var z=j.Utils.Curve.CollinearityEpsilon,C=j.Utils.Curve.RecursionLimit,A=j.Utils.Curve.CuspLimit,r=j.Utils.Curve.Tolerance,t;p=p||0;if(p>C)return[];
var C=(c+d)/2,w=(n+k)/2,m=(d+f)/2,L=(k+s)/2,R=(f+y)/2,S=(s+l)/2,T=(C+m)/2,U=(w+L)/2,m=(m+R)/2,L=(L+S)/2,F=(T+m)/2,G=(U+L)/2;t=y-c;var D=l-n,J=e((d-y)*D-(k-l)*t),K=e((f-y)*D-(s-l)*t);if(0<p){if(J>z&&K>z&&(J+K)*(J+K)<=r.distance*(t*t+D*D)){if(r.angle<r.epsilon)return[new j.Vector(F,G)];t=b(s-k,f-d);z=e(t-b(k-n,d-c));t=e(b(l-s,y-f)-t);z>=q&&(z=a-z);t>=q&&(t=a-t);if(z+t<r.angle)return[new j.Vector(F,G)];if(0!==A){if(z>A)return[new j.Vector(d,k)];if(t>A)return[new j.Vector(f,s)]}}}else if(J>z)if(J*J<=
r.distance*(t*t+D*D)){if(r.angle<r.epsilon)return[new j.Vector(F,G)];z=e(b(s-k,f-d)-b(k-n,d-c));z>=q&&(z=a-z);if(z<r.angle)return[new j.Vector(d,k),new j.Vector(f,s)];if(0!==A&&z>A)return[new j.Vector(d,k)]}else if(K>z){if(K*K<=r.distance*(t*t+D*D)){if(r.angle<r.epsilon)return[new j.Vector(F,G)];z=e(b(l-s,y-f)-b(s-k,f-d));z>=q&&(z=a-z);if(z<r.angle)return[new j.Vector(d,k),new j.Vector(f,s)];if(0!==A&&z>A)return[new j.Vector2(f,s)]}}else if(t=F-(c+y)/2,D=G-(n+l)/2,t*t+D*D<=r.distance)return[new j.Vector(F,
G)];return j.Utils.subdivide(c,n,C,w,T,U,F,G,p+1).concat(j.Utils.subdivide(F,G,m,L,R,S,y,l,p+1))},getCurveFromPoints:function(a,b){for(var d=[],c=a.length,j=c-1,e=0;e<c;e++){var n=a[e],k={x:n.x,y:n.y};d.push(k);var n=b?w(e-1,c):Math.max(e-1,0),f=b?w(e+1,c):Math.min(e+1,j);t(a[n],k,a[f]);!k.u.x&&!k.u.y&&(k.u.x=k.x,k.u.y=k.y);!k.v.x&&!k.v.y&&(k.v.x=k.x,k.v.y=k.y)}return d},getControlPoints:function(a,b,d){var c=A(a,b),e=A(d,b);a=z(a,b);d=z(d,b);var j=(c+e)/2;if(1E-4>a||1E-4>d)return b.u={x:b.x,y:b.y},
b.v={x:b.x,y:b.y},b;a*=0.33;d*=0.33;j=e<c?j+n:j-n;c={x:b.x+k(j)*a,y:b.y+p(j)*a};j-=q;e={x:b.x+k(j)*d,y:b.y+p(j)*d};b.u=c;b.v=e;return b},angleBetween:function(a,c){return b(a.y-c.y,a.x-c.x)},distanceBetweenSquared:function(a,b){var d=a.x-b.x,c=a.y-b.y;return d*d+c*c},distanceBetween:function(a,b){return c(C(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Error:function(a){this.name="two.js";this.message=a}}});j.Utils.Error.prototype=Error();j.Utils.Error.prototype.constructor=j.Utils.Error;var z=
j.Utils.distanceBetween,C=j.Utils.distanceBetweenSquared,A=j.Utils.angleBetween,t=j.Utils.getControlPoints,w=j.Utils.mod;_.extend(j.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){j.Utils.setPlaying.call(this,!0);return this.trigger(j.Events.play)},pause:function(){this.playing=!1;return this.trigger(j.Events.pause)},update:function(){var a=!!this._lastFrame,b=(window.performance&&window.performance.now?window.performance:Date).now();
this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,d=this.renderer;(a!==d.width||b!==d.height)&&d.setSize(a,b);this.trigger(j.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(j.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},makeLine:function(a,b,d,c){d=(d-a)/2;c=
(c-b)/2;var e=[new j.Vector(-d,-c),new j.Vector(d,c)],e=(new j.Polygon(e)).noFill();e.translation.set(a+d,b+c);this.scene.add(e);return e},makeRectangle:function(a,b,d,c){d/=2;c/=2;c=[new j.Vector(d,c),new j.Vector(-d,c),new j.Vector(-d,-c),new j.Vector(d,-c)];c=new j.Polygon(c,!0);c.translation.set(a,b);this.scene.add(c);return c},makeCircle:function(a,b,d){return this.makeEllipse(a,b,d,d)},makeEllipse:function(b,c,d,e){var n=j.Resolution,f=_.map(_.range(n),function(b){var c=b/n*a;b=d*k(c);c=e*p(c);
return new j.Vector(b,c)},this),f=new j.Polygon(f,!0,!0);f.translation.set(b,c);this.scene.add(f);return f},makeCurve:function(a){var b=arguments.length,d=a;if(!_.isArray(a))for(var d=[],c=0;c<b;c+=2){var e=arguments[c];if(!_.isNumber(e))break;d.push(new j.Vector(e,arguments[c+1]))}var b=arguments[b-1],d=new j.Polygon(d,!(_.isBoolean(b)&&b),!0),b=d.getBoundingClientRect(),n=b.left+b.width/2,k=b.top+b.height/2;_.each(d.vertices,function(a){a.x-=n;a.y-=k});d.translation.set(n,k);this.scene.add(d);return d},
makePolygon:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],e=0;e<b;e+=2){var n=arguments[e];if(!_.isNumber(n))break;c.push(new j.Vector(n,arguments[e+1]))}b=arguments[b-1];c=new j.Polygon(c,!(_.isBoolean(b)&&b));c.center();this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new j.Group;this.scene.add(c);c.add(b);return c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in j.Utils.read))return null;a=j.Utils.read[b].call(this,
a);this.add(a);return a}});(function(){_.each(j.Instances,function(a){a.playing&&a.update()});requestAnimationFrame(arguments.callee)})()})();(function(){var r=Two.Vector=function(f,l){f=f||0;l=l||0;Object.defineProperty(this,"x",{get:function(){return f},set:function(l){f=l;this.trigger(Two.Events.change,"x")}});Object.defineProperty(this,"y",{get:function(){return l},set:function(f){l=f;this.trigger(Two.Events.change,"y")}})};_.extend(r,{});_.extend(r.prototype,Backbone.Events,{set:function(f,l){this.x=f;this.y=l;return this},copy:function(f){this.x=f.x;this.y=f.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new r(this.x,
this.y)},add:function(f,l){this.x=f.x+l.x;this.y=f.y+l.y;return this},addSelf:function(f){this.x+=f.x;this.y+=f.y;return this},sub:function(f,l){this.x=f.x-l.x;this.y=f.y-l.y;return this},subSelf:function(f){this.x-=f.x;this.y-=f.y;return this},multiplySelf:function(f){this.x*=f.x;this.y*=f.y;return this},multiplyScalar:function(f){this.x*=f;this.y*=f;return this},divideScalar:function(f){f?(this.x/=f,this.y/=f):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(f){return this.x*
f.x+this.y*f.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(f){return Math.sqrt(this.distanceToSquared(f))},distanceToSquared:function(f){var l=this.x-f.x;f=this.y-f.y;return l*l+f*f},setLength:function(f){return this.normalize().multiplyScalar(f)},equals:function(f){return 1E-4>this.distanceTo(f)},lerp:function(f,l){return this.set((f.x-this.x)*
l+this.x,(f.y-this.y)*l+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var r=Math.cos,f=Math.sin,l=Math.tan,p=Two.Matrix=function(k,b,c,e,f,a){this.elements=new Two.Array(9);var n=k;_.isArray(n)||(n=_.toArray(arguments));this.identity().set(n)};_.extend(p,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(k,b){if(3>=b.length){var c=b[0]||0,e=b[1]||0,f=b[2]||0;return{x:k[0]*c+k[1]*e+k[2]*f,y:k[3]*c+k[4]*e+k[5]*f,z:k[6]*c+k[7]*e+k[8]*f}}var c=k[0],e=k[1],f=k[2],a=k[3],n=k[4],y=k[5],s=k[6],j=k[7],l=k[8],p=b[0],r=b[1],t=b[2],w=b[3],u=b[4],v=b[5],d=b[6],
x=b[7],B=b[8];return[c*p+e*w+f*d,c*r+e*u+f*x,c*t+e*v+f*B,a*p+n*w+y*d,a*r+n*u+y*x,a*t+n*v+y*B,s*p+j*w+l*d,s*r+j*u+l*x,s*t+j*v+l*B]}});_.extend(p.prototype,Backbone.Events,{set:function(k,b,c,e,f,a){var n=k;_.isArray(n)||(n=_.toArray(arguments));_.each(n,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(p.Identity);return this},multiply:function(k,b,c,e,f,a,n,y,s){var j=arguments,l=j.length;if(1>=l)return _.each(this.elements,
function(a,b){this.elements[b]=a*k},this),this.trigger(Two.Events.change);if(3>=l)return k=k||0,b=b||0,c=c||0,f=this.elements,{x:f[0]*k+f[1]*b+f[2]*c,y:f[3]*k+f[4]*b+f[5]*c,z:f[6]*k+f[7]*b+f[8]*c};l=this.elements;A0=l[0];A1=l[1];A2=l[2];A3=l[3];A4=l[4];A5=l[5];A6=l[6];A7=l[7];A8=l[8];B0=j[0];B1=j[1];B2=j[2];B3=j[3];B4=j[4];B5=j[5];B6=j[6];B7=j[7];B8=j[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=
A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this.trigger(Two.Events.change)},scale:function(f,b){1>=arguments.length&&(b=f);return this.multiply(f,0,0,0,b,0,0,0,1)},rotate:function(k){var b=r(k);k=f(k);return this.multiply(b,-k,0,k,b,0,0,0,1)},translate:function(f,b){return this.multiply(1,0,f,0,1,b,0,0,1)},skewX:function(f){f=l(f);return this.multiply(1,f,0,0,1,0,0,0,1)},skewY:function(f){f=
l(f);return this.multiply(1,0,0,f,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(f){var b=this.elements,c=parseFloat(b[0].toFixed(3)),e=parseFloat(b[1].toFixed(3)),q=parseFloat(b[2].toFixed(3)),a=parseFloat(b[3].toFixed(3)),n=parseFloat(b[4].toFixed(3)),y=parseFloat(b[5].toFixed(3));if(f){f=parseFloat(b[6].toFixed(3));var s=parseFloat(b[7].toFixed(3)),b=parseFloat(b[8].toFixed(3));return[c,a,f,e,n,s,q,y,b]}return[c,a,e,n,q,y]},clone:function(){var f=this.elements[0],
b=this.elements[1],c=this.elements[2],e=this.elements[3],q=this.elements[4],a=this.elements[5];g=this.elements[6];h=this.elements[7];i=this.elements[8];return new Two.Matrix(f,b,c,e,q,a,g,h,i)}})})();(function(){function r(b){var c={},e=b.id,f=b.translation,a=b.rotation,n=b.scale,y=b.stroke,s=b.linewidth,j=b.fill,l=b.opacity,r=b.visible,A=b.cap,t=b.join,w=b.miter,u=b.curved,v=b.closed,d=b.vertices;e&&(c.id=k.Identifier+e);f&&(_.isNumber(n)&&_.isNumber(a))&&(c.transform="matrix("+b._matrix.toString()+")");y&&(c.stroke=y);j&&(c.fill=j);l&&(c["stroke-opacity"]=c["fill-opacity"]=l);c.visibility=r?"visible":"hidden";A&&(c["stroke-linecap"]=A);t&&(c["stroke-linejoin"]=t);w&&(c["stroke-miterlimit"]=
w);s&&(c["stroke-width"]=s);d&&(c.d=p.toString(d,v,u));return c}var f=Two.Utils.getCurveFromPoints,l=Two.Utils.mod,p={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(b,c){var e=b.toLowerCase(),f=document.createElementNS(this.ns,e);"svg"===e&&(c=_.defaults(c||{},{version:this.version}));_.isObject(c)&&this.setAttributes(f,c);return f},setAttributes:function(b,c){_.each(c,function(b,c){this.setAttribute(c,b)},b);return this},removeAttributes:function(b,
c){_.each(c,function(b){this.removeAttribute(b)},b);return this},toString:function(b,c,e){var k=b.length,a=k-1;if(!e)return _.map(b,function(b,e){var j;j=(0>=e?"M":"L")+(" "+b.x.toFixed(3)+" "+b.y.toFixed(3));e>=a&&c&&(j+=" Z");return j}).join(" ");var n=f(b,c);return _.map(n,function(b,e){var j,f=c?l(e-1,k):Math.max(e-1,0),p=c?l(e+1,k):Math.min(e+1,a);j=n[f];var p=n[p],f=j.v.x.toFixed(3),r=j.v.y.toFixed(3),t=b.u.x.toFixed(3),w=b.u.y.toFixed(3),u=b.x.toFixed(3),v=b.y.toFixed(3);j=0>=e?"M "+u+" "+
v:"C "+f+" "+r+" "+t+" "+w+" "+u+" "+v;e>=a&&c&&(f=b.v.x.toFixed(3),r=b.v.y.toFixed(3),t=p.u.x.toFixed(3),w=p.u.y.toFixed(3),u=p.x.toFixed(3),v=p.y.toFixed(3),j=j+(" C "+f+" "+r+" "+t+" "+w+" "+u+" "+v)+" Z");return j}).join(" ")}},k=Two[Two.Types.svg]=function(){this.count=0;this.domElement=p.createElement("svg");this.elements=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(k,{Identifier:"two-"});_.extend(k.prototype,
Backbone.Events,{setSize:function(b,c){this.width=b;this.height=c;p.setAttributes(this.domElement,{width:b,height:c});return this},add:function(b){var c=b,e=this.elements,f=this.domElement;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(a){var b;b=a instanceof Two.Group;if(_.isUndefined(a.id)){var c=this.count;this.count++;a.id=c}b?(b="g",_.isUndefined(a.parent)&&(a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),a=r(a),delete a.stroke,
delete a.fill,delete a["fill-opacity"],delete a["stroke-opacity"],delete a["stroke-linecap"],delete a["stroke-linejoin"],delete a["stroke-miterlimit"],delete a["stroke-width"]):(b="path",a=r(a));a=p.createElement(b,a);f.appendChild(a);e.push(a)},this);return this},update:function(b,c,e,f,a){var n=this.elements,k=n[b];switch(c){case Two.Properties.hierarchy:_.each(e,function(a){k.appendChild(n[a])});break;case Two.Properties.demotion:_.each(e,function(a){k.removeChild(n[a])});break;default:a:{b=c;
switch(b){case "matrix":b="transform";e="matrix("+e.toString()+")";break;case "visible":b="visibility";e=e?"visible":"hidden";break;case "cap":b="stroke-linecap";break;case "join":b="stroke-linejoin";break;case "miter":b="stroke-miterlimit";break;case "linewidth":b="stroke-width";break;case "vertices":b="d";e=p.toString(e,f,a);break;case "opacity":p.setAttributes(k,{"stroke-opacity":e,"fill-opacity":e});break a}k.setAttribute(b,e)}}return this},render:function(){this.unveil();return this}})})();(function(){var r=Two.Utils.getCurveFromPoints,f=Two.Utils.mod,l=function(b){_.each(b,function(b,c){this[c]=b},this);this.children={}};_.extend(l.prototype,{appendChild:function(b){var e=b.parent,f=b.id;_.isUndefined(e)||delete e.children[f];this.children[f]=b;b.parent=this;return this},removeChild:function(b){delete this.children[b.id];return this},render:function(b){var e=this.matrix;b.save();b.transform(e[0],e[1],e[2],e[3],e[4],e[5]);_.each(this.children,function(e){e.render(b)});b.restore();return this}});
var p=function(b){_.each(b,function(b,c){this[c]=b},this)};_.extend(p.prototype,{render:function(b){var e=this.matrix,k=this.stroke,a=this.linewidth,n=this.fill,l=this.opacity,s=this.cap,j=this.join,p=this.miter,r=this.curved,A=this.closed,t=this.commands,w=t.length,u=w-1;if(!this.visible)return this;b.save();e&&b.transform(e[0],e[1],e[2],e[3],e[4],e[5]);n&&(b.fillStyle=n);k&&(b.strokeStyle=k);a&&(b.lineWidth=a);p&&(b.miterLimit=p);j&&(b.lineJoin=j);s&&(b.lineCap=s);_.isNumber(l)&&(b.globalAlpha=
l);b.beginPath();_.each(t,function(a,d){var e=a.x.toFixed(3),j=a.y.toFixed(3);if(r){var n=A?f(d-1,w):Math.max(d-1,0),k=A?f(d+1,w):Math.min(d+1,u),s=t[n],k=t[k],n=s.v.x.toFixed(3),s=s.v.y.toFixed(3),l=a.u.x.toFixed(3),q=a.u.y.toFixed(3);0>=d?b.moveTo(e,j):(b.bezierCurveTo(n,s,l,q,e,j),d>=u&&A&&(n=a.v.x.toFixed(3),s=a.v.y.toFixed(3),l=k.u.x.toFixed(3),q=k.u.y.toFixed(3),e=k.x.toFixed(3),j=k.y.toFixed(3),b.bezierCurveTo(n,s,l,q,e,j)))}else 0>=d?b.moveTo(e,j):b.lineTo(e,j)});A&&!r&&b.closePath();b.fill();
b.stroke();b.restore()}});var k={toArray:function(b,e,f){return!e?_.map(b,function(a){return{x:a.x,y:a.y}}):r(b,f)}},b=Two[Two.Types.canvas]=function(){this.count=0;this.domElement=document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.elements=[];this.stage=null};_.extend(b,{});_.extend(b,{Group:l,Element:p,getStyles:function(b){var e={},f=b.id,a=b._matrix,n=b.stroke,l=b.linewidth,s=b.fill,j=b.opacity,p=b.visible,r=b.cap,A=b.join,t=b.miter,w=b.curved,u=b.closed;b=b.vertices;
f&&(e.id=f);_.isObject(a)&&(e.matrix=a.toArray());n&&(e.stroke=n);s&&(e.fill=s);_.isNumber(j)&&(e.opacity=j);r&&(e.cap=r);A&&(e.join=A);t&&(e.miter=t);l&&(e.linewidth=l);b&&(e.commands=k.toArray(b,w,u));e.visible=!!p;e.curved=!!w;e.closed=!!u;return e},setStyles:function(b,e,f,a,n){switch(e){case "matrix":e="matrix";f=f.toArray();break;case "vertices":e="commands",b.curved=n,b.closed=a,f=k.toArray(f,b.curved,b.closed)}b[e]=f},Utils:k});_.extend(b.prototype,Backbone.Events,{setSize:function(b,e){this.width=
this.domElement.width=b;this.height=this.domElement.height=e;_.extend(this.domElement.style,{width:this.width+"px",height:this.height+"px"});return this},add:function(b){constructor=Object.getPrototypeOf(this).constructor;var e=b,f=this.elements,a=constructor.Group,n=constructor.Element,k=constructor.getStyles;_.isArray(b)||(e=_.map(arguments,function(a){return a}));_.each(e,function(b){var c;c=b instanceof Two.Group;var e=_.isNull(this.stage);if(_.isUndefined(b.id)){var l=this.count;this.count++;
b.id=l}c?(c=k.call(this,b),delete c.stroke,delete c.fill,delete c.opacity,delete c.cap,delete c.join,delete c.miter,delete c.linewidth,c=new a(c),e&&(this.stage=c,this.stage.object=b,b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):c=new n(k.call(this,b));f.push(c);e||this.stage.appendChild(c)},this);return this},update:function(b,e,f,a,n,k){var l=Object.getPrototypeOf(this).constructor,j=this.elements,p=j[b];switch(e){case Two.Properties.hierarchy:_.each(f,
function(a){p.appendChild(j[a])});break;case Two.Properties.demotion:_.each(f,function(a){p.removeChild(j[a]);this.elements[a]=null},this);break;default:l.setStyles.call(this,p,e,f,a,n,k)}return this},render:function(){if(_.isNull(this.stage))return this;this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);return this}})})();(function(){function r(a,b){var c=Math.min(a.top,b.top),e=Math.min(a.left,b.left),j=Math.max(a.right,b.right),f=Math.max(a.bottom,b.bottom);return{top:c,left:e,right:j,bottom:f,width:j-e,height:f-c,centroid:{x:-e,y:-c}}}var f=Two[Two.Types.canvas],l=Two.Matrix.Multiply,p=Two[Two.Types.canvas].Utils.toArray,k=Two.Utils.mod,b=function(a){f.Group.call(this,a)};_.extend(b.prototype,f.Group.prototype,{appendChild:function(){f.Group.prototype.appendChild.apply(this,arguments);this.updateMatrix();return this},
updateTexture:function(a){_.each(this.children,function(b){b.updateTexture(a)});return this},updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=l(this.matrix,b);this._scale=this.scale*a;_.each(this.children,function(a){a.updateMatrix(this)},this);return this},render:function(a,b){_.each(this.children,function(c){c.render(a,b)})}});var c=function(a){f.Element.call(this,a)};_.extend(c.prototype,
f.Element.prototype,{updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=l(this.matrix,b);this._scale=this.scale*a;return this},updateTexture:function(a){e.updateTexture(a,this);return this},render:function(a,b){if(!this.visible||!this.opacity||!this.buffer)return this;a.bindBuffer(a.ARRAY_BUFFER,this.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,
this.texture);a.uniformMatrix3fv(b.matrix,!1,this._matrix);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this}});var e={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(a,b,c){var e=Infinity,j=-Infinity,f=Infinity,k=-Infinity;_.each(a,function(a){var b=a.x,n=a.y,l;f=Math.min(n,f);e=Math.min(b,e);j=Math.max(b,j);k=Math.max(n,k);c&&(b=a.u.x,n=a.u.y,l=a.v.x,
a=a.v.y,f=Math.min(n,a,f),e=Math.min(b,l,e),j=Math.max(b,l,j),k=Math.max(n,a,k))});_.isNumber(b)&&(f-=b,e-=b,j+=b,k+=b);return{top:f,left:e,right:j,bottom:k,width:j-e,height:k-f,centroid:{x:-e,y:-f}}},getTriangles:function(a){var b=a.top,c=a.left,e=a.right;a=a.bottom;return new Two.Array([c,b,e,b,c,a,c,a,e,b,e,a])},updateCanvas:function(a){var b=a.commands,c=this.canvas,e=this.ctx,j=a._scale,f=a.stroke,l=a.linewidth*j,p=a.fill,q=a.opacity,r=a.cap,u=a.join,v=a.miter,d=a.curved,x=a.closed,B=b.length,
M=B-1;c.width=Math.max(Math.ceil(a.rect.width*j),1);c.height=Math.max(Math.ceil(a.rect.height*j),1);a=a.rect.centroid;var H=a.x*j,E=a.y*j;e.clearRect(0,0,c.width,c.height);p&&(e.fillStyle=p);f&&(e.strokeStyle=f);l&&(e.lineWidth=l);v&&(e.miterLimit=v);u&&(e.lineJoin=u);r&&(e.lineCap=r);_.isNumber(q)&&(e.globalAlpha=q);e.beginPath();_.each(b,function(a,c){var f=(a.x*j+H).toFixed(3),l=(a.y*j+E).toFixed(3);if(d){var p=x?k(c-1,B):Math.max(c-1,0),q=x?k(c+1,B):Math.min(c+1,M),r=b[p],q=b[q],p=(r.v.x*j+H).toFixed(3),
r=(r.v.y*j+E).toFixed(3),m=(a.u.x*j+H).toFixed(3),y=(a.u.y*j+E).toFixed(3);0>=c?e.moveTo(f,l):(e.bezierCurveTo(p,r,m,y,f,l),c>=M&&x&&(p=(a.v.x*j+H).toFixed(3),r=(a.v.y*j+E).toFixed(3),m=(q.u.x*j+H).toFixed(3),y=(q.u.y*j+E).toFixed(3),f=(q.x*j+H).toFixed(3),l=(q.y*j+E).toFixed(3),e.bezierCurveTo(p,r,m,y,f,l)))}else 0>=c?e.moveTo(f,l):e.lineTo(f,l)});x&&!d&&e.closePath();e.fill();e.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b.texture&&a.deleteTexture(b.texture);a.bindBuffer(a.ARRAY_BUFFER,
b.textureCoordsBuffer);b.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b.buffer)&&a.deleteBuffer(b.buffer);b.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,
b.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW);_.isObject(b.textureCoordsBuffer)&&a.deleteBuffer(b.textureCoordsBuffer);b.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)});a.linkProgram(c);if(!a.getProgramParameter(c,
a.LINK_STATUS))throw error=a.getProgramInfoLog(c),a.deleteProgram(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){c=a.createShader(a[c]);a.shaderSource(c,b);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw b=a.getShaderInfoLog(c),a.deleteShader(c),new Two.Utils.Error("unable to compile shader "+c+": "+b);return c},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};e.ctx=e.canvas.getContext("2d");var q=Two[Two.Types.webgl]=function(a){this.count=0;this.domElement=document.createElement("canvas");this.elements=[];this.stage=null;a=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!1});a=this.ctx=this.domElement.getContext("webgl",a)||this.domElement.getContext("experimental-webgl",
a);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var b=e.shaders.create(a,e.shaders.vertex,e.shaders.types.vertex),c=e.shaders.create(a,e.shaders.fragment,e.shaders.types.fragment);this.program=e.program.create(a,[b,c]);a.useProgram(this.program);this.program.position=a.getAttribLocation(this.program,"a_position");this.program.matrix=a.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=a.getAttribLocation(this.program,"a_textureCoords");
a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)};_.extend(q,{Group:b,Element:c,getStyles:function(a){var b={},f=a.id,k=a._matrix,j=a.stroke,l=a.linewidth,q=a.fill,r=a.opacity,t=a.visible,w=a.cap,u=a.join,v=a.miter,d=a.curved,x=a.closed,B=a.vertices;f&&(b.id=f);_.isObject(k)&&(b.matrix=b._matrix=k.toArray(!0),b.scale=b._scale=1);j&&(b.stroke=j);q&&(b.fill=q);_.isNumber(r)&&(b.opacity=
r);w&&(b.cap=w);u&&(b.join=u);v&&(b.miter=v);l&&(b.linewidth=l);B&&(b.vertices=p(B,d,x),b.commands=b.vertices,b.rect=e.getBoundingClientRect(b.commands,b.linewidth,b.curved),b.triangles=e.getTriangles(b.rect));b.visible=!!t;b.curved=!!d;b.closed=!!x;a instanceof Two.Polygon&&(e.updateBuffer(this.ctx,b,this.program),c.prototype.updateTexture.call(b,this.ctx));return b},setStyles:function(a,b,c,f,j,k){var l=!1;/matrix/.test(b)?(a[b]=c.toArray(!0),_.isNumber(f)&&(l=a.scale!==f,a.scale=f),a.updateMatrix()):
/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(b)?(a[b]=c,a.rect=r(e.getBoundingClientRect(a.commands,a.linewidth,a.curved),a.rect),a.triangles=e.getTriangles(a.rect),e.updateBuffer(this.ctx,a,this.program),l=!0):"vertices"===b?(_.isUndefined(f)||(a.closed=f),_.isUndefined(j)||(a.curved=j),k?a.commands=p(c,a.curved,a.closed):(a.vertices=p(c,a.curved,a.closed),a.commands=a.vertices),a.rect=r(e.getBoundingClientRect(a.vertices,a.linewidth,a.curved),a.rect),a.triangles=e.getTriangles(a.rect),
e.updateBuffer(this.ctx,a,this.program),l=!0):a[b]=c;l&&a.updateTexture(this.ctx)}});_.extend(q.prototype,Backbone.Events,f.prototype,{setSize:function(a,b){f.prototype.setSize.apply(this,arguments);this.ctx.viewport(0,0,a,b);var c=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(c,a,b);return this},render:function(){if(_.isNull(this.stage))return this;this.stage.render(this.ctx,this.program);return this}})})();(function(){var r=Two.Shape=function(f){this._matrix=new Two.Matrix;var l=_.debounce(_.bind(function(){var f=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation).multiply.apply(this._matrix,this.matrix.elements);this.trigger(Two.Events.change,this.id,"matrix",f,this.scale)},this),0);this._rotation=0;Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(f){this._rotation=f;l()}});this._scale="scale";Object.defineProperty(this,
"scale",{get:function(){return this._scale},set:function(f){this._scale=f;l()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,l);this.matrix=new Two.Matrix;this.matrix.bind(Two.Events.change,l);if(f)return this;r.MakeGetterSetter(this,r.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=1};_.extend(r,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),
MakeGetterSetter:function(f,l){_.isArray(l)||(l=[l]);_.each(l,function(l){var k="_"+l;Object.defineProperty(f,l,{get:function(){return this[k]},set:function(b){this[k]=b;this.trigger(Two.Events.change,this.id,l,b,this)}})})}});_.extend(r.prototype,Backbone.Events,{addTo:function(f){f.add(this);return this},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},clone:function(){var f=new r;f.translation.copy(this.translation);_.each(r.Properties,
function(l){f[l]=this[l]},this);return this}})})();(function(){var r=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;r.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(r,{MakeGetterSetter:function(f,l){_.isArray(l)||(l=[l]);_.each(l,function(l){var k="_"+l;Object.defineProperty(f,l,{get:function(){return this[k]},set:function(b){this[k]=b;_.each(this.children,function(c){c[l]=b})}})})}});_.extend(r.prototype,
Two.Shape.prototype,{clone:function(f){f=f||this.parent;var l=_.map(this.children,function(k){return k.clone(f)}),p=new r;f.add(p);p.add(l);p.translation.copy(this.translation);p.rotation=this.rotation;p.scale=this.scale;return p},center:function(){var f=this.getBoundingClientRect();f.centroid={x:f.left+f.width/2,y:f.top+f.height/2};_.each(this.children,function(l){l.translation.subSelf(f.centroid)});this.translation.copy(f.centroid);return this},add:function(f){var l=f,p=this.children,k=this.parent,
b=[];_.isArray(f)||(l=_.toArray(arguments));var c=_.bind(function(b,c,a,f,k,l){this.trigger(Two.Events.change,b,c,a,f,k,l)},this);_.each(l,function(e){var f=e.id,a=e.parent;_.isUndefined(f)&&(k.add(e),f=e.id);_.isUndefined(p[f])&&(a&&delete a.children[f],p[f]=e,e.parent=this,e.unbind(Two.Events.change).bind(Two.Events.change,c),b.push(f))},this);0<b.length&&this.trigger(Two.Events.change,this.id,Two.Properties.hierarchy,b);return this},remove:function(f){var l=f,p=this.children,k=this.parent,b=[];
if(0>=arguments.length&&k)return k.remove(this),this;_.isArray(f)||(l=_.toArray(arguments));_.each(l,function(c){var e=c.id;e in p&&(delete p[e],c.unbind(Two.Events.change),b.push(e))});0<b.length&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,b);return this},getBoundingClientRect:function(){var f=Infinity,l=-Infinity,p=Infinity,k=-Infinity;_.each(this.children,function(b){b=b.getBoundingClientRect();p&&(f&&l&&k)&&(p=Math.min(b.top,p),f=Math.min(b.left,f),l=Math.max(b.right,l),k=
Math.max(b.bottom,k))},this);var b=this._matrix.multiply(f,p,1),c=this._matrix.multiply(l,k,1);return{top:b.y,left:b.x,right:c.x,bottom:c.y,width:c.x-b.x,height:c.y-b.y}},noFill:function(){_.each(this.children,function(f){f.noFill()});return this},noStroke:function(){_.each(this.children,function(f){f.noStroke()});return this}})})();(function(){var r=Math.min,f=Math.max,l=Math.round,p=Two.Polygon=function(k,b,c){Two.Shape.call(this);b=!!b;c=!!c;var e=0,q=1,a=!1,n=k.slice(0),p=_.debounce(_.bind(function(){var f,j;if(a){f=this.vertices.length;f-=1;j=l(e*f);f=l(q*f);for(n.length=0;j<f+1;j++){var k=this.vertices[j];n.push(new Two.Vector(k.x,k.y))}}this.trigger(Two.Events.change,this.id,"vertices",n,b,c,a);a=!1},this),0);Object.defineProperty(this,"closed",{get:function(){return b},set:function(a){b=!!a;p()}});Object.defineProperty(this,
"curved",{get:function(){return c},set:function(a){c=!!a;p()}});Object.defineProperty(this,"beginning",{get:function(){return e},set:function(b){e=r(f(b,0),1);a=!0;p()}});Object.defineProperty(this,"ending",{get:function(){return q},set:function(b){q=r(f(b,0),1);a=!0;p()}});this.vertices=k.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,p)},this);p()};_.extend(p.prototype,Two.Shape.prototype,{clone:function(){var f=_.map(this.vertices,function(b){return new Two.Vector(b.x,b.y)}),
b=new p(f,this.closed,this.curved);_.each(Two.Shape.Properties,function(c){b[c]=this[c]},this);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},center:function(){var f=this.getBoundingClientRect();f.centroid={x:f.left+f.width/2,y:f.top+f.height/2};_.each(this.vertices,function(b){b.subSelf(f.centroid)});this.translation.addSelf(f.centroid);return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(){var f=
this.linewidth,b=Infinity,c=-Infinity,e=Infinity,l=-Infinity;_.each(this.vertices,function(a){var f=a.x;a=a.y;e=Math.min(a,e);b=Math.min(f,b);c=Math.max(f,c);l=Math.max(a,l)});var e=e-f,b=b-f,c=c+f,l=l+f,f=this._matrix.multiply(b,e,1),a=this._matrix.multiply(c,l,1);return{top:f.y,left:f.x,right:a.x,bottom:a.y,width:a.x-f.x,height:a.y-f.y}}})})();
