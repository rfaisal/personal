(function(){function l(c,n,s){if(c===n)return 0!==c||1/c==1/n;if(null==c||null==n)return c===n;c._chain&&(c=c._wrapped);n._chain&&(n=n._wrapped);if(c.isEqual&&e.isFunction(c.isEqual))return c.isEqual(n);if(n.isEqual&&e.isFunction(n.isEqual))return n.isEqual(c);var d=a.call(c);if(d!=a.call(n))return!1;switch(d){case "[object String]":return c==String(n);case "[object Number]":return c!=+c?n!=+n:0==c?1/c==1/n:c==+n;case "[object Date]":case "[object Boolean]":return+c==+n;case "[object RegExp]":return c.source==
n.source&&c.global==n.global&&c.multiline==n.multiline&&c.ignoreCase==n.ignoreCase}if("object"!=typeof c||"object"!=typeof n)return!1;for(var b=s.length;b--;)if(s[b]==c)return!0;s.push(c);var b=0,h=!0;if("[object Array]"==d){if(b=c.length,h=b==n.length)for(;b--&&(h=b in c==b in n&&l(c[b],n[b],s)););}else{if("constructor"in c!="constructor"in n||c.constructor!=n.constructor)return!1;for(var g in c)if(e.has(c,g)&&(b++,!(h=e.has(n,g)&&l(c[g],n[g],s))))break;if(h){for(g in n)if(e.has(n,g)&&!b--)break;
h=!b}}s.pop();return h}var f=this,j=f._,p={},k=Array.prototype,g=Object.prototype,d=k.slice,b=k.unshift,a=g.toString,h=g.hasOwnProperty,B=k.forEach,m=k.map,t=k.reduce,C=k.reduceRight,q=k.filter,D=k.every,y=k.some,u=k.indexOf,r=k.lastIndexOf,g=Array.isArray,x=Object.keys,v=Function.prototype.bind,e=function(c){return new z(c)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports._=e):f._=e;e.VERSION="1.3.3";var w=e.each=e.forEach=function(c,
n,s){if(null!=c)if(B&&c.forEach===B)c.forEach(n,s);else if(c.length===+c.length)for(var a=0,b=c.length;a<b&&!(a in c&&n.call(s,c[a],a,c)===p);a++);else for(a in c)if(e.has(c,a)&&n.call(s,c[a],a,c)===p)break};e.map=e.collect=function(c,e,s){var a=[];if(null==c)return a;if(m&&c.map===m)return c.map(e,s);w(c,function(c,b,d){a[a.length]=e.call(s,c,b,d)});c.length===+c.length&&(a.length=c.length);return a};e.reduce=e.foldl=e.inject=function(c,n,s,a){var b=2<arguments.length;null==c&&(c=[]);if(t&&c.reduce===
t)return a&&(n=e.bind(n,a)),b?c.reduce(n,s):c.reduce(n);w(c,function(c,e,d){b?s=n.call(a,s,c,e,d):(s=c,b=!0)});if(!b)throw new TypeError("Reduce of empty array with no initial value");return s};e.reduceRight=e.foldr=function(c,n,a,b){var d=2<arguments.length;null==c&&(c=[]);if(C&&c.reduceRight===C)return b&&(n=e.bind(n,b)),d?c.reduceRight(n,a):c.reduceRight(n);var h=e.toArray(c).reverse();b&&!d&&(n=e.bind(n,b));return d?e.reduce(h,n,a,b):e.reduce(h,n)};e.find=e.detect=function(c,e,a){var b;I(c,function(c,
d,h){if(e.call(a,c,d,h))return b=c,!0});return b};e.filter=e.select=function(c,e,a){var b=[];if(null==c)return b;if(q&&c.filter===q)return c.filter(e,a);w(c,function(c,d,h){e.call(a,c,d,h)&&(b[b.length]=c)});return b};e.reject=function(c,e,a){var b=[];if(null==c)return b;w(c,function(c,d,h){e.call(a,c,d,h)||(b[b.length]=c)});return b};e.every=e.all=function(c,e,a){var b=!0;if(null==c)return b;if(D&&c.every===D)return c.every(e,a);w(c,function(c,d,h){if(!(b=b&&e.call(a,c,d,h)))return p});return!!b};
var I=e.some=e.any=function(c,n,a){n||(n=e.identity);var b=!1;if(null==c)return b;if(y&&c.some===y)return c.some(n,a);w(c,function(c,e,d){if(b||(b=n.call(a,c,e,d)))return p});return!!b};e.include=e.contains=function(c,e){var a=!1;return null==c?a:u&&c.indexOf===u?-1!=c.indexOf(e):a=I(c,function(c){return c===e})};e.invoke=function(c,n){var a=d.call(arguments,2);return e.map(c,function(c){return(e.isFunction(n)?n||c:c[n]).apply(c,a)})};e.pluck=function(c,a){return e.map(c,function(c){return c[a]})};
e.max=function(c,a,b){if(!a&&e.isArray(c)&&c[0]===+c[0])return Math.max.apply(Math,c);if(!a&&e.isEmpty(c))return-Infinity;var d={computed:-Infinity};w(c,function(c,e,h){e=a?a.call(b,c,e,h):c;e>=d.computed&&(d={value:c,computed:e})});return d.value};e.min=function(c,a,b){if(!a&&e.isArray(c)&&c[0]===+c[0])return Math.min.apply(Math,c);if(!a&&e.isEmpty(c))return Infinity;var d={computed:Infinity};w(c,function(c,e,h){e=a?a.call(b,c,e,h):c;e<d.computed&&(d={value:c,computed:e})});return d.value};e.shuffle=
function(c){var e=[],a;w(c,function(c,b){a=Math.floor(Math.random()*(b+1));e[b]=e[a];e[a]=c});return e};e.sortBy=function(c,a,b){var d=e.isFunction(a)?a:function(c){return c[a]};return e.pluck(e.map(c,function(c,e,a){return{value:c,criteria:d.call(b,c,e,a)}}).sort(function(c,e){var a=c.criteria,b=e.criteria;return void 0===a?1:void 0===b?-1:a<b?-1:a>b?1:0}),"value")};e.groupBy=function(c,a){var b={},d=e.isFunction(a)?a:function(c){return c[a]};w(c,function(c,e){var a=d(c,e);(b[a]||(b[a]=[])).push(c)});
return b};e.sortedIndex=function(c,a,b){b||(b=e.identity);for(var d=0,h=c.length;d<h;){var g=d+h>>1;b(c[g])<b(a)?d=g+1:h=g}return d};e.toArray=function(c){return!c?[]:e.isArray(c)||e.isArguments(c)?d.call(c):c.toArray&&e.isFunction(c.toArray)?c.toArray():e.values(c)};e.size=function(c){return e.isArray(c)?c.length:e.keys(c).length};e.first=e.head=e.take=function(c,e,a){return null!=e&&!a?d.call(c,0,e):c[0]};e.initial=function(c,e,a){return d.call(c,0,c.length-(null==e||a?1:e))};e.last=function(c,
e,a){return null!=e&&!a?d.call(c,Math.max(c.length-e,0)):c[c.length-1]};e.rest=e.tail=function(c,e,a){return d.call(c,null==e||a?1:e)};e.compact=function(c){return e.filter(c,function(c){return!!c})};e.flatten=function(c,a){return e.reduce(c,function(c,b){if(e.isArray(b))return c.concat(a?b:e.flatten(b));c[c.length]=b;return c},[])};e.without=function(c){return e.difference(c,d.call(arguments,1))};e.uniq=e.unique=function(c,a,b){b=b?e.map(c,b):c;var d=[];3>c.length&&(a=!0);e.reduce(b,function(b,h,
g){if(a?e.last(b)!==h||!b.length:!e.include(b,h))b.push(h),d.push(c[g]);return b},[]);return d};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=e.intersect=function(c){var a=d.call(arguments,1);return e.filter(e.uniq(c),function(c){return e.every(a,function(a){return 0<=e.indexOf(a,c)})})};e.difference=function(c){var a=e.flatten(d.call(arguments,1),!0);return e.filter(c,function(c){return!e.include(a,c)})};e.zip=function(){for(var c=d.call(arguments),a=e.max(e.pluck(c,"length")),
b=Array(a),h=0;h<a;h++)b[h]=e.pluck(c,""+h);return b};e.indexOf=function(c,a,b){if(null==c)return-1;var d;if(b)return b=e.sortedIndex(c,a),c[b]===a?b:-1;if(u&&c.indexOf===u)return c.indexOf(a);b=0;for(d=c.length;b<d;b++)if(b in c&&c[b]===a)return b;return-1};e.lastIndexOf=function(c,e){if(null==c)return-1;if(r&&c.lastIndexOf===r)return c.lastIndexOf(e);for(var a=c.length;a--;)if(a in c&&c[a]===e)return a;return-1};e.range=function(c,e,a){1>=arguments.length&&(e=c||0,c=0);a=arguments[2]||1;for(var b=
Math.max(Math.ceil((e-c)/a),0),d=0,h=Array(b);d<b;)h[d++]=c,c+=a;return h};var J=function(){};e.bind=function(c,a){var b,h;if(c.bind===v&&v)return v.apply(c,d.call(arguments,1));if(!e.isFunction(c))throw new TypeError;h=d.call(arguments,2);return b=function(){if(!(this instanceof b))return c.apply(a,h.concat(d.call(arguments)));J.prototype=c.prototype;var e=new J,g=c.apply(e,h.concat(d.call(arguments)));return Object(g)===g?g:e}};e.bindAll=function(c){var a=d.call(arguments,1);0==a.length&&(a=e.functions(c));
w(a,function(a){c[a]=e.bind(c[a],c)});return c};e.memoize=function(c,a){var b={};a||(a=e.identity);return function(){var d=a.apply(this,arguments);return e.has(b,d)?b[d]:b[d]=c.apply(this,arguments)}};e.delay=function(c,e){var a=d.call(arguments,2);return setTimeout(function(){return c.apply(null,a)},e)};e.defer=function(c){return e.delay.apply(e,[c,1].concat(d.call(arguments,1)))};e.throttle=function(c,a){var b,d,h,g,k,f,r=e.debounce(function(){k=g=!1},a);return function(){b=this;d=arguments;h||
(h=setTimeout(function(){h=null;k&&c.apply(b,d);r()},a));g?k=!0:f=c.apply(b,d);r();g=!0;return f}};e.debounce=function(c,a,e){var b;return function(){var d=this,h=arguments;e&&!b&&c.apply(d,h);clearTimeout(b);b=setTimeout(function(){b=null;e||c.apply(d,h)},a)}};e.once=function(c){var e=!1,a;return function(){if(e)return a;e=!0;return a=c.apply(this,arguments)}};e.wrap=function(c,e){return function(){var a=[c].concat(d.call(arguments,0));return e.apply(this,a)}};e.compose=function(){var c=arguments;
return function(){for(var e=arguments,a=c.length-1;0<=a;a--)e=[c[a].apply(this,e)];return e[0]}};e.after=function(c,e){return 0>=c?e():function(){if(1>--c)return e.apply(this,arguments)}};e.keys=x||function(c){if(c!==Object(c))throw new TypeError("Invalid object");var a=[],b;for(b in c)e.has(c,b)&&(a[a.length]=b);return a};e.values=function(c){return e.map(c,e.identity)};e.functions=e.methods=function(c){var a=[],b;for(b in c)e.isFunction(c[b])&&a.push(b);return a.sort()};e.extend=function(c){w(d.call(arguments,
1),function(a){for(var e in a)c[e]=a[e]});return c};e.pick=function(c){var a={};w(e.flatten(d.call(arguments,1)),function(e){e in c&&(a[e]=c[e])});return a};e.defaults=function(c){w(d.call(arguments,1),function(a){for(var e in a)null==c[e]&&(c[e]=a[e])});return c};e.clone=function(c){return!e.isObject(c)?c:e.isArray(c)?c.slice():e.extend({},c)};e.tap=function(c,a){a(c);return c};e.isEqual=function(c,a){return l(c,a,[])};e.isEmpty=function(c){if(null==c)return!0;if(e.isArray(c)||e.isString(c))return 0===
c.length;for(var a in c)if(e.has(c,a))return!1;return!0};e.isElement=function(c){return!!(c&&1==c.nodeType)};e.isArray=g||function(c){return"[object Array]"==a.call(c)};e.isObject=function(c){return c===Object(c)};e.isArguments=function(c){return"[object Arguments]"==a.call(c)};e.isArguments(arguments)||(e.isArguments=function(c){return!(!c||!e.has(c,"callee"))});e.isFunction=function(c){return"[object Function]"==a.call(c)};e.isString=function(c){return"[object String]"==a.call(c)};e.isNumber=function(c){return"[object Number]"==
a.call(c)};e.isFinite=function(c){return e.isNumber(c)&&isFinite(c)};e.isNaN=function(c){return c!==c};e.isBoolean=function(c){return!0===c||!1===c||"[object Boolean]"==a.call(c)};e.isDate=function(c){return"[object Date]"==a.call(c)};e.isRegExp=function(c){return"[object RegExp]"==a.call(c)};e.isNull=function(c){return null===c};e.isUndefined=function(c){return void 0===c};e.has=function(c,a){return h.call(c,a)};e.noConflict=function(){f._=j;return this};e.identity=function(c){return c};e.times=
function(c,a,e){for(var b=0;b<c;b++)a.call(e,b)};e.escape=function(c){return(""+c).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};e.result=function(c,a){if(null==c)return null;var b=c[a];return e.isFunction(b)?b.call(c):b};e.mixin=function(c){w(e.functions(c),function(a){var h=e[a]=c[a];z.prototype[a]=function(){var c=d.call(arguments);b.call(c,this._wrapped);return E(h.apply(e,c),this._chain)}})};var K=0;e.uniqueId=
function(c){var a=K++;return c?c+a:a};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},G;for(G in A)A[A[G]]=G;var L=/\\|'|\r|\n|\t|\u2028|\u2029/g,M=/\\(\\|'|r|n|t|u2028|u2029)/g,H=function(c){return c.replace(M,function(c,a){return A[a]})};e.template=function(c,a,b){b=e.defaults(b||{},e.templateSettings);c="__p+='"+c.replace(L,function(c){return"\\"+A[c]}).replace(b.escape||
F,function(c,a){return"'+\n_.escape("+H(a)+")+\n'"}).replace(b.interpolate||F,function(c,a){return"'+\n("+H(a)+")+\n'"}).replace(b.evaluate||F,function(c,a){return"';\n"+H(a)+"\n;__p+='"})+"';\n";b.variable||(c="with(obj||{}){\n"+c+"}\n");c="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+c+"return __p;\n";var d=new Function(b.variable||"obj","_",c);if(a)return d(a,e);a=function(c){return d.call(this,c,e)};a.source="function("+(b.variable||"obj")+"){\n"+c+"}";return a};
e.chain=function(c){return e(c).chain()};var z=function(c){this._wrapped=c};e.prototype=z.prototype;var E=function(c,a){return a?e(c).chain():c};e.mixin(e);w("pop push reverse shift sort splice unshift".split(" "),function(c){var a=k[c];z.prototype[c]=function(){var e=this._wrapped;a.apply(e,arguments);var b=e.length;("shift"==c||"splice"==c)&&0===b&&delete e[0];return E(e,this._chain)}});w(["concat","join","slice"],function(c){var a=k[c];z.prototype[c]=function(){return E(a.apply(this._wrapped,arguments),
this._chain)}});z.prototype.chain=function(){this._chain=!0;return this};z.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var l=[].slice,f=/\s+/,j=function(g,d,b,a){if(!b)return!0;if("object"===typeof b)for(var h in b)g[d].apply(g,[h,b[h]].concat(a));else if(f.test(b)){b=b.split(f);h=0;for(var k=b.length;h<k;h++)g[d].apply(g,[b[h]].concat(a))}else return!0},p=function(g,d,b){var a;g=-1;var h=d.length;switch(b.length){case 0:for(;++g<h;)(a=d[g]).callback.call(a.ctx);break;case 1:for(;++g<h;)(a=d[g]).callback.call(a.ctx,b[0]);break;case 2:for(;++g<h;)(a=d[g]).callback.call(a.ctx,b[0],b[1]);break;case 3:for(;++g<
h;)(a=d[g]).callback.call(a.ctx,b[0],b[1],b[2]);break;default:for(;++g<h;)(a=d[g]).callback.apply(a.ctx,b)}},k=Backbone.Events={on:function(g,d,b){if(!j(this,"on",g,[d,b])||!d)return this;this._events||(this._events={});(this._events[g]||(this._events[g]=[])).push({callback:d,context:b,ctx:b||this});return this},once:function(g,d,b){if(!j(this,"once",g,[d,b])||!d)return this;var a=this,h=_.once(function(){a.off(g,h);d.apply(this,arguments)});h._callback=d;this.on(g,h,b);return this},off:function(g,
d,b){var a,h,k,f,t,p,q,l;if(!this._events||!j(this,"off",g,[d,b]))return this;if(!g&&!d&&!b)return this._events={},this;f=g?[g]:_.keys(this._events);t=0;for(p=f.length;t<p;t++)if(g=f[t],a=this._events[g]){k=[];if(d||b){q=0;for(l=a.length;q<l;q++)h=a[q],(d&&d!==(h.callback._callback||h.callback)||b&&b!==h.context)&&k.push(h)}this._events[g]=k}return this},trigger:function(g){if(!this._events)return this;var d=l.call(arguments,1);if(!j(this,"trigger",g,d))return this;var b=this._events[g],a=this._events.all;
b&&p(this,b,d);a&&p(this,a,arguments);return this},listenTo:function(g,d,b){var a=this._listeners||(this._listeners={}),h=g._listenerId||(g._listenerId=_.uniqueId("l"));a[h]=g;g.on(d,b||this,this);return this},stopListening:function(g,d,b){var a=this._listeners;if(a){if(g)g.off(d,b,this),!d&&!b&&delete a[g._listenerId];else{for(var h in a)a[h].off(null,null,this);this._listeners={}}return this}}};k.bind=k.on;k.unbind=k.off})();(function(){for(var l=0,f=["ms","moz","webkit","o"],j=0;j<f.length&&!window.requestAnimationFrame;++j)window.requestAnimationFrame=window[f[j]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[f[j]+"CancelAnimationFrame"]||window[f[j]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(f){var k=(new Date).getTime(),g=Math.max(0,16-(k-l)),d=window.setTimeout(function(){f(k+g)},g);l=k+g;return d});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(f){clearTimeout(f)})})();(function(){function l(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(m.Events.resize,b,a)}var f=this,j=f.Two||{},p=Math.sin,k=Math.cos,g=Math.atan2,d=Math.sqrt,b=Math.PI,a=2*b,h=b/2,B={hasEventListeners:_.isFunction(f.addEventListener),bind:function(a,b,d,h){this.hasEventListeners?a.addEventListener(b,d,!!h):a.attachEvent("on"+b,d);return this},unbind:function(a,b,d,h){this.hasEventListeners?a.removeEventListeners(b,
d,!!h):a.detachEvent("on"+b,d);return this}},m=f.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:m.Types.svg,autostart:!1});this.type=a.type;this.renderer=new m[this.type](this);this.playing=a.autostart;this.frameCount=0;a.fullscreen?(a=_.bind(l,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),B.bind(window,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);
this.scene=new m.Group;this.renderer.add(this.scene);m.Instances.push(this)};_.extend(m,{Array:f.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,Instances:[],noConflict:function(){f.Two=j;return this},Utils:{getCurveFromPoints:function(a,b){for(var d=[],h=a.length,e=h-1,g=0;g<h;g++){var k=a[g],f={x:k.x,y:k.y};
d.push(f);var k=b?y(g-1,h):Math.max(g-1,0),m=b?y(g+1,h):Math.min(g+1,e);D(a[k],f,a[m]);!f.u.x&&!f.u.y&&(f.u.x=f.x,f.u.y=f.y);!f.v.x&&!f.v.y&&(f.v.x=f.x,f.v.y=f.y)}return d},getControlPoints:function(a,d,g){var f=q(a,d),e=q(g,d);a=t(a,d);g=t(g,d);var m=(f+e)/2;if(1E-4>a||1E-4>g)return d.u={x:d.x,y:d.y},d.v={x:d.x,y:d.y},d;a*=0.33;g*=0.33;m=e<f?m+h:m-h;f={x:d.x+k(m)*a,y:d.y+p(m)*a};m-=b;e={x:d.x+k(m)*g,y:d.y+p(m)*g};d.u=f;d.v=e;return d},angleBetween:function(a,b){return g(a.y-b.y,a.x-b.x)},distanceBetweenSquared:function(a,
b){var d=a.x-b.x,h=a.y-b.y;return d*d+h*h},distanceBetween:function(a,b){return d(C(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b}}});var t=m.Utils.distanceBetween,C=m.Utils.distanceBetweenSquared,q=m.Utils.angleBetween,D=m.Utils.getControlPoints,y=m.Utils.mod;_.extend(m.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){this.playing=!0;return this.trigger(m.Events.play)},pause:function(){this.playing=!1;return this.trigger(m.Events.pause)},
update:function(){this.frameCount++;var a=this.width,b=this.height,d=this.renderer;(a!==d.width||b!==d.height)&&d.setSize(a,b);return this.trigger(m.Events.update,this.frameCount)},render:function(){this.renderer.render();return this.trigger(m.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},makeLine:function(a,b,d,h){d=(d-a)/2;h=(h-b)/2;var e=[new m.Vector(-d,-h),new m.Vector(d,h)],e=(new m.Polygon(e)).noFill();e.translation.set(a+
d,b+h);this.scene.add(e);return e},makeRectangle:function(a,b,d,h){d/=2;h/=2;h=[new m.Vector(d,h),new m.Vector(-d,h),new m.Vector(-d,-h),new m.Vector(d,-h)];h=new m.Polygon(h,!0);h.translation.set(a,b);this.scene.add(h);return h},makeCircle:function(a,b,d){return this.makeEllipse(a,b,d,d)},makeEllipse:function(b,d,h,g){var e=m.Resolution,f=_.map(_.range(e),function(b){var d=b/e*a;b=h*k(d);d=g*p(d);return new m.Vector(b,d)},this),f=new m.Polygon(f,!0,!0);f.translation.set(b,d);this.scene.add(f);return f},
makeCurve:function(a){var b=arguments.length,d=a;if(!_.isArray(a))for(var d=[],h=0;h<b;h+=2){var e=arguments[h];if(!_.isNumber(e))break;d.push(new m.Vector(e,arguments[h+1]))}var b=arguments[b-1],d=new m.Polygon(d,!(_.isBoolean(b)&&b),!0),b=d.getBoundingClientRect(),g=b.left+b.width/2,f=b.top+b.height/2;_.each(d.vertices,function(a){a.x-=g;a.y-=f});d.translation.set(g,f);this.scene.add(d);return d},makePolygon:function(a){var b=arguments.length,d=a;if(!_.isArray(a))for(var d=[],h=0;h<b;h+=2){var e=
arguments[h];if(!_.isNumber(e))break;d.push(new m.Vector(e,arguments[h+1]))}var b=arguments[b-1],d=new m.Polygon(d,!(_.isBoolean(b)&&b)),b=d.getBoundingClientRect(),g=b.left+b.width/2,f=b.top+b.height/2;_.each(d.vertices,function(a){a.x-=g;a.y-=f});d.translation.set(g,f);this.scene.add(d);return d},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var d=new m.Group;this.scene.add(d);d.add(b);return d},importSVG:function(){}});(function(){_.each(m.Instances,function(a){a.playing&&
a.update().render()});requestAnimationFrame(arguments.callee)})()})();(function(){function l(d){var b={},a=d.id,h=d.translation,f=d.rotation,m=d.scale,t=d.stroke,j=d.linewidth,p=d.fill,l=d.opacity,y=d.visible,u=d.cap,r=d.join,x=d.miter,v=d.curved,e=d.closed;d=d.vertices;a&&(b.id=g.Identifier+a);h&&(_.isNumber(m)&&_.isNumber(f))&&(b.transform="translate("+h.x+","+h.y+") scale("+m+") rotate("+f+")");t&&(b.stroke=t);p&&(b.fill=p);l&&(b["stroke-opacity"]=b["fill-opacity"]=l);b.visibility=y?"visible":"hidden";u&&(b["stroke-linecap"]=u);r&&(b["stroke-linejoin"]=r);x&&(b["stroke-miterlimit"]=
x);j&&(b["stroke-width"]=j);d&&(b.d=k.toString(d,e,v));return b}var f=0,j=Two.Utils.getCurveFromPoints,p=Two.Utils.mod,k={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(d,b){var a=d.toLowerCase(),h=document.createElementNS(this.ns,a);"svg"===a&&(b=_.defaults(b||{},{version:this.version}));_.isObject(b)&&this.setAttributes(h,b);return h},setAttributes:function(d,b){_.each(b,function(a,b){this.setAttribute(b,a)},d);return this},removeAttributes:function(d,
b){_.each(b,function(a){this.removeAttribute(a)},d);return this},toString:function(d,b,a){var h=d.length,g=h-1;if(!a)return _.map(d,function(a,d){var h;h=(0>=d?"M":"L")+(" "+a.x.toFixed(3)+" "+a.y.toFixed(3));d>=g&&b&&(h+=" Z");return h}).join(" ");var f=j(d,b);return _.map(f,function(a,d){var k,j=b?p(d-1,h):Math.max(d-1,0),l=b?p(d+1,h):Math.min(d+1,g);k=f[j];var l=f[l],j=k.v.x.toFixed(3),u=k.v.y.toFixed(3),r=a.u.x.toFixed(3),x=a.u.y.toFixed(3),v=a.x.toFixed(3),e=a.y.toFixed(3);k=0>=d?"M "+v+" "+
e:"C "+j+" "+u+" "+r+" "+x+" "+v+" "+e;d>=g&&b&&(j=a.v.x.toFixed(3),u=a.v.y.toFixed(3),r=l.u.x.toFixed(3),x=l.u.y.toFixed(3),v=l.x.toFixed(3),e=l.y.toFixed(3),k=k+(" C "+j+" "+u+" "+r+" "+x+" "+v+" "+e)+" Z");return k}).join(" ")}},g=Two[Two.Types.svg]=function(){this.domElement=k.createElement("svg");this.elements=[];this.commands=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(g,{Identifier:"two-"});_.extend(g.prototype,
Backbone.Events,{setSize:function(d,b){this.width=d;this.height=b;k.setAttributes(this.domElement,{width:d,height:b});return this},add:function(d){var b=d,a=this.elements,h=this.domElement;_.isArray(d)||(b=_.map(arguments,function(a){return a}));_.each(b,function(b){var d;d=b instanceof Two.Group;if(_.isUndefined(b.id)){var g=f;f++;b.id=g}d?(d="g",_.isUndefined(b.parent)&&(b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),b=l(b),delete b.stroke,delete b.fill,
delete b["fill-opacity"],delete b["stroke-opacity"],delete b["stroke-linecap"],delete b["stroke-linejoin"],delete b["stroke-miterlimit"],delete b["stroke-width"]):(d="path",b=l(b));b=k.createElement(d,b);h.appendChild(b);a.push(b)},this);return this},update:function(d,b,a){this.commands.push(arguments);return this},render:function(){this.unveil();var d=this.elements;_.each(this.commands,function(b){var a=b[1],h=b[2],g=b[3],f=b[4],j=d[b[0]];switch(a){case Two.Properties.hierarchy:_.each(h,function(a){j.appendChild(d[a])});
break;default:a:{b=a;switch(b){case "matrix":b="transform";h="matrix("+h.toString()+")";break;case "visible":b="visibility";h=h?"visible":"hidden";break;case "cap":b="stroke-linecap";break;case "join":b="stroke-linejoin";break;case "miter":b="stroke-miterlimit";break;case "linewidth":b="stroke-width";break;case "vertices":b="d";h=k.toString(h,g,f);break;case "opacity":k.setAttributes(j,{"stroke-opacity":opacity,"fill-opacity":opacity});break a}j.setAttribute(b,h)}}},this);this.commands.length=0;return this}})})();(function(){function l(a){var b={},g=a.id,f=a._matrix,k=a.stroke,j=a.linewidth,p=a.fill,l=a.opacity,y=a.visible,u=a.cap,r=a.join,x=a.miter,v=a.curved,e=a.closed;a=a.vertices;g&&(b.id=g);_.isObject(f)&&(b.matrix=f.toArray());k&&(b.stroke=k);p&&(b.fill=p);_.isNumber(l)&&(b.opacity=l);u&&(b.cap=u);r&&(b.join=r);x&&(b.miter=x);j&&(b.linewidth=j);a&&(b.commands=d.toArray(a,v,e));b.visible=!!y;b.curved=!!v;b.closed=!!e;return b}var f=0,j=Two.Utils.getCurveFromPoints,p=Two.Utils.mod,k=function(a){_.each(a,
function(a,b){this[b]=a},this);this.children={}};_.extend(k.prototype,{appendChild:function(a){var b=a.parent,d=a.id;_.isUndefined(b)||delete b.children[d];this.children[d]=a;a.parent=this;return this},render:function(a){var b=this.matrix;a.save();a.transform(b[0],b[1],b[2],b[3],b[4],b[5]);_.each(this.children,function(b){b.render(a)});a.restore();return this}});var g=function(a){_.each(a,function(a,b){this[b]=a},this)};_.extend(g.prototype,{render:function(a){var b=this.matrix,d=this.stroke,g=this.linewidth,
f=this.fill,k=this.opacity,j=this.cap,l=this.join,y=this.miter,u=this.curved,r=this.closed,x=this.commands,v=x.length,e=v-1;if(!this.visible)return this;a.save();b&&a.transform(b[0],b[1],b[2],b[3],b[4],b[5]);f&&(a.fillStyle=f);d&&(a.strokeStyle=d);g&&(a.lineWidth=g);y&&(a.miterLimit=y);l&&(a.lineJoin=l);j&&(a.lineCap=j);_.isNumber(k)&&(a.globalAlpha=k);a.beginPath();_.each(x,function(b,d){var h=b.x.toFixed(3),g=b.y.toFixed(3);if(u){var f=r?p(d-1,v):Math.max(d-1,0),k=r?p(d+1,v):Math.min(d+1,e),j=x[f],
k=x[k],f=j.v.x.toFixed(3),j=j.v.y.toFixed(3),m=b.u.x.toFixed(3),t=b.u.y.toFixed(3);0>=d?a.moveTo(h,g):(a.bezierCurveTo(f,j,m,t,h,g),d>=e&&r&&(f=b.v.x.toFixed(3),j=b.v.y.toFixed(3),m=k.u.x.toFixed(3),t=k.u.y.toFixed(3),h=k.x.toFixed(3),g=k.y.toFixed(3),a.bezierCurveTo(f,j,m,t,h,g)))}else 0>=d?a.moveTo(h,g):a.lineTo(h,g)});r&&!u&&a.closePath();a.fill();a.stroke();a.restore()}});var d={toArray:function(a,b,d){return!b?_.map(a,function(a){return{x:a.x,y:a.y}}):j(a,d)}},b=Two[Two.Types.canvas]=function(){this.domElement=
document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.elements=[];this.stage=null};_.extend(b,{});_.extend(b.prototype,Backbone.Events,{setSize:function(a,b){this.width=this.domElement.width=a;this.height=this.domElement.height=b;_.extend(this.domElement.style,{width:this.width+"px",height:this.height+"px"});return this},add:function(a){var b=a,d=this.elements;_.isArray(a)||(b=_.map(arguments,function(a){return a}));_.each(b,function(a){var b;b=a instanceof Two.Group;var h=
_.isNull(this.stage);if(_.isUndefined(a.id)){var j=f;f++;a.id=j}b?(b=l(a),delete b.stroke,delete b.fill,delete b.opacity,delete b.cap,delete b.join,delete b.miter,delete b.linewidth,b=new k(b),h&&(this.stage=b,this.stage.object=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):b=new g(l(a));d.push(b);h||this.stage.appendChild(b)},this);return this},update:function(a,b,g){var f=this.elements,k=f[a];switch(b){case Two.Properties.hierarchy:_.each(g,function(a){k.appendChild(f[a])});
break;default:a=b;switch(a){case "matrix":a="matrix";g=g.toArray();break;case "vertices":a="commands",g=d.toArray(g,k.curved,k.closed)}k[a]=g}return this},render:function(){if(_.isNull(this.stage))return this;this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);return this}})})();(function(){var l=Two.Vector=function(f,j){f=f||0;j=j||0;Object.defineProperty(this,"x",{get:function(){return f},set:function(j){f=j;this.trigger("change","x")}});Object.defineProperty(this,"y",{get:function(){return j},set:function(f){j=f;this.trigger("change","y")}})};_.extend(l,{});_.extend(l.prototype,Backbone.Events,{set:function(f,j){this.x=f;this.y=j;return this},copy:function(f){this.x=f.x;this.y=f.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new l(this.x,
this.y)},add:function(f,j){this.x=f.x+j.x;this.y=f.y+j.y;return this},addSelf:function(f){this.x+=f.x;this.y+=f.y;return this},sub:function(f,j){this.x=f.x-j.x;this.y=f.y-j.y;return this},subSelf:function(f){this.x-=f.x;this.y-=f.y;return this},multiplySelf:function(f){this.x*=f.x;this.y*=f.y;return this},multiplyScalar:function(f){this.x*=f;this.y*=f;return this},divideScalar:function(f){f?(this.x/=f,this.y/=f):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(f){return this.x*
f.x+this.y*f.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(f){return Math.sqrt(this.distanceToSquared(f))},distanceToSquared:function(f){var j=this.x-f.x;f=this.y-f.y;return j*j+f*f},setLength:function(f){return this.normalize().multiplyScalar(f)},equals:function(f){return 1E-4>this.distanceTo(f)},lerp:function(f,j){return this.set((f.x-this.x)*
j+this.x,(f.y-this.y)*j+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var l=Math.cos,f=Math.sin,j=Math.tan,p=Two.Matrix=function(f,g,d,b,a,h){this.elements=new Two.Array(9);var j=f;_.isArray(j)||(j=_.toArray(arguments));this.identity().set(j)};_.extend(p,{Identity:[1,0,0,0,1,0,0,0,1]});_.extend(p.prototype,{set:function(f,g,d,b,a,h){var j=f;_.isArray(j)||(j=_.toArray(arguments));_.each(j,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this},identity:function(){this.set(p.Identity);return this},multiply:function(f,g,d,b,a,h,j,m,
l){var p=arguments,q=p.length;if(1>=q)return _.each(this.elements,function(a,b){this.elements[b]=a*f},this),this;if(3>=q)return f=f||0,g=g||0,d=d||0,a=this.elements,{x:a[0]*f+a[1]*g+a[2]*d,y:a[3]*f+a[4]*g+a[5]*d,z:a[6]*f+a[7]*g+a[8]*d};q=this.elements;A0=q[0];A1=q[1];A2=q[2];A3=q[3];A4=q[4];A5=q[5];A6=q[6];A7=q[7];A8=q[8];B0=p[0];B1=p[1];B2=p[2];B3=p[3];B4=p[4];B5=p[5];B6=p[6];B7=p[7];B8=p[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;
this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this},scale:function(f,g){1>=arguments.length&&(g=f);return this.multiply(f,0,0,0,g,0,0,0,1)},rotate:function(k){var g=l(k);k=f(k);return this.multiply(g,-k,0,k,g,0,0,0,1)},translate:function(f,g){return this.multiply(1,0,f,0,1,g,0,0,1)},skewX:function(f){f=j(f);return this.multiply(1,
f,0,0,1,0,0,0,1)},skewY:function(f){f=j(f);return this.multiply(1,0,0,f,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(){var f=this.elements,g=f[0].toFixed(3),d=f[1].toFixed(3),b=f[2].toFixed(3),a=f[3].toFixed(3),h=f[4].toFixed(3),f=f[5].toFixed(3);return[g,a,d,h,b,f]},clone:function(){return new Two.Matrix(this.elements.slice(0))}})})();(function(){var l=Two.Shape=function(f){this._matrix=new Two.Matrix;var j=_.debounce(_.bind(function(){var f=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",f)},this),0);this._rotation="rotation";Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(f){this._rotation=f;j()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(f){this._scale=f;j()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,j);if(f)return this;l.MakeGetterSetter(this,l.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.miter=this.join=this.cap="round"};_.extend(l,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(f,j){_.isArray(j)||(j=[j]);_.each(j,function(j){var k="_"+j;Object.defineProperty(f,
j,{get:function(){return this[k]},set:function(f){this[k]=f;this.trigger(Two.Events.change,this.id,j,f,this)}})})}});_.extend(l.prototype,Backbone.Events,{addTo:function(f){f.add(this);return this},noFill:function(){this.fill="none";return this},noStroke:function(){this.stroke="none";return this},clone:function(){var f=new l;f.translation.copy(this.translation);_.each(l.Properties,function(j){f[j]=this[j]},this);return this}})})();(function(){var l=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;l.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(l,{MakeGetterSetter:function(f,j){_.isArray(j)||(j=[j]);_.each(j,function(j){var k="_"+j;Object.defineProperty(f,j,{get:function(){return this[k]},set:function(f){this[k]=f;_.each(this.children,function(d){d[j]=f})}})})}});_.extend(l.prototype,
Two.Shape.prototype,{add:function(f){var j=f,l=this.children,k=this.parent,g=[];_.isArray(f)||(j=_.toArray(arguments));var d=_.bind(function(b,a,d,f,g){this.trigger(Two.Events.change,b,a,d,f,g)},this);_.each(j,function(b){var a=b.id,f=b.parent;_.isUndefined(a)&&(k.add(b),a=b.id);_.isUndefined(l[a])&&(f&&delete f.children[a],l[a]=b,b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,d),g.push(a))},this);0<g.length&&this.trigger(Two.Events.change,this.id,"hierarchy",g);return this},getBoundingClientRect:function(){var f=
Infinity,j=-Infinity,l=Infinity,k=-Infinity;_.each(this.children,function(b){b=b.getBoundingClientRect();l=Math.min(b.top,l);f=Math.min(b.left,f);j=Math.max(b.right,j);k=Math.max(b.bottom,k)},this);var g=this._matrix.multiply(f,l,1),d=this._matrix.multiply(j,k,1);return{top:g.y,left:g.x,right:d.x,bottom:d.y,width:d.x-g.x,height:d.y-g.y}},noFill:function(){_.each(this.children,function(f){f.noFill()});return this},noStroke:function(){_.each(this.children,function(f){f.noStroke()});return this}})})();(function(){var l=Math.min,f=Math.max,j=Math.round,p=Two.Polygon=function(k,g,d){Two.Shape.call(this);g=!!g;d=!!d;var b=0,a=1,h=!1,p=k.slice(0),m=_.debounce(_.bind(function(){var d,f;if(h){d=this.vertices.length;d-=1;f=j(b*d);d=j(a*d);for(p.length=0;f<d+1;f++){var g=this.vertices[f];p.push({x:g.x,y:g.y})}h=!1}this.trigger(Two.Events.change,this.id,"vertices",p,this.closed,this.curved)},this),0);Object.defineProperty(this,"closed",{get:function(){return g},set:function(a){g=!!a;m()}});Object.defineProperty(this,
"curved",{get:function(){return d},set:function(a){d=!!a;m()}});Object.defineProperty(this,"beginning",{get:function(){return b},set:function(a){b=l(f(a,0),1);h=!0;m()}});Object.defineProperty(this,"ending",{get:function(){return a},set:function(b){a=l(f(b,0),1);h=!0;m()}});this.vertices=k.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,m)},this);m()};_.extend(p,{});_.extend(p.prototype,Two.Shape.prototype,{clone:function(){var f=_.map(this.vertices,function(d){return new Two.Vector(d.x,
d.y)}),g=new p(f,this.closed,this.curved);_.each(Two.Shape.Properties,function(d){g[d]=this[d]},this);g.translation.copy(this.translation);g.rotation=this.rotation;g.scale=this.scale;return g},getBoundingClientRect:function(){var f=this.linewidth,g=Infinity,d=-Infinity,b=Infinity,a=-Infinity;_.each(this.vertices,function(f){var h=f.x;f=f.y;b=Math.min(f,b);g=Math.min(h,g);d=Math.max(h,d);a=Math.max(f,a)});var b=b-f,g=g-f,d=d+f,a=a+f,f=this._matrix.multiply(g,b,1),h=this._matrix.multiply(d,a,1);return{top:f.y,
left:f.x,right:h.x,bottom:h.y,width:h.x-f.x,height:h.y-f.y}}})})();
