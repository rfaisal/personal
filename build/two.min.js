(function(){function l(a,b,c){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a._chain&&(a=a._wrapped);b._chain&&(b=b._wrapped);if(a.isEqual&&e.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&e.isFunction(b.isEqual))return b.isEqual(a);var h=k.call(a);if(h!=k.call(b))return!1;switch(h){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==
b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return!0;c.push(a);var f=0,d=!0;if("[object Array]"==h){if(f=a.length,d=f==b.length)for(;f--&&(d=f in a==f in b&&l(a[f],b[f],c)););}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var g in a)if(e.has(a,g)&&(f++,!(d=e.has(b,g)&&l(a[g],b[g],c))))break;if(d){for(g in b)if(e.has(b,g)&&!f--)break;
d=!f}}c.pop();return d}var a=this,b=a._,c={},d=Array.prototype,g=Object.prototype,j=d.slice,f=d.unshift,k=g.toString,m=g.hasOwnProperty,p=d.forEach,r=d.map,q=d.reduce,h=d.reduceRight,n=d.filter,u=d.every,s=d.some,B=d.indexOf,t=d.lastIndexOf,g=Array.isArray,z=Object.keys,w=Function.prototype.bind,e=function(a){return new F(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports._=e):a._=e;e.VERSION="1.3.3";var v=e.each=e.forEach=function(a,
b,h){if(null!=a)if(p&&a.forEach===p)a.forEach(b,h);else if(a.length===+a.length)for(var f=0,d=a.length;f<d&&!(f in a&&b.call(h,a[f],f,a)===c);f++);else for(f in a)if(e.has(a,f)&&b.call(h,a[f],f,a)===c)break};e.map=e.collect=function(a,b,c){var e=[];if(null==a)return e;if(r&&a.map===r)return a.map(b,c);v(a,function(a,y,h){e[e.length]=b.call(c,a,y,h)});a.length===+a.length&&(e.length=a.length);return e};e.reduce=e.foldl=e.inject=function(a,b,c,h){var f=2<arguments.length;null==a&&(a=[]);if(q&&a.reduce===
q)return h&&(b=e.bind(b,h)),f?a.reduce(b,c):a.reduce(b);v(a,function(a,e,y){f?c=b.call(h,c,a,e,y):(c=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return c};e.reduceRight=e.foldr=function(a,b,c,f){var d=2<arguments.length;null==a&&(a=[]);if(h&&a.reduceRight===h)return f&&(b=e.bind(b,f)),d?a.reduceRight(b,c):a.reduceRight(b);var g=e.toArray(a).reverse();f&&!d&&(b=e.bind(b,f));return d?e.reduce(g,b,c,f):e.reduce(g,b)};e.find=e.detect=function(a,b,c){var e;H(a,function(a,
y,h){if(b.call(c,a,y,h))return e=a,!0});return e};e.filter=e.select=function(a,b,c){var e=[];if(null==a)return e;if(n&&a.filter===n)return a.filter(b,c);v(a,function(a,h,y){b.call(c,a,h,y)&&(e[e.length]=a)});return e};e.reject=function(a,b,c){var e=[];if(null==a)return e;v(a,function(a,h,y){b.call(c,a,h,y)||(e[e.length]=a)});return e};e.every=e.all=function(a,b,e){var h=!0;if(null==a)return h;if(u&&a.every===u)return a.every(b,e);v(a,function(a,y,f){if(!(h=h&&b.call(e,a,y,f)))return c});return!!h};
var H=e.some=e.any=function(a,b,h){b||(b=e.identity);var f=!1;if(null==a)return f;if(s&&a.some===s)return a.some(b,h);v(a,function(a,e,y){if(f||(f=b.call(h,a,e,y)))return c});return!!f};e.include=e.contains=function(a,b){var e=!1;return null==a?e:B&&a.indexOf===B?-1!=a.indexOf(b):e=H(a,function(a){return a===b})};e.invoke=function(a,b){var c=j.call(arguments,2);return e.map(a,function(a){return(e.isFunction(b)?b||a:a[b]).apply(a,c)})};e.pluck=function(a,b){return e.map(a,function(a){return a[b]})};
e.max=function(a,b,c){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&e.isEmpty(a))return-Infinity;var h={computed:-Infinity};v(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e>=h.computed&&(h={value:a,computed:e})});return h.value};e.min=function(a,b,c){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&e.isEmpty(a))return Infinity;var h={computed:Infinity};v(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e<h.computed&&(h={value:a,computed:e})});return h.value};e.shuffle=
function(a){var b=[],e;v(a,function(a,c){e=Math.floor(Math.random()*(c+1));b[c]=b[e];b[e]=a});return b};e.sortBy=function(a,b,c){var h=e.isFunction(b)?b:function(a){return a[b]};return e.pluck(e.map(a,function(a,b,e){return{value:a,criteria:h.call(c,a,b,e)}}).sort(function(a,b){var e=a.criteria,c=b.criteria;return void 0===e?1:void 0===c?-1:e<c?-1:e>c?1:0}),"value")};e.groupBy=function(a,b){var c={},h=e.isFunction(b)?b:function(a){return a[b]};v(a,function(a,b){var e=h(a,b);(c[e]||(c[e]=[])).push(a)});
return c};e.sortedIndex=function(a,b,c){c||(c=e.identity);for(var h=0,f=a.length;h<f;){var d=h+f>>1;c(a[d])<c(b)?h=d+1:f=d}return h};e.toArray=function(a){return!a?[]:e.isArray(a)||e.isArguments(a)?j.call(a):a.toArray&&e.isFunction(a.toArray)?a.toArray():e.values(a)};e.size=function(a){return e.isArray(a)?a.length:e.keys(a).length};e.first=e.head=e.take=function(a,b,e){return null!=b&&!e?j.call(a,0,b):a[0]};e.initial=function(a,b,e){return j.call(a,0,a.length-(null==b||e?1:b))};e.last=function(a,
b,e){return null!=b&&!e?j.call(a,Math.max(a.length-b,0)):a[a.length-1]};e.rest=e.tail=function(a,b,e){return j.call(a,null==b||e?1:b)};e.compact=function(a){return e.filter(a,function(a){return!!a})};e.flatten=function(a,b){return e.reduce(a,function(a,c){if(e.isArray(c))return a.concat(b?c:e.flatten(c));a[a.length]=c;return a},[])};e.without=function(a){return e.difference(a,j.call(arguments,1))};e.uniq=e.unique=function(a,b,c){c=c?e.map(a,c):a;var h=[];3>a.length&&(b=!0);e.reduce(c,function(c,f,
d){if(b?e.last(c)!==f||!c.length:!e.include(c,f))c.push(f),h.push(a[d]);return c},[]);return h};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=e.intersect=function(a){var b=j.call(arguments,1);return e.filter(e.uniq(a),function(a){return e.every(b,function(b){return 0<=e.indexOf(b,a)})})};e.difference=function(a){var b=e.flatten(j.call(arguments,1),!0);return e.filter(a,function(a){return!e.include(b,a)})};e.zip=function(){for(var a=j.call(arguments),b=e.max(e.pluck(a,"length")),
c=Array(b),h=0;h<b;h++)c[h]=e.pluck(a,""+h);return c};e.indexOf=function(a,b,c){if(null==a)return-1;var h;if(c)return c=e.sortedIndex(a,b),a[c]===b?c:-1;if(B&&a.indexOf===B)return a.indexOf(b);c=0;for(h=a.length;c<h;c++)if(c in a&&a[c]===b)return c;return-1};e.lastIndexOf=function(a,b){if(null==a)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);for(var c=a.length;c--;)if(c in a&&a[c]===b)return c;return-1};e.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);c=arguments[2]||1;for(var e=
Math.max(Math.ceil((b-a)/c),0),h=0,f=Array(e);h<e;)f[h++]=a,a+=c;return f};var R=function(){};e.bind=function(a,b){var c,h;if(a.bind===w&&w)return w.apply(a,j.call(arguments,1));if(!e.isFunction(a))throw new TypeError;h=j.call(arguments,2);return c=function(){if(!(this instanceof c))return a.apply(b,h.concat(j.call(arguments)));R.prototype=a.prototype;var e=new R,f=a.apply(e,h.concat(j.call(arguments)));return Object(f)===f?f:e}};e.bindAll=function(a){var b=j.call(arguments,1);0==b.length&&(b=e.functions(a));
v(b,function(b){a[b]=e.bind(a[b],a)});return a};e.memoize=function(a,b){var c={};b||(b=e.identity);return function(){var h=b.apply(this,arguments);return e.has(c,h)?c[h]:c[h]=a.apply(this,arguments)}};e.delay=function(a,b){var c=j.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(j.call(arguments,1)))};e.throttle=function(a,b){var c,h,f,d,g,j,k=e.debounce(function(){g=d=!1},b);return function(){c=this;h=arguments;f||
(f=setTimeout(function(){f=null;g&&a.apply(c,h);k()},b));d?g=!0:j=a.apply(c,h);k();d=!0;return j}};e.debounce=function(a,b,c){var e;return function(){var h=this,f=arguments;c&&!e&&a.apply(h,f);clearTimeout(e);e=setTimeout(function(){e=null;c||a.apply(h,f)},b)}};e.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;return c=a.apply(this,arguments)}};e.wrap=function(a,b){return function(){var c=[a].concat(j.call(arguments,0));return b.apply(this,c)}};e.compose=function(){var a=arguments;
return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};e.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};e.keys=z||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)e.has(a,c)&&(b[b.length]=c);return b};e.values=function(a){return e.map(a,e.identity)};e.functions=e.methods=function(a){var b=[],c;for(c in a)e.isFunction(a[c])&&b.push(c);return b.sort()};e.extend=function(a){v(j.call(arguments,
1),function(b){for(var c in b)a[c]=b[c]});return a};e.pick=function(a){var b={};v(e.flatten(j.call(arguments,1)),function(c){c in a&&(b[c]=a[c])});return b};e.defaults=function(a){v(j.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])});return a};e.clone=function(a){return!e.isObject(a)?a:e.isArray(a)?a.slice():e.extend({},a)};e.tap=function(a,b){b(a);return a};e.isEqual=function(a,b){return l(a,b,[])};e.isEmpty=function(a){if(null==a)return!0;if(e.isArray(a)||e.isString(a))return 0===
a.length;for(var b in a)if(e.has(a,b))return!1;return!0};e.isElement=function(a){return!!(a&&1==a.nodeType)};e.isArray=g||function(a){return"[object Array]"==k.call(a)};e.isObject=function(a){return a===Object(a)};e.isArguments=function(a){return"[object Arguments]"==k.call(a)};e.isArguments(arguments)||(e.isArguments=function(a){return!(!a||!e.has(a,"callee"))});e.isFunction=function(a){return"[object Function]"==k.call(a)};e.isString=function(a){return"[object String]"==k.call(a)};e.isNumber=function(a){return"[object Number]"==
k.call(a)};e.isFinite=function(a){return e.isNumber(a)&&isFinite(a)};e.isNaN=function(a){return a!==a};e.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==k.call(a)};e.isDate=function(a){return"[object Date]"==k.call(a)};e.isRegExp=function(a){return"[object RegExp]"==k.call(a)};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.has=function(a,b){return m.call(a,b)};e.noConflict=function(){a._=b;return this};e.identity=function(a){return a};e.times=
function(a,b,c){for(var e=0;e<a;e++)b.call(c,e)};e.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};e.result=function(a,b){if(null==a)return null;var c=a[b];return e.isFunction(c)?c.call(a):c};e.mixin=function(a){v(e.functions(a),function(b){var c=e[b]=a[b];F.prototype[b]=function(){var a=j.call(arguments);f.call(a,this._wrapped);return C(c.apply(e,a),this._chain)}})};var S=0;e.uniqueId=
function(a){var b=S++;return a?a+b:b};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var G=/.^/,K={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},L;for(L in K)K[K[L]]=L;var T=/\\|'|\r|\n|\t|\u2028|\u2029/g,U=/\\(\\|'|r|n|t|u2028|u2029)/g,M=function(a){return a.replace(U,function(a,b){return K[b]})};e.template=function(a,b,c){c=e.defaults(c||{},e.templateSettings);a="__p+='"+a.replace(T,function(a){return"\\"+K[a]}).replace(c.escape||
G,function(a,b){return"'+\n_.escape("+M(b)+")+\n'"}).replace(c.interpolate||G,function(a,b){return"'+\n("+M(b)+")+\n'"}).replace(c.evaluate||G,function(a,b){return"';\n"+M(b)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var h=new Function(c.variable||"obj","_",a);if(b)return h(b,e);b=function(a){return h.call(this,a,e)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};
e.chain=function(a){return e(a).chain()};var F=function(a){this._wrapped=a};e.prototype=F.prototype;var C=function(a,b){return b?e(a).chain():a};e.mixin(e);v("pop push reverse shift sort splice unshift".split(" "),function(a){var b=d[a];F.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var e=c.length;("shift"==a||"splice"==a)&&0===e&&delete c[0];return C(c,this._chain)}});v(["concat","join","slice"],function(a){var b=d[a];F.prototype[a]=function(){return C(b.apply(this._wrapped,arguments),
this._chain)}});F.prototype.chain=function(){this._chain=!0;return this};F.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var l=[].slice,a=/\s+/,b=function(b,c,f,d){if(!f)return!0;if("object"===typeof f)for(var m in f)b[c].apply(b,[m,f[m]].concat(d));else if(a.test(f)){f=f.split(a);m=0;for(var p=f.length;m<p;m++)b[c].apply(b,[f[m]].concat(d))}else return!0},c=function(a,b,c){var d;a=-1;var m=b.length;switch(c.length){case 0:for(;++a<m;)(d=b[a]).callback.call(d.ctx);break;case 1:for(;++a<m;)(d=b[a]).callback.call(d.ctx,c[0]);break;case 2:for(;++a<m;)(d=b[a]).callback.call(d.ctx,c[0],c[1]);break;case 3:for(;++a<
m;)(d=b[a]).callback.call(d.ctx,c[0],c[1],c[2]);break;default:for(;++a<m;)(d=b[a]).callback.apply(d.ctx,c)}},d=Backbone.Events={on:function(a,c,f){if(!b(this,"on",a,[c,f])||!c)return this;this._events||(this._events={});(this._events[a]||(this._events[a]=[])).push({callback:c,context:f,ctx:f||this});return this},once:function(a,c,f){if(!b(this,"once",a,[c,f])||!c)return this;var d=this,m=_.once(function(){d.off(a,m);c.apply(this,arguments)});m._callback=c;this.on(a,m,f);return this},off:function(a,
c,f){var d,m,p,r,q,h,n,u;if(!this._events||!b(this,"off",a,[c,f]))return this;if(!a&&!c&&!f)return this._events={},this;r=a?[a]:_.keys(this._events);q=0;for(h=r.length;q<h;q++)if(a=r[q],d=this._events[a]){p=[];if(c||f){n=0;for(u=d.length;n<u;n++)m=d[n],(c&&c!==(m.callback._callback||m.callback)||f&&f!==m.context)&&p.push(m)}this._events[a]=p}return this},trigger:function(a){if(!this._events)return this;var d=l.call(arguments,1);if(!b(this,"trigger",a,d))return this;var f=this._events[a],k=this._events.all;
f&&c(this,f,d);k&&c(this,k,arguments);return this},listenTo:function(a,b,c){var d=this._listeners||(this._listeners={}),m=a._listenerId||(a._listenerId=_.uniqueId("l"));d[m]=a;a.on(b,c||this,this);return this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,c,this),!b&&!c&&delete d[a._listenerId];else{for(var m in d)d[m].off(null,null,this);this._listeners={}}return this}}};d.bind=d.on;d.unbind=d.off})();(function(){for(var l=0,a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;++b)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"]||window[a[b]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=(new Date).getTime(),g=Math.max(0,16-(b-l)),j=window.setTimeout(function(){a(b+g)},g);l=b+g;return j});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})})();(function(){var l=this;previousTessellation=l.tessellation;tessellation=l.tessellation={noConflict:function(){l.tessellation=previousTessellation;return this}};tessellation.cmp=function(a,b){return a.y==b.y?a.x-b.x:a.y-b.y};tessellation.equals=function(a,b){return a.x==b.x&&a.y==b.y};tessellation.Edge=function(){this.q=this.p=null;2==arguments.length?arguments[0].y>arguments[1].y?(this.q=arguments[0],this.p=arguments[1]):arguments[0].y==arguments[1].y?arguments[0].x>arguments[1].x?(this.q=arguments[0],
this.p=arguments[1]):arguments[0].x==arguments[1].x?alert("Invalid tessellation.edge constructor call: repeated points!"):(this.p=arguments[0],this.q=arguments[1]):(this.p=arguments[0],this.q=arguments[1]):alert("Invalid tessellation.Edge constructor call!");this.p&&!_.isArray(this.p.edges)&&(this.p.edges=[]);this.q&&!_.isArray(this.q.edges)&&(this.q.edges=[]);this.q.edges.push(this)};tessellation.Triangle=function(a,b,c){this.points=[null,null,null];this.neighbors=[null,null,null];this.interior=
!1;this.constrained_edge=[!1,!1,!1];this.delaunay_edge=[!1,!1,!1];3==arguments.length&&(this.points[0]=a,this.points[1]=b,this.points[2]=c)};tessellation.Triangle.prototype.GetPoint=function(a){return this.points[a]};tessellation.Triangle.prototype.GetNeighbor=function(a){return this.neighbors[a]};tessellation.Triangle.prototype.ContainsP=function(){for(var a=!0,b=0;b<arguments.length;++b)a=a&&(arguments[b].equals(this.points[0])||arguments[b].equals(this.points[1])||arguments[b].equals(this.points[2]));
return a};tessellation.Triangle.prototype.ContainsE=function(){for(var a=!0,b=0;b<arguments.length;++b)a=a&&this.ContainsP(arguments[b].p,arguments[b].q);return a};tessellation.Triangle.prototype.IsInterior=function(){0!=arguments.length&&(this.interior=arguments[0]);return this.interior};tessellation.Triangle.prototype.MarkNeighbor=function(){var a;if(3==arguments.length){var b=arguments[0],c=arguments[1];a=arguments[2];b.equals(this.points[2])&&c.equals(this.points[1])||b.equals(this.points[1])&&
c.equals(this.points[2])?this.neighbors[0]=a:b.equals(this.points[0])&&c.equals(this.points[2])||b.equals(this.points[2])&&c.equals(this.points[0])?this.neighbors[1]=a:b.equals(this.points[0])&&c.equals(this.points[1])||b.equals(this.points[1])&&c.equals(this.points[0])?this.neighbors[2]=a:alert("Invalid tessellation.Triangle.MarkNeighbor call (1)!")}else 1==arguments.length?(a=arguments[0],a.ContainsP(this.points[1],this.points[2])?(this.neighbors[0]=a,a.MarkNeighbor(this.points[1],this.points[2],
this)):a.ContainsP(this.points[0],this.points[2])?(this.neighbors[1]=a,a.MarkNeighbor(this.points[0],this.points[2],this)):a.ContainsP(this.points[0],this.points[1])&&(this.neighbors[2]=a,a.MarkNeighbor(this.points[0],this.points[1],this))):alert("Invalid tessellation.Triangle.MarkNeighbor call! (2)")};tessellation.Triangle.prototype.ClearNeigbors=function(){this.neighbors[0]=null;this.neighbors[1]=null;this.neighbors[2]=null};tessellation.Triangle.prototype.ClearDelunayEdges=function(){this.delaunay_edge[0]=
!1;this.delaunay_edge[1]=!1;this.delaunay_edge[2]=!1};tessellation.Triangle.prototype.PointCW=function(a){return a.equals(this.points[0])?this.points[2]:a.equals(this.points[1])?this.points[0]:a.equals(this.points[2])?this.points[1]:null};tessellation.Triangle.prototype.PointCCW=function(a){return a.equals(this.points[0])?this.points[1]:a.equals(this.points[1])?this.points[2]:a.equals(this.points[2])?this.points[0]:null};tessellation.Triangle.prototype.NeighborCW=function(a){return a.equals(this.points[0])?
this.neighbors[1]:a.equals(this.points[1])?this.neighbors[2]:this.neighbors[0]};tessellation.Triangle.prototype.NeighborCCW=function(a){return a.equals(this.points[0])?this.neighbors[2]:a.equals(this.points[1])?this.neighbors[0]:this.neighbors[1]};tessellation.Triangle.prototype.GetConstrainedEdgeCW=function(a){return a.equals(this.points[0])?this.constrained_edge[1]:a.equals(this.points[1])?this.constrained_edge[2]:this.constrained_edge[0]};tessellation.Triangle.prototype.GetConstrainedEdgeCCW=function(a){return a.equals(this.points[0])?
this.constrained_edge[2]:a.equals(this.points[1])?this.constrained_edge[0]:this.constrained_edge[1]};tessellation.Triangle.prototype.SetConstrainedEdgeCW=function(a,b){a.equals(this.points[0])?this.constrained_edge[1]=b:a.equals(this.points[1])?this.constrained_edge[2]=b:this.constrained_edge[0]=b};tessellation.Triangle.prototype.SetConstrainedEdgeCCW=function(a,b){a.equals(this.points[0])?this.constrained_edge[2]=b:a.equals(this.points[1])?this.constrained_edge[0]=b:this.constrained_edge[1]=b};tessellation.Triangle.prototype.GetDelaunayEdgeCW=
function(a){return a.equals(this.points[0])?this.delaunay_edge[1]:a.equals(this.points[1])?this.delaunay_edge[2]:this.delaunay_edge[0]};tessellation.Triangle.prototype.GetDelaunayEdgeCCW=function(a){return a.equals(this.points[0])?this.delaunay_edge[2]:a.equals(this.points[1])?this.delaunay_edge[0]:this.delaunay_edge[1]};tessellation.Triangle.prototype.SetDelaunayEdgeCW=function(a,b){a.equals(this.points[0])?this.delaunay_edge[1]=b:a.equals(this.points[1])?this.delaunay_edge[2]=b:this.delaunay_edge[0]=
b};tessellation.Triangle.prototype.SetDelaunayEdgeCCW=function(a,b){a.equals(this.points[0])?this.delaunay_edge[2]=b:a.equals(this.points[1])?this.delaunay_edge[0]=b:this.delaunay_edge[1]=b};tessellation.Triangle.prototype.NeighborAcross=function(a){return a.equals(this.points[0])?this.neighbors[0]:a.equals(this.points[1])?this.neighbors[1]:this.neighbors[2]};tessellation.Triangle.prototype.OppositePoint=function(a,b){var c=a.PointCW(b);return this.PointCW(c)};tessellation.Triangle.prototype.Legalize=
function(){if(1==arguments.length)this.Legalize(this.points[0],arguments[0]);else if(2==arguments.length){var a=arguments[0],b=arguments[1];a.equals(this.points[0])?(this.points[1]=this.points[0],this.points[0]=this.points[2],this.points[2]=b):a.equals(this.points[1])?(this.points[2]=this.points[1],this.points[1]=this.points[0],this.points[0]=b):a.equals(this.points[2])?(this.points[0]=this.points[2],this.points[2]=this.points[1],this.points[1]=b):alert("Invalid tessellation.Triangle.Legalize call!")}else alert("Invalid tessellation.Triangle.Legalize call!")};
tessellation.Triangle.prototype.Index=function(a){return a.equals(this.points[0])?0:a.equals(this.points[1])?1:a.equals(this.points[2])?2:-1};tessellation.Triangle.prototype.EdgeIndex=function(a,b){if(a.equals(this.points[0])){if(b.equals(this.points[1]))return 2;if(b.equals(this.points[2]))return 1}else if(a.equals(this.points[1])){if(b.equals(this.points[2]))return 0;if(b.equals(this.points[0]))return 2}else if(a.equals(this.points[2])){if(b.equals(this.points[0]))return 1;if(b.equals(this.points[1]))return 0}return-1};
tessellation.Triangle.prototype.MarkConstrainedEdge=function(){if(1==arguments.length)"number"==typeof arguments[0]?this.constrained_edge[arguments[0]]=!0:this.MarkConstrainedEdge(arguments[0].p,arguments[0].q);else if(2==arguments.length){var a=arguments[0],b=arguments[1];if(b.equals(this.points[0])&&a.equals(this.points[1])||b.equals(this.points[1])&&a.equals(this.points[0]))this.constrained_edge[2]=!0;else if(b.equals(this.points[0])&&a.equals(this.points[2])||b.equals(this.points[2])&&a.equals(this.points[0]))this.constrained_edge[1]=
!0;else if(b.equals(this.points[1])&&a.equals(this.points[2])||b.equals(this.points[2])&&a.equals(this.points[1]))this.constrained_edge[0]=!0}else alert("Invalid tessellation.Triangle.MarkConstrainedEdge call!")};tessellation.PI_3div4=3*Math.PI/4;tessellation.PI_2=Math.PI/2;tessellation.EPSILON=1E-12;tessellation.kAlpha=0.3;tessellation.Orientation={CW:1,CCW:-1,COLLINEAR:0};tessellation.Orient2d=function(a,b,c){a=(a.x-c.x)*(b.y-c.y)-(a.y-c.y)*(b.x-c.x);return a>-tessellation.EPSILON&&a<tessellation.EPSILON?
tessellation.Orientation.COLLINEAR:0<a?tessellation.Orientation.CCW:tessellation.Orientation.CW};tessellation.InScanArea=function(a,b,c,d){var g=d.x;d=d.y;var j=a.x-g;a=a.y-d;return j*(b.y-d)-(b.x-g)*a<=tessellation.EPSILON||(c.x-g)*a-j*(c.y-d)<=tessellation.EPSILON?!1:!0};tessellation.Node=function(){this.prev=this.next=this.triangle=this.point=null;this.value=0;1==arguments.length?(this.point=arguments[0],this.value=this.point.x):2==arguments.length?(this.point=arguments[0],this.triangle=arguments[1],
this.value=this.point.x):alert("Invalid tessellation.Node constructor call!")};tessellation.AdvancingFront=function(a,b){this.head=a;this.tail=b;this.search_node=a};tessellation.AdvancingFront.prototype.search=function(){return this.search_node};tessellation.AdvancingFront.prototype.set_search=function(a){this.search_node=a};tessellation.AdvancingFront.prototype.FindSearchNode=function(){return this.search_node};tessellation.AdvancingFront.prototype.LocateNode=function(a){var b=this.search_node;if(a<
b.value)for(;null!=(b=b.prev);){if(a>=b.value)return this.search_node=b}else for(;null!=(b=b.next);)if(a<b.value)return this.search_node=b.prev;return null};tessellation.AdvancingFront.prototype.LocatePoint=function(a){var b=a.x,c=this.FindSearchNode(b),d=c.point.x;if(b==d)if(c.prev&&a.equals(c.prev.point))c=c.prev;else if(c.next&&a.equals(c.next.point))c=c.next;else{if(!a.equals(c.point))return alert("Invalid tessellation.AdvancingFront.LocatePoint call!"),null}else if(b<d)for(;null!=(c=c.prev)&&
!a.equals(c.point););else for(;null!=(c=c.next)&&!a.equals(c.point););null!=c&&(this.search_node=c);return c};tessellation.Basin=function(){this.right_node=this.bottom_node=this.left_node=null;this.width=0;this.left_highest=!1};tessellation.Basin.prototype.Clear=function(){this.right_node=this.bottom_node=this.left_node=null;this.width=0;this.left_highest=!1};tessellation.EdgeEvent=function(){this.constrained_edge=null;this.right=!1};tessellation.SweepContext=function(a){this.triangles=[];this.map=
[];this.points=a;this.edges=[];this.af_tail=this.af_middle_=this.af_head=this.tail=this.head=this.front=null;this.basin=new tessellation.Basin;this.edge_event=new tessellation.EdgeEvent;this.InitEdges(this.points)};tessellation.SweepContext.prototype.AddHole=function(a){this.InitEdges(a);for(var b in a)this.points.push(a[b])};tessellation.SweepContext.prototype.point_count=function(){return this.points.length};tessellation.SweepContext.prototype.GetTriangles=function(){return this.triangles};tessellation.SweepContext.prototype.GetMap=
function(){return this.map};tessellation.SweepContext.prototype.InitTriangulation=function(){var a=this.points[0].x,b=this.points[0].x,c=this.points[0].y,d=this.points[0].y,g;for(g in this.points){var j=this.points[g];j.x>a&&(a=j.x);j.x<b&&(b=j.x);j.y>c&&(c=j.y);j.y<d&&(d=j.y)}c=tessellation.kAlpha*(c-d);this.head=new Two.Vector(a+tessellation.kAlpha*(a-b),d-c);this.tail=new Two.Vector(b-c,d-c);this.points.sort(tessellation.cmp)};tessellation.SweepContext.prototype.InitEdges=function(a){for(var b=
0;b<a.length;++b)this.edges.push(new tessellation.Edge(a[b],a[(b+1)%a.length]))};tessellation.SweepContext.prototype.GetPoint=function(a){return this.points[a]};tessellation.SweepContext.prototype.AddToMap=function(a){this.map.push(a)};tessellation.SweepContext.prototype.LocateNode=function(a){return this.front.LocateNode(a.x)};tessellation.SweepContext.prototype.CreateAdvancingFront=function(){var a,b,c;c=new tessellation.Triangle(this.points[0],this.tail,this.head);this.map.push(c);a=new tessellation.Node(c.GetPoint(1),
c);b=new tessellation.Node(c.GetPoint(0),c);c=new tessellation.Node(c.GetPoint(2));this.front=new tessellation.AdvancingFront(a,c);a.next=b;b.next=c;b.prev=a;c.prev=b};tessellation.SweepContext.prototype.RemoveNode=function(){};tessellation.SweepContext.prototype.MapTriangleToNodes=function(a){for(var b=0;3>b;++b)if(null==a.GetNeighbor(b)){var c=this.front.LocatePoint(a.PointCW(a.GetPoint(b)));null!=c&&(c.triangle=a)}};tessellation.SweepContext.prototype.RemoveFromMap=function(a){for(var b in this.map)if(this.map[b]==
a){delete this.map[b];break}};tessellation.SweepContext.prototype.MeshClean=function(a){if(null!=a&&!a.IsInterior()){a.IsInterior(!0);this.triangles.push(a);for(var b=0;3>b;++b)a.constrained_edge[b]||this.MeshClean(a.GetNeighbor(b))}};tessellation.sweep={};tessellation.sweep.Triangulate=function(a){a.InitTriangulation();a.CreateAdvancingFront();tessellation.sweep.SweepPoints(a);tessellation.sweep.FinalizationPolygon(a)};tessellation.sweep.SweepPoints=function(a){for(var b=1;b<a.point_count();++b)for(var c=
a.GetPoint(b),d=tessellation.sweep.PointEvent(a,c),g=0;g<c.edges.length;++g)tessellation.sweep.EdgeEvent(a,c.edges[g],d)};tessellation.sweep.FinalizationPolygon=function(a){for(var b=a.front.head.next.triangle,c=a.front.head.next.point;!b.GetConstrainedEdgeCW(c);)b=b.NeighborCCW(c);a.MeshClean(b)};tessellation.sweep.PointEvent=function(a,b){var c=a.LocateNode(b),d=tessellation.sweep.NewFrontTriangle(a,b,c);b.x<=c.point.x+tessellation.EPSILON&&tessellation.sweep.Fill(a,c);tessellation.sweep.FillAdvancingFront(a,
d);return d};tessellation.sweep.EdgeEvent=function(){var a;if(3==arguments.length){a=arguments[0];var b=arguments[1],c=arguments[2];a.edge_event.constrained_edge=b;a.edge_event.right=b.p.x>b.q.x;tessellation.sweep.IsEdgeSideOfTriangle(c.triangle,b.p,b.q)||(tessellation.sweep.FillEdgeEvent(a,b,c),tessellation.sweep.EdgeEvent(a,b.p,b.q,c.triangle,b.q))}else if(5==arguments.length){a=arguments[0];var b=arguments[1],c=arguments[2],d=arguments[3],g=arguments[4];if(!tessellation.sweep.IsEdgeSideOfTriangle(d,
b,c)){var j=d.PointCCW(g),j=tessellation.Orient2d(c,j,b);if(j==tessellation.Orientation.COLLINEAR)alert("tessellation.sweep.EdgeEvent: Collinear not supported!");else{var f=d.PointCW(g),f=tessellation.Orient2d(c,f,b);f==tessellation.Orientation.COLLINEAR?alert("tessellation.sweep.EdgeEvent: Collinear not supported!"):j==f?(d=j==tessellation.Orientation.CW?d.NeighborCCW(g):d.NeighborCW(g),tessellation.sweep.EdgeEvent(a,b,c,d,g)):tessellation.sweep.FlipEdgeEvent(a,b,c,d,g)}}}else alert("Invalid tessellation.sweep.EdgeEvent call!")};
tessellation.sweep.IsEdgeSideOfTriangle=function(a,b,c){var d=a.EdgeIndex(b,c);return-1!=d?(a.MarkConstrainedEdge(d),a=a.GetNeighbor(d),null!=a&&a.MarkConstrainedEdge(b,c),!0):!1};tessellation.sweep.NewFrontTriangle=function(a,b,c){var d=new tessellation.Triangle(b,c.point,c.next.point);d.MarkNeighbor(c.triangle);a.AddToMap(d);b=new tessellation.Node(b);b.next=c.next;b.prev=c;c.next.prev=b;c.next=b;tessellation.sweep.Legalize(a,d)||a.MapTriangleToNodes(d);return b};tessellation.sweep.Fill=function(a,
b){var c=new tessellation.Triangle(b.prev.point,b.point,b.next.point);c.MarkNeighbor(b.prev.triangle);c.MarkNeighbor(b.triangle);a.AddToMap(c);b.prev.next=b.next;b.next.prev=b.prev;tessellation.sweep.Legalize(a,c)||a.MapTriangleToNodes(c)};tessellation.sweep.FillAdvancingFront=function(a,b){for(var c=b.next,d;null!=c.next;){d=tessellation.sweep.HoleAngle(c);if(d>tessellation.PI_2||d<-tessellation.PI_2)break;tessellation.sweep.Fill(a,c);c=c.next}for(c=b.prev;null!=c.prev;){d=tessellation.sweep.HoleAngle(c);
if(d>tessellation.PI_2||d<-tessellation.PI_2)break;tessellation.sweep.Fill(a,c);c=c.prev}null!=b.next&&null!=b.next.next&&(d=tessellation.sweep.BasinAngle(b),d<tessellation.PI_3div4&&tessellation.sweep.FillBasin(a,b))};tessellation.sweep.BasinAngle=function(a){return Math.atan2(a.point.y-a.next.next.point.y,a.point.x-a.next.next.point.x)};tessellation.sweep.HoleAngle=function(a){var b=a.next.point.x-a.point.x,c=a.next.point.y-a.point.y,d=a.prev.point.x-a.point.x;a=a.prev.point.y-a.point.y;return Math.atan2(b*
a-c*d,b*d+c*a)};tessellation.sweep.Legalize=function(a,b){for(var c=0;3>c;++c)if(!b.delaunay_edge[c]){var d=b.GetNeighbor(c);if(null!=d){var g=b.GetPoint(c),j=d.OppositePoint(b,g),f=d.Index(j);if(d.constrained_edge[f]||d.delaunay_edge[f])b.constrained_edge[c]=d.constrained_edge[f];else if(tessellation.sweep.Incircle(g,b.PointCCW(g),b.PointCW(g),j))return b.delaunay_edge[c]=!0,d.delaunay_edge[f]=!0,tessellation.sweep.RotateTrianglePair(b,g,d,j),(g=!tessellation.sweep.Legalize(a,b))&&a.MapTriangleToNodes(b),
(g=!tessellation.sweep.Legalize(a,d))&&a.MapTriangleToNodes(d),b.delaunay_edge[c]=!1,d.delaunay_edge[f]=!1,!0}}return!1};tessellation.sweep.Incircle=function(a,b,c,d){var g=a.x-d.x;a=a.y-d.y;var j=b.x-d.x;b=b.y-d.y;var f=g*b-j*a;if(0>=f)return!1;var k=c.x-d.x;c=c.y-d.y;d=k*a-g*c;return 0>=d?!1:0<(g*g+a*a)*(j*c-k*b)+(j*j+b*b)*d+(k*k+c*c)*f};tessellation.sweep.RotateTrianglePair=function(a,b,c,d){var g,j,f,k;g=a.NeighborCCW(b);j=a.NeighborCW(b);f=c.NeighborCCW(d);k=c.NeighborCW(d);var m,p,r,q;m=a.GetConstrainedEdgeCCW(b);
p=a.GetConstrainedEdgeCW(b);r=c.GetConstrainedEdgeCCW(d);q=c.GetConstrainedEdgeCW(d);var h,n,u,s;h=a.GetDelaunayEdgeCCW(b);n=a.GetDelaunayEdgeCW(b);u=c.GetDelaunayEdgeCCW(d);s=c.GetDelaunayEdgeCW(d);a.Legalize(b,d);c.Legalize(d,b);c.SetDelaunayEdgeCCW(b,h);a.SetDelaunayEdgeCW(b,n);a.SetDelaunayEdgeCCW(d,u);c.SetDelaunayEdgeCW(d,s);c.SetConstrainedEdgeCCW(b,m);a.SetConstrainedEdgeCW(b,p);a.SetConstrainedEdgeCCW(d,r);c.SetConstrainedEdgeCW(d,q);a.ClearNeigbors();c.ClearNeigbors();g&&c.MarkNeighbor(g);
j&&a.MarkNeighbor(j);f&&a.MarkNeighbor(f);k&&c.MarkNeighbor(k);a.MarkNeighbor(c)};tessellation.sweep.FillBasin=function(a,b){a.basin.left_node=tessellation.Orient2d(b.point,b.next.point,b.next.next.point)==tessellation.Orientation.CCW?b.next.next:b.next;for(a.basin.bottom_node=a.basin.left_node;null!=a.basin.bottom_node.next&&a.basin.bottom_node.point.y>=a.basin.bottom_node.next.point.y;)a.basin.bottom_node=a.basin.bottom_node.next;if(a.basin.bottom_node!=a.basin.left_node){for(a.basin.right_node=
a.basin.bottom_node;null!=a.basin.right_node.next&&a.basin.right_node.point.y<a.basin.right_node.next.point.y;)a.basin.right_node=a.basin.right_node.next;a.basin.right_node!=a.basin.bottom_node&&(a.basin.width=a.basin.right_node.point.x-a.basin.left_node.point.x,a.basin.left_highest=a.basin.left_node.point.y>a.basin.right_node.point.y,tessellation.sweep.FillBasinReq(a,a.basin.bottom_node))}};tessellation.sweep.FillBasinReq=function(a,b){if(!tessellation.sweep.IsShallow(a,b)){tessellation.sweep.Fill(a,
b);var c;if(!(b.prev==a.basin.left_node&&b.next==a.basin.right_node)){if(b.prev==a.basin.left_node){c=tessellation.Orient2d(b.point,b.next.point,b.next.next.point);if(c==tessellation.Orientation.CW)return;b=b.next}else if(b.next==a.basin.right_node){c=tessellation.Orient2d(b.point,b.prev.point,b.prev.prev.point);if(c==tessellation.Orientation.CCW)return;b=b.prev}else b=b.prev.point.y<b.next.point.y?b.prev:b.next;tessellation.sweep.FillBasinReq(a,b)}}};tessellation.sweep.IsShallow=function(a,b){return a.basin.width>
(a.basin.left_highest?a.basin.left_node.point.y-b.point.y:a.basin.right_node.point.y-b.point.y)?!0:!1};tessellation.sweep.FillEdgeEvent=function(a,b,c){a.edge_event.right?tessellation.sweep.FillRightAboveEdgeEvent(a,b,c):tessellation.sweep.FillLeftAboveEdgeEvent(a,b,c)};tessellation.sweep.FillRightAboveEdgeEvent=function(a,b,c){for(;c.next.point.x<b.p.x;)tessellation.Orient2d(b.q,c.next.point,b.p)==tessellation.Orientation.CCW?tessellation.sweep.FillRightBelowEdgeEvent(a,b,c):c=c.next};tessellation.sweep.FillRightBelowEdgeEvent=
function(a,b,c){c.point.x<b.p.x&&(tessellation.Orient2d(c.point,c.next.point,c.next.next.point)==tessellation.Orientation.CCW?tessellation.sweep.FillRightConcaveEdgeEvent(a,b,c):(tessellation.sweep.FillRightConvexEdgeEvent(a,b,c),tessellation.sweep.FillRightBelowEdgeEvent(a,b,c)))};tessellation.sweep.FillRightConcaveEdgeEvent=function(a,b,c){tessellation.sweep.Fill(a,c.next);c.next.point!=b.p&&(tessellation.Orient2d(b.q,c.next.point,b.p)==tessellation.Orientation.CCW&&tessellation.Orient2d(c.point,
c.next.point,c.next.next.point)==tessellation.Orientation.CCW)&&tessellation.sweep.FillRightConcaveEdgeEvent(a,b,c)};tessellation.sweep.FillRightConvexEdgeEvent=function(a,b,c){tessellation.Orient2d(c.next.point,c.next.next.point,c.next.next.next.point)==tessellation.Orientation.CCW?tessellation.sweep.FillRightConcaveEdgeEvent(a,b,c.next):tessellation.Orient2d(b.q,c.next.next.point,b.p)==tessellation.Orientation.CCW&&tessellation.sweep.FillRightConvexEdgeEvent(a,b,c.next)};tessellation.sweep.FillLeftAboveEdgeEvent=
function(a,b,c){for(;c.prev.point.x>b.p.x;)tessellation.Orient2d(b.q,c.prev.point,b.p)==tessellation.Orientation.CW?tessellation.sweep.FillLeftBelowEdgeEvent(a,b,c):c=c.prev};tessellation.sweep.FillLeftBelowEdgeEvent=function(a,b,c){c.point.x>b.p.x&&(tessellation.Orient2d(c.point,c.prev.point,c.prev.prev.point)==tessellation.Orientation.CW?tessellation.sweep.FillLeftConcaveEdgeEvent(a,b,c):(tessellation.sweep.FillLeftConvexEdgeEvent(a,b,c),tessellation.sweep.FillLeftBelowEdgeEvent(a,b,c)))};tessellation.sweep.FillLeftConvexEdgeEvent=
function(a,b,c){tessellation.Orient2d(c.prev.point,c.prev.prev.point,c.prev.prev.prev.point)==tessellation.Orientation.CW?tessellation.sweep.FillLeftConcaveEdgeEvent(a,b,c.prev):tessellation.Orient2d(b.q,c.prev.prev.point,b.p)==tessellation.Orientation.CW&&tessellation.sweep.FillLeftConvexEdgeEvent(a,b,c.prev)};tessellation.sweep.FillLeftConcaveEdgeEvent=function(a,b,c){tessellation.sweep.Fill(a,c.prev);c.prev.point!=b.p&&(tessellation.Orient2d(b.q,c.prev.point,b.p)==tessellation.Orientation.CW&&
tessellation.Orient2d(c.point,c.prev.point,c.prev.prev.point)==tessellation.Orientation.CW)&&tessellation.sweep.FillLeftConcaveEdgeEvent(a,b,c)};tessellation.sweep.FlipEdgeEvent=function(a,b,c,d,g){var j=d.NeighborAcross(g);if(null==j)alert("[BUG:FIXME] FLIP failed due to missing triangle!");else{var f=j.OppositePoint(d,g);if(tessellation.InScanArea(g,d.PointCCW(g),d.PointCW(g),f))if(tessellation.sweep.RotateTrianglePair(d,g,j,f),a.MapTriangleToNodes(d),a.MapTriangleToNodes(j),g==c&&f==b)c==a.edge_event.constrained_edge.q&&
b==a.edge_event.constrained_edge.p&&(d.MarkConstrainedEdge(b,c),j.MarkConstrainedEdge(b,c),tessellation.sweep.Legalize(a,d),tessellation.sweep.Legalize(a,j));else{var k=tessellation.Orient2d(c,f,b);d=tessellation.sweep.NextFlipTriangle(a,k,d,j,g,f);tessellation.sweep.FlipEdgeEvent(a,b,c,d,g)}else f=tessellation.sweep.NextFlipPoint(b,c,j,f),tessellation.sweep.FlipScanEdgeEvent(a,b,c,d,j,f),tessellation.sweep.EdgeEvent(a,b,c,d,g)}};tessellation.sweep.NextFlipTriangle=function(a,b,c,d,g,j){if(b==tessellation.Orientation.CCW)return b=
d.EdgeIndex(g,j),d.delaunay_edge[b]=!0,tessellation.sweep.Legalize(a,d),d.ClearDelunayEdges(),c;b=c.EdgeIndex(g,j);c.delaunay_edge[b]=!0;tessellation.sweep.Legalize(a,c);c.ClearDelunayEdges();return d};tessellation.sweep.NextFlipPoint=function(a,b,c,d){a=tessellation.Orient2d(b,d,a);if(a==tessellation.Orientation.CW)return c.PointCCW(d);if(a==tessellation.Orientation.CCW)return c.PointCW(d);alert("[Unsupported] tessellation.sweep.NextFlipPoint: opposing point on constrained edge!")};tessellation.sweep.FlipScanEdgeEvent=
function(a,b,c,d,g,j){var f=g.NeighborAcross(j);null==f?alert("[BUG:FIXME] FLIP failed due to missing triangle"):(g=f.OppositePoint(g,j),tessellation.InScanArea(c,d.PointCCW(c),d.PointCW(c),g)?tessellation.sweep.FlipEdgeEvent(a,c,g,f,g):(g=tessellation.sweep.NextFlipPoint(b,c,f,g),tessellation.sweep.FlipScanEdgeEvent(a,b,c,d,f,g)))}})();(function(){function l(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(h.Events.resize,b,a)}var a=this,b=a.Two||{},c=Math.sin,d=Math.cos,g=Math.atan2,j=Math.sqrt,f=Math.abs,k=Math.PI,m=2*k,p=k/2,r=Math.pow,q={hasEventListeners:_.isFunction(a.addEventListener),bind:function(a,b,c,h){this.hasEventListeners?a.addEventListener(b,c,!!h):a.attachEvent("on"+b,c);return this},unbind:function(a,b,c,h){this.hasEventListeners?
a.removeEventListeners(b,c,!!h):a.detachEvent("on"+b,c);return this}},h=a.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:h.Types.svg,autostart:!1});this.type=a.type;this.renderer=new h[this.type](this);this.playing=a.autostart;this.frameCount=0;a.fullscreen?(a=_.bind(l,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),q.bind(window,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=
a.width,this.height=a.height);this.scene=new h.Group;this.renderer.add(this.scene);h.Instances.push(this)};_.extend(h,{Array:a.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,Instances:[],noConflict:function(){a.Two=b;return this},Utils:{Curve:{CollinearityEpsilon:r(10,-30),RecursionLimit:32,CuspLimit:2,Tolerance:{distance:0.25,
angle:0,epsilon:0.01}},subdivide:function(a,b,c,d,j,n,u,p,q){var s=h.Utils.Curve.CollinearityEpsilon,r=h.Utils.Curve.CuspLimit,t=h.Utils.Curve.Tolerance;q=q||0;var l=(a+c)/2,B=(b+d)/2,C=(c+j)/2,y=(d+n)/2,N=(j+u)/2,O=(n+p)/2,P=(l+C)/2,Q=(B+y)/2,C=(C+N)/2,y=(y+O)/2,D=(P+C)/2,E=(Q+y)/2;if(0<q){var x=u-a,A=p-b,I=f((c-u)*A-(d-p)*x),J=f((j-u)*A-(n-p)*x);if(I>s&&J>s&&(I+J)*(I+J)<=t.distance*(x*x+A*A)){if(t.angle<t.epsilon)return[new h.Vector(D,E)];x=g(n-d,j-c);s=f(x-g(d-b,c-a));x=f(g(p-n,u-j)-x);s>=k&&(s=
m-s);x>=k&&(x=m-x);if(s+x<t.angle)return[new h.Vector(D,E)];if(0!==r){if(s>r)return[new h.Vector(c,d)];if(x>r)return[new h.Vector(j,n)]}}}else if(I>s)if(I*I<=t.distance*(x*x+A*A)){if(t.angle<t.epsilon)return[new h.Vector(D,E)];s=f(g(n-d,j-c)-g(d-b,c-a));s>=k&&(s=m-s);if(s<t.angle)return[new h.Vector(c,d),new h.Vector(j,n)];if(0!==r&&s>r)return[new h.Vector(c,d)]}else if(J>s){if(J*J<=t.distance*(x*x+A*A)){if(t.angle<t.epsilon)return[new h.Vector(D,E)];s=f(g(p-n,u-j)-g(n-d,j-c));s>=k&&(s=m-s);if(s<
t.angle)return[new h.Vector(c,d),new h.Vector(j,n)];if(0!==r&&s>r)return[new h.Vector2(j,n)]}}else if(x=D-(a+u)/2,A=E-(b+p)/2,x*x+A*A<=t.distance)return[new h.Vector(D,E)];return h.Utils.subdivide(a,b,l,B,P,Q,D,E,q+1).concat(h.Utils.subdivide(D,E,C,y,N,O,u,p,q+1))},getCurveFromPoints:function(a,b){for(var c=[],h=a.length,d=h-1,f=0;f<h;f++){var j=a[f],g={x:j.x,y:j.y};c.push(g);var j=b?t(f-1,h):Math.max(f-1,0),n=b?t(f+1,h):Math.min(f+1,d);B(a[j],g,a[n]);!g.u.x&&!g.u.y&&(g.u.x=g.x,g.u.y=g.y);!g.v.x&&
!g.v.y&&(g.v.x=g.x,g.v.y=g.y)}return c},getControlPoints:function(a,b,e){var h=s(a,b),f=s(e,b);a=n(a,b);e=n(e,b);var g=(h+f)/2;if(1E-4>a||1E-4>e)return b.u={x:b.x,y:b.y},b.v={x:b.x,y:b.y},b;a*=0.33;e*=0.33;g=f<h?g+p:g-p;h={x:b.x+d(g)*a,y:b.y+c(g)*a};g-=k;f={x:b.x+d(g)*e,y:b.y+c(g)*e};b.u=h;b.v=f;return b},angleBetween:function(a,b){return g(a.y-b.y,a.x-b.x)},distanceBetweenSquared:function(a,b){var c=a.x-b.x,h=a.y-b.y;return c*c+h*h},distanceBetween:function(a,b){return j(u(a,b))},mod:function(a,
b){for(;0>a;)a+=b;return a%b},Error:function(a){this.name="two.js";this.message=a}}});h.Utils.Error.prototype=Error();h.Utils.Error.prototype.constructor=h.Utils.Error;var n=h.Utils.distanceBetween,u=h.Utils.distanceBetweenSquared,s=h.Utils.angleBetween,B=h.Utils.getControlPoints,t=h.Utils.mod;_.extend(h.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){this.playing=!0;return this.trigger(h.Events.play)},pause:function(){this.playing=
!1;return this.trigger(h.Events.pause)},update:function(){this.frameCount++;var a=this.width,b=this.height,c=this.renderer;(a!==c.width||b!==c.height)&&c.setSize(a,b);return this.trigger(h.Events.update,this.frameCount)},render:function(){this.renderer.render();return this.trigger(h.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},makeLine:function(a,b,c,f){c=(c-a)/2;f=(f-b)/2;var d=[new h.Vector(-c,-f),new h.Vector(c,f)],
d=(new h.Polygon(d)).noFill();d.translation.set(a+c,b+f);this.scene.add(d);return d},makeRectangle:function(a,b,c,f){c/=2;f/=2;f=[new h.Vector(c,f),new h.Vector(-c,f),new h.Vector(-c,-f),new h.Vector(c,-f)];f=new h.Polygon(f,!0);f.translation.set(a,b);this.scene.add(f);return f},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,e,f){var g=h.Resolution,j=_.map(_.range(g),function(a){var b=a/g*m;a=e*d(b);b=f*c(b);return new h.Vector(a,b)},this),j=new h.Polygon(j,
!0,!0);j.translation.set(a,b);this.scene.add(j);return j},makeCurve:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],f=0;f<b;f+=2){var d=arguments[f];if(!_.isNumber(d))break;c.push(new h.Vector(d,arguments[f+1]))}var b=arguments[b-1],c=new h.Polygon(c,!(_.isBoolean(b)&&b),!0),b=c.getBoundingClientRect(),g=b.left+b.width/2,j=b.top+b.height/2;_.each(c.vertices,function(a){a.x-=g;a.y-=j});c.translation.set(g,j);this.scene.add(c);return c},makePolygon:function(a){var b=arguments.length,
c=a;if(!_.isArray(a))for(var c=[],f=0;f<b;f+=2){var d=arguments[f];if(!_.isNumber(d))break;c.push(new h.Vector(d,arguments[f+1]))}var b=arguments[b-1],c=new h.Polygon(c,!(_.isBoolean(b)&&b)),b=c.getBoundingClientRect(),g=b.left+b.width/2,j=b.top+b.height/2;_.each(c.vertices,function(a){a.x-=g;a.y-=j});c.translation.set(g,j);this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new h.Group;this.scene.add(c);c.add(b);return c}});(function(){_.each(h.Instances,
function(a){a.playing&&a.update().render()});requestAnimationFrame(arguments.callee)})()})();(function(){var l=Two.Vector=function(a,b){a=a||0;b=b||0;Object.defineProperty(this,"x",{get:function(){return a},set:function(b){a=b;this.trigger("change","x")}});Object.defineProperty(this,"y",{get:function(){return b},set:function(a){b=a;this.trigger("change","y")}})};_.extend(l,{});_.extend(l.prototype,Backbone.Events,{set:function(a,b){this.x=a;this.y=b;return this},copy:function(a){this.x=a.x;this.y=a.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new l(this.x,
this.y)},add:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addSelf:function(a){this.x+=a.x;this.y+=a.y;return this},sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},subSelf:function(a){this.x-=a.x;this.y-=a.y;return this},multiplySelf:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){a?(this.x/=a,this.y/=a):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*
a.x+this.y*a.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){return this.normalize().multiplyScalar(a)},equals:function(a){return 1E-4>this.distanceTo(a)},lerp:function(a,b){return this.set((a.x-this.x)*
b+this.x,(a.y-this.y)*b+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var l=Math.cos,a=Math.sin,b=Math.tan,c=Two.Matrix=function(a,b,c,f,k,m){this.elements=new Two.Array(9);var p=a;_.isArray(p)||(p=_.toArray(arguments));this.identity().set(p)};_.extend(c,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(a,b){var c=a[0],f=a[1],k=a[2],m=a[3],p=a[4],r=a[5],q=a[6],h=a[7],n=a[8],u=b[0],s=b[1],l=b[2],t=b[3],z=b[4],w=b[5],e=b[6],v=b[7],H=b[8];return[c*u+f*t+k*e,c*s+f*z+k*v,c*l+f*w+k*H,m*u+p*t+r*e,m*s+p*z+r*v,m*l+p*w+r*H,q*u+h*t+n*e,q*s+h*z+n*v,q*l+h*w+
n*H]}});_.extend(c.prototype,{set:function(a,b,c,f,k,m){var p=a;_.isArray(p)||(p=_.toArray(arguments));_.each(p,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this},identity:function(){this.set(c.Identity);return this},multiply:function(a,b,c,f,k,m,p,r,q){var h=arguments,n=h.length;if(1>=n)return _.each(this.elements,function(b,c){this.elements[c]=b*a},this),this;if(3>=n)return a=a||0,b=b||0,c=c||0,k=this.elements,{x:k[0]*a+k[1]*b+k[2]*c,y:k[3]*a+k[4]*b+k[5]*c,z:k[6]*a+k[7]*b+k[8]*
c};n=this.elements;A0=n[0];A1=n[1];A2=n[2];A3=n[3];A4=n[4];A5=n[5];A6=n[6];A7=n[7];A8=n[8];B0=h[0];B1=h[1];B2=h[2];B3=h[3];B4=h[4];B5=h[5];B6=h[6];B7=h[7];B8=h[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this},scale:function(a,
b){1>=arguments.length&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(b){var c=l(b);b=a(b);return this.multiply(c,-b,0,b,c,0,0,0,1)},translate:function(a,b){return this.multiply(1,0,a,0,1,b,0,0,1)},skewX:function(a){a=b(a);return this.multiply(1,a,0,0,1,0,0,0,1)},skewY:function(a){a=b(a);return this.multiply(1,0,0,a,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(a){var b=this.elements,c=parseFloat(b[0].toFixed(3)),f=parseFloat(b[1].toFixed(3)),k=
parseFloat(b[2].toFixed(3)),m=parseFloat(b[3].toFixed(3)),p=parseFloat(b[4].toFixed(3)),r=parseFloat(b[5].toFixed(3));if(a){a=parseFloat(b[6].toFixed(3));var q=parseFloat(b[7].toFixed(3)),b=parseFloat(b[8].toFixed(3));return[c,m,a,f,p,q,k,r,b]}return[c,m,f,p,k,r]},clone:function(){return new Two.Matrix(this.elements.slice(0))}})})();(function(){function l(a){var b={},c=a.id,m=a.translation,p=a.rotation,r=a.scale,q=a.stroke,h=a.linewidth,n=a.fill,u=a.opacity,s=a.visible,l=a.cap,t=a.join,z=a.miter,w=a.curved,e=a.closed;a=a.vertices;c&&(b.id=g.Identifier+c);m&&(_.isNumber(r)&&_.isNumber(p))&&(b.transform="translate("+m.x+","+m.y+") scale("+r+") rotate("+p+")");q&&(b.stroke=q);n&&(b.fill=n);u&&(b["stroke-opacity"]=b["fill-opacity"]=u);b.visibility=s?"visible":"hidden";l&&(b["stroke-linecap"]=l);t&&(b["stroke-linejoin"]=t);z&&(b["stroke-miterlimit"]=
z);h&&(b["stroke-width"]=h);a&&(b.d=d.toString(a,e,w));return b}var a=0,b=Two.Utils.getCurveFromPoints,c=Two.Utils.mod,d={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(a,b){var c=a.toLowerCase(),d=document.createElementNS(this.ns,c);"svg"===c&&(b=_.defaults(b||{},{version:this.version}));_.isObject(b)&&this.setAttributes(d,b);return d},setAttributes:function(a,b){_.each(b,function(a,b){this.setAttribute(b,a)},a);return this},removeAttributes:function(a,
b){_.each(b,function(a){this.removeAttribute(a)},a);return this},toString:function(a,f,d){var g=a.length,p=g-1;if(!d)return _.map(a,function(a,b){var c;c=(0>=b?"M":"L")+(" "+a.x.toFixed(3)+" "+a.y.toFixed(3));b>=p&&f&&(c+=" Z");return c}).join(" ");var r=b(a,f);return _.map(r,function(a,b){var d,j=f?c(b-1,g):Math.max(b-1,0),k=f?c(b+1,g):Math.min(b+1,p);d=r[j];var k=r[k],j=d.v.x.toFixed(3),l=d.v.y.toFixed(3),t=a.u.x.toFixed(3),z=a.u.y.toFixed(3),w=a.x.toFixed(3),e=a.y.toFixed(3);d=0>=b?"M "+w+" "+
e:"C "+j+" "+l+" "+t+" "+z+" "+w+" "+e;b>=p&&f&&(j=a.v.x.toFixed(3),l=a.v.y.toFixed(3),t=k.u.x.toFixed(3),z=k.u.y.toFixed(3),w=k.x.toFixed(3),e=k.y.toFixed(3),d=d+(" C "+j+" "+l+" "+t+" "+z+" "+w+" "+e)+" Z");return d}).join(" ")}},g=Two[Two.Types.svg]=function(){this.domElement=d.createElement("svg");this.elements=[];this.commands=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(g,{Identifier:"two-"});_.extend(g.prototype,
Backbone.Events,{setSize:function(a,b){this.width=a;this.height=b;d.setAttributes(this.domElement,{width:a,height:b});return this},add:function(b){var c=b,g=this.elements,m=this.domElement;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(b){var c;c=b instanceof Two.Group;if(_.isUndefined(b.id)){var f=a;a++;b.id=f}c?(c="g",_.isUndefined(b.parent)&&(b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),b=l(b),delete b.stroke,delete b.fill,
delete b["fill-opacity"],delete b["stroke-opacity"],delete b["stroke-linecap"],delete b["stroke-linejoin"],delete b["stroke-miterlimit"],delete b["stroke-width"]):(c="path",b=l(b));b=d.createElement(c,b);m.appendChild(b);g.push(b)},this);return this},update:function(a,b,c){this.commands.push(arguments);return this},render:function(){this.unveil();var a=this.elements;_.each(this.commands,function(b){var c=b[1],g=b[2],p=b[3],l=b[4],q=a[b[0]];switch(c){case Two.Properties.hierarchy:_.each(g,function(b){q.appendChild(a[b])});
break;default:a:{b=c;switch(b){case "matrix":b="transform";g="matrix("+g.toString()+")";break;case "visible":b="visibility";g=g?"visible":"hidden";break;case "cap":b="stroke-linecap";break;case "join":b="stroke-linejoin";break;case "miter":b="stroke-miterlimit";break;case "linewidth":b="stroke-width";break;case "vertices":b="d";g=d.toString(g,p,l);break;case "opacity":d.setAttributes(q,{"stroke-opacity":opacity,"fill-opacity":opacity});break a}q.setAttribute(b,g)}}},this);this.commands.length=0;return this}})})();(function(){var l=0,a=Two.Utils.getCurveFromPoints,b=Two.Utils.mod,c=function(a){_.each(a,function(a,b){this[b]=a},this);this.children={}};_.extend(c.prototype,{appendChild:function(a){var b=a.parent,c=a.id;_.isUndefined(b)||delete b.children[c];this.children[c]=a;a.parent=this;return this},render:function(a){var b=this.matrix;a.save();a.transform(b[0],b[1],b[2],b[3],b[4],b[5]);_.each(this.children,function(b){b.render(a)});a.restore();return this}});var d=function(a){_.each(a,function(a,b){this[b]=
a},this)};_.extend(d.prototype,{render:function(a){var c=this.matrix,d=this.stroke,g=this.linewidth,j=this.fill,q=this.opacity,h=this.cap,n=this.join,u=this.miter,s=this.curved,l=this.closed,t=this.commands,z=t.length,w=z-1;if(!this.visible)return this;a.save();c&&a.transform(c[0],c[1],c[2],c[3],c[4],c[5]);j&&(a.fillStyle=j);d&&(a.strokeStyle=d);g&&(a.lineWidth=g);u&&(a.miterLimit=u);n&&(a.lineJoin=n);h&&(a.lineCap=h);_.isNumber(q)&&(a.globalAlpha=q);a.beginPath();_.each(t,function(c,h){var d=c.x.toFixed(3),
g=c.y.toFixed(3);if(s){var n=l?b(h-1,z):Math.max(h-1,0),j=l?b(h+1,z):Math.min(h+1,w),k=t[n],j=t[j],n=k.v.x.toFixed(3),k=k.v.y.toFixed(3),u=c.u.x.toFixed(3),m=c.u.y.toFixed(3);0>=h?a.moveTo(d,g):(a.bezierCurveTo(n,k,u,m,d,g),h>=w&&l&&(n=c.v.x.toFixed(3),k=c.v.y.toFixed(3),u=j.u.x.toFixed(3),m=j.u.y.toFixed(3),d=j.x.toFixed(3),g=j.y.toFixed(3),a.bezierCurveTo(n,k,u,m,d,g)))}else 0>=h?a.moveTo(d,g):a.lineTo(d,g)});l&&!s&&a.closePath();a.fill();a.stroke();a.restore()}});var g={toArray:function(b,c,d){return!c?
_.map(b,function(a){return{x:a.x,y:a.y}}):a(b,d)}},j=Two[Two.Types.canvas]=function(){this.domElement=document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.elements=[];this.stage=null};_.extend(j,{});_.extend(j,{Group:c,Element:d,getStyles:function(a){var b={},c=a.id,d=a._matrix,j=a.stroke,q=a.linewidth,h=a.fill,n=a.opacity,u=a.visible,s=a.cap,l=a.join,t=a.miter,z=a.curved,w=a.closed;a=a.vertices;c&&(b.id=c);_.isObject(d)&&(b.matrix=d.toArray());j&&(b.stroke=j);h&&(b.fill=
h);_.isNumber(n)&&(b.opacity=n);s&&(b.cap=s);l&&(b.join=l);t&&(b.miter=t);q&&(b.linewidth=q);a&&(b.commands=g.toArray(a,z,w));b.visible=!!u;b.curved=!!z;b.closed=!!w;return b},setStyles:function(a,b,c){switch(b){case "matrix":b="matrix";c=c.toArray();break;case "vertices":b="commands",c=g.toArray(c,a.curved,a.closed)}a[b]=c}});_.extend(j.prototype,Backbone.Events,{setSize:function(a,b){this.width=this.domElement.width=a;this.height=this.domElement.height=b;_.extend(this.domElement.style,{width:this.width+
"px",height:this.height+"px"});return this},add:function(a){constructor=Object.getPrototypeOf(this).constructor;var b=a,c=this.elements,d=constructor.Group,g=constructor.Element,j=constructor.getStyles;_.isArray(a)||(b=_.map(arguments,function(a){return a}));_.each(b,function(a){var b;b=a instanceof Two.Group;var f=_.isNull(this.stage);if(_.isUndefined(a.id)){var k=l;l++;a.id=k}b?(b=j.call(this,a),delete b.stroke,delete b.fill,delete b.opacity,delete b.cap,delete b.join,delete b.miter,delete b.linewidth,
b=new d(b),f&&(this.stage=b,this.stage.object=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):b=new g(j.call(this,a));c.push(b);f||this.stage.appendChild(b)},this);return this},update:function(a,b,c){var d=Object.getPrototypeOf(this).constructor,g=this.elements,j=g[a];switch(b){case Two.Properties.hierarchy:_.each(c,function(a){j.appendChild(g[a])});break;default:d.setStyles.call(this,j,b,c)}return this},render:function(){if(_.isNull(this.stage))return this;
this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);return this}})})();(function(){var l=Two[Two.Types.canvas],a=Two.Utils.getCurveFromPoints,b=Two.Matrix.Multiply,c={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",
darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",
floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",
lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370D8",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",
mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#D87093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",
royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",transparent:"#000",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:'#9ACD32"'},
d="(?:\\+|-)?\\d+",g="(?:\\+|-)?\\d*\\.\\d+",j="(?:"+d+")|(?:"+g+")",d="("+d+")",g="("+g+")",j="("+j+")",g=j+"%",f=RegExp(["^hsl(a?)\\(",j,",",g,",",g,"(,",j,")?\\)$"].join("\\s*?")),k=RegExp(["^rgb(a?)\\(",d,",",d,",",d,"(,",j,")?\\)$"].join("\\s*?")),m=RegExp(["^rgb(a?)\\(",g,",",g,",",g,"(,",j,")?\\)$"].join("\\s*?")),p=/^,\s*/,r=[function(a){function b(c,d){var f=a.match(c);if(f&&1!==!!f[1]+!!f[5]){var g=_.isUndefined(f[5])?1:f[5].replace(p,"");return{r:Math.min(1,Math.max(0,f[2]/d)),g:Math.min(1,
Math.max(0,f[3]/d)),b:Math.min(1,Math.max(0,f[4]/d)),a:Math.min(1,Math.max(g,0))}}}a=a.replace(/^\s+|\s+$/g,"");var c=b(k,255);return c?c:b(m,100)},function(a){var b=a.toLowerCase();b in c&&(a=c[b]);if(a.match(/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/)){a=a.replace(/^#/,"");var b=a.length/3,d=Math.pow(16,b)-1;return{r:parseInt(a.slice(0,b),16)/d,g:parseInt(a.slice(1*b,2*b),16)/d,b:parseInt(a.slice(2*b),16)/d,a:1}}},function(a){var b=a.replace(/^\s+|\s+$/g,"").match(f);if(!b||1===!!b[1]+!!b[5])return null;
a=(b[2]%360+360)%360/360;var c=Math.max(0,Math.min(parseInt(b[3],10)/100,1)),d=Math.max(0,Math.min(parseInt(b[4],10)/100,1)),b=b[5];if(0!=c)var g=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a},j=0.5>d?d*(1+c):d+c-d*c,k=2*d-j;c=_.isUndefined(b)||_.isNull(b)?1:b.replace(p,"");return{r:g(k,j,a+1/3),g:g(k,j,a),b:g(k,j,a-1/3),a:c}}],d=function(a){l.Group.call(this,a)};_.extend(d.prototype,l.Group.prototype,{appendChild:function(){l.Group.prototype.appendChild.apply(this,
arguments);this.updateMatrix();return this},updateMatrix:function(a){a=a||this.parent&&this.parent.matrix;if(!a)return this;this._matrix=b(this.matrix,a);_.each(this.children,function(a){a.updateMatrix(this._matrix)},this);return this},render:function(a,b,c,d){_.each(this.children,function(f){f.render(a,b,c,d)})}});j=function(a){l.Element.call(this,a)};_.extend(j.prototype,l.Element.prototype,{updateMatrix:function(a){a=a||this.parent&&this.parent.matrix;if(!a)return this;this._matrix=b(this.matrix,
a);return this},render:function(a,b,c,d){if(!this.visible||!this.fillBuffer||!this.strokeBuffer)return this;0<this.fill.a&&(a.bindBuffer(a.ARRAY_BUFFER,this.fillBuffer),a.vertexAttribPointer(b,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(c,!1,this._matrix),a.uniform4f(d,this.fill.r,this.fill.g,this.fill.b,this.fill.a),a.drawArrays(a.TRIANGLES,0,this.triangleAmount));if(0>=this.linewidth||0>=this.stroke.a)return this;a.bindBuffer(a.ARRAY_BUFFER,this.strokeBuffer);a.vertexAttribPointer(b,2,a.FLOAT,!1,0,0);
a.uniformMatrix3fv(c,!1,this._matrix);a.uniform4f(d,this.stroke.r,this.stroke.g,this.stroke.b,this.stroke.a);a.lineWidth(this.linewidth);a.drawArrays(a.LINES,0,this.vertexAmount);return this}});var q={updateBuffer:function(a,b,c){_.isObject(b.fillBuffer)&&a.deleteBuffer(b.fillBuffer);b.fillBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.fillBuffer);a.enableVertexAttribArray(c);a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW);_.isObject(b.strokeBuffer)&&a.deleteBuffer(b.strokeBuffer);b.strokeBuffer=
a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.strokeBuffer);a.enableVertexAttribArray(c);a.bufferData(a.ARRAY_BUFFER,b.vertices,a.STATIC_DRAW)},interpret:function(a){for(var b=0,c=r.length;b<c;b++){var d=r[b](a);if(d)return d}return{r:0,g:0,b:0,a:0}},toArray:function(b,c,d){if(!c)return b;var f=a(b,d),g=f.length,j=g-1,k=[];_.each(f,function(a,b){if(d||!d&&b<j){var c=f[(b+1)%g],c=Two.Utils.subdivide(a.x,a.y,a.v.x,a.v.y,c.u.x,c.u.y,c.x,c.y);k=k.concat(c)}});return k},tessellate:function(a,b,c,d,f){a=
new tessellation.SweepContext(a);tessellation.sweep.Triangulate(a);b=6*a.triangles.length;var g=d&&b<=d.length?d:new Two.Array(b);_.each(a.triangles,function(a,b){var c=a.points,d=c[0],h=c[1],c=c[2],f=6*b;g[f+0]=d.x;g[f+1]=d.y;g[f+2]=h.x;g[f+3]=h.y;g[f+4]=c.x;g[f+5]=c.y});d=4*a.edges.length;var j=f&&d<=f.length?f:new Two.Array(d);_.each(a.edges,function(a,b){var c=a.p,d=a.q,h=4*b;j[h]=c.x;j[h+1]=c.y;j[h+2]=d.x;j[h+3]=d.y});return{triangles:g,vertices:j,triangleAmount:b/2,vertexAmount:d/2}},program:{create:function(a,
b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)});a.linkProgram(c);if(!a.getProgramParameter(c,a.LINK_STATUS))throw error=a.getProgramInfoLog(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){c=a.createShader(a[c]);a.shaderSource(c,b);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw a=a.getShaderInfoLog(c),new Two.Utils.Error("unable to compile shader "+c+": "+a);return c},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},
vertex:"attribute vec2 position;\nuniform mat3 matrix;\nuniform vec2 resolution;\n\nvoid main() {\n   vec2 projected = (matrix * vec3(position, 1)).xy;\n   vec2 normal = projected / resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n}",fragment:"precision mediump float;\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}"}},g=Two[Two.Types.webgl]=function(){this.domElement=document.createElement("canvas");this.elements=
[];this.stage=null;var a={antialias:!0,premultipliedAlpha:!1};this.ctx=this.domElement.getContext("webgl",a)||this.domElement.getContext("experimental-webgl",a);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var a=q.shaders.create(this.ctx,q.shaders.vertex,q.shaders.types.vertex),b=q.shaders.create(this.ctx,q.shaders.fragment,q.shaders.types.fragment);this.program=q.program.create(this.ctx,[a,b]);this.ctx.useProgram(this.program);this.positionLocation=
this.ctx.getAttribLocation(this.program,"position");this.colorLocation=this.ctx.getUniformLocation(this.program,"color");this.matrixLocation=this.ctx.getUniformLocation(this.program,"matrix");this.ctx.enable(this.ctx.BLEND);this.ctx.disable(this.ctx.DEPTH_TEST);this.ctx.blendFunc(this.ctx.ONE,this.ctx.SRC_ALPHA)};_.extend(g,{Group:d,Element:j,getStyles:function(a){var b={},c=a.id,d=a._matrix,f=a.stroke,g=a.linewidth,j=a.fill,k=a.opacity,e=a.visible,m=a.cap,l=a.join,p=a.miter,r=a.curved,G=a.closed;
a=a.vertices;c&&(b.id=c);_.isObject(d)&&(b.matrix=b._matrix=d.toArray(!0));f&&(b.stroke=q.interpret(f));j&&(b.fill=q.interpret(j));_.isNumber(k)&&(b.opacity=k);m&&(b.cap=m);l&&(b.join=l);p&&(b.miter=p);g&&(b.linewidth=g);a&&(a=q.toArray(a,r,G),c=q.tessellate(a,r,G),b.triangles=c.triangles,b.vertices=c.vertices,b.vertexAmount=c.vertexAmount,b.triangleAmount=c.triangleAmount);b.visible=!!e;b.curved=!!r;b.closed=!!G;return b},setStyles:function(a,b,c){switch(b){case "matrix":b="matrix";c=c.toArray(!0);
break;case "stroke":c=q.interpret(c);break;case "fill":c=q.interpret(c);break;case "vertices":b="triangles";c=q.toArray(c,a.curved,a.closed);var d=q.tessellate(c,a.curved,a.closed,a.triangles,a.vertices);c=d.triangles;a.vertices=d.vertices;a.vertexAmount=d.vertexAmount;a.triangleAmount=d.triangleAmount}a[b]=c;"triangles"===b&&q.updateBuffer(this.ctx,a,this.positionLocation);"matrix"===b&&a.updateMatrix()}});_.extend(g.prototype,Backbone.Events,l.prototype,{setSize:function(a,b){l.prototype.setSize.apply(this,
arguments);this.ctx.viewport(0,0,a,b);var c=this.ctx.getUniformLocation(this.program,"resolution");this.ctx.uniform2f(c,a,b);return this},render:function(){if(_.isNull(this.stage))return this;var a=this.ctx;a.clear(a.COLOR_BUFFER_BIT);this.stage.render(a,this.positionLocation,this.matrixLocation,this.colorLocation);return this}})})();(function(){var l=Two.Shape=function(a){this._matrix=new Two.Matrix;var b=_.debounce(_.bind(function(){var a=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",a)},this),0);this._rotation="rotation";Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(a){this._rotation=a;b()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(a){this._scale=a;b()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,b);if(a)return this;l.MakeGetterSetter(this,l.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.miter=this.join=this.cap="round"};_.extend(l,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]);_.each(b,function(b){var d="_"+b;Object.defineProperty(a,
b,{get:function(){return this[d]},set:function(a){this[d]=a;this.trigger(Two.Events.change,this.id,b,a,this)}})})}});_.extend(l.prototype,Backbone.Events,{addTo:function(a){a.add(this);return this},noFill:function(){this.fill="none";return this},noStroke:function(){this.stroke="none";return this},clone:function(){var a=new l;a.translation.copy(this.translation);_.each(l.Properties,function(b){a[b]=this[b]},this);return this}})})();(function(){var l=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;l.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(l,{MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]);_.each(b,function(b){var d="_"+b;Object.defineProperty(a,b,{get:function(){return this[d]},set:function(a){this[d]=a;_.each(this.children,function(d){d[b]=a})}})})}});_.extend(l.prototype,
Two.Shape.prototype,{add:function(a){var b=a,c=this.children,d=this.parent,g=[];_.isArray(a)||(b=_.toArray(arguments));var j=_.bind(function(a,b,c,d,g){this.trigger(Two.Events.change,a,b,c,d,g)},this);_.each(b,function(a){var b=a.id,l=a.parent;_.isUndefined(b)&&(d.add(a),b=a.id);_.isUndefined(c[b])&&(l&&delete l.children[b],c[b]=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,j),g.push(b))},this);0<g.length&&this.trigger(Two.Events.change,this.id,"hierarchy",g);return this},getBoundingClientRect:function(){var a=
Infinity,b=-Infinity,c=Infinity,d=-Infinity;_.each(this.children,function(f){f=f.getBoundingClientRect();c=Math.min(f.top,c);a=Math.min(f.left,a);b=Math.max(f.right,b);d=Math.max(f.bottom,d)},this);var g=this._matrix.multiply(a,c,1),j=this._matrix.multiply(b,d,1);return{top:g.y,left:g.x,right:j.x,bottom:j.y,width:j.x-g.x,height:j.y-g.y}},noFill:function(){_.each(this.children,function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this}})})();(function(){var l=Math.min,a=Math.max,b=Math.round,c=Two.Polygon=function(c,g,j){Two.Shape.call(this);g=!!g;j=!!j;var f=0,k=1,m=!1,p=c.slice(0),r=_.debounce(_.bind(function(){var a,c;if(m){a=this.vertices.length;a-=1;c=b(f*a);a=b(k*a);for(p.length=0;c<a+1;c++){var d=this.vertices[c];p.push(new Two.Vector(d.x,d.y))}m=!1}this.trigger(Two.Events.change,this.id,"vertices",p,this.closed,this.curved)},this),0);Object.defineProperty(this,"closed",{get:function(){return g},set:function(a){g=!!a;r()}});Object.defineProperty(this,
"curved",{get:function(){return j},set:function(a){j=!!a;r()}});Object.defineProperty(this,"beginning",{get:function(){return f},set:function(b){f=l(a(b,0),1);m=!0;r()}});Object.defineProperty(this,"ending",{get:function(){return k},set:function(b){k=l(a(b,0),1);m=!0;r()}});this.vertices=c.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,r)},this);r()};_.extend(c,{});_.extend(c.prototype,Two.Shape.prototype,{clone:function(){var a=_.map(this.vertices,function(a){return new Two.Vector(a.x,
a.y)}),b=new c(a,this.closed,this.curved);_.each(Two.Shape.Properties,function(a){b[a]=this[a]},this);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},getBoundingClientRect:function(){var a=this.linewidth,b=Infinity,c=-Infinity,f=Infinity,k=-Infinity;_.each(this.vertices,function(a){var d=a.x;a=a.y;f=Math.min(a,f);b=Math.min(d,b);c=Math.max(d,c);k=Math.max(a,k)});var f=f-a,b=b-a,c=c+a,k=k+a,a=this._matrix.multiply(b,f,1),l=this._matrix.multiply(c,k,1);return{top:a.y,
left:a.x,right:l.x,bottom:l.y,width:l.x-a.x,height:l.y-a.y}}})})();
