(function(){function r(m,a,c){if(m===a)return 0!==m||1/m==1/a;if(null==m||null==a)return m===a;m._chain&&(m=m._wrapped);a._chain&&(a=a._wrapped);if(m.isEqual&&d.isFunction(m.isEqual))return m.isEqual(a);if(a.isEqual&&d.isFunction(a.isEqual))return a.isEqual(m);var j=n.call(m);if(j!=n.call(a))return!1;switch(j){case "[object String]":return m==String(a);case "[object Number]":return m!=+m?a!=+a:0==m?1/m==1/a:m==+a;case "[object Date]":case "[object Boolean]":return+m==+a;case "[object RegExp]":return m.source==
a.source&&m.global==a.global&&m.multiline==a.multiline&&m.ignoreCase==a.ignoreCase}if("object"!=typeof m||"object"!=typeof a)return!1;for(var b=c.length;b--;)if(c[b]==m)return!0;c.push(m);var b=0,f=!0;if("[object Array]"==j){if(b=m.length,f=b==a.length)for(;b--&&(f=b in m==b in a&&r(m[b],a[b],c)););}else{if("constructor"in m!="constructor"in a||m.constructor!=a.constructor)return!1;for(var s in m)if(d.has(m,s)&&(b++,!(f=d.has(a,s)&&r(m[s],a[s],c))))break;if(f){for(s in a)if(d.has(a,s)&&!b--)break;
f=!b}}c.pop();return f}var e=this,k=e._,q={},l=Array.prototype,b=Object.prototype,c=l.slice,f=l.unshift,n=b.toString,a=b.hasOwnProperty,p=l.forEach,x=l.map,t=l.reduce,j=l.reduceRight,z=l.filter,C=l.every,A=l.some,u=l.indexOf,w=l.lastIndexOf,b=Array.isArray,s=Object.keys,v=Function.prototype.bind,d=function(m){return new I(m)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports._=d):e._=d;d.VERSION="1.3.3";var y=d.each=d.forEach=function(m,
a,c){if(null!=m)if(p&&m.forEach===p)m.forEach(a,c);else if(m.length===+m.length)for(var b=0,j=m.length;b<j&&!(b in m&&a.call(c,m[b],b,m)===q);b++);else for(b in m)if(d.has(m,b)&&a.call(c,m[b],b,m)===q)break};d.map=d.collect=function(m,a,d){var c=[];if(null==m)return c;if(x&&m.map===x)return m.map(a,d);y(m,function(m,b,j){c[c.length]=a.call(d,m,b,j)});m.length===+m.length&&(c.length=m.length);return c};d.reduce=d.foldl=d.inject=function(m,a,c,b){var j=2<arguments.length;null==m&&(m=[]);if(t&&m.reduce===
t)return b&&(a=d.bind(a,b)),j?m.reduce(a,c):m.reduce(a);y(m,function(m,d,f){j?c=a.call(b,c,m,d,f):(c=m,j=!0)});if(!j)throw new TypeError("Reduce of empty array with no initial value");return c};d.reduceRight=d.foldr=function(m,a,c,b){var f=2<arguments.length;null==m&&(m=[]);if(j&&m.reduceRight===j)return b&&(a=d.bind(a,b)),f?m.reduceRight(a,c):m.reduceRight(a);var s=d.toArray(m).reverse();b&&!f&&(a=d.bind(a,b));return f?d.reduce(s,a,c,b):d.reduce(s,a)};d.find=d.detect=function(a,d,c){var b;B(a,function(a,
m,j){if(d.call(c,a,m,j))return b=a,!0});return b};d.filter=d.select=function(a,d,c){var b=[];if(null==a)return b;if(z&&a.filter===z)return a.filter(d,c);y(a,function(a,m,j){d.call(c,a,m,j)&&(b[b.length]=a)});return b};d.reject=function(a,d,c){var b=[];if(null==a)return b;y(a,function(a,m,j){d.call(c,a,m,j)||(b[b.length]=a)});return b};d.every=d.all=function(a,d,c){var b=!0;if(null==a)return b;if(C&&a.every===C)return a.every(d,c);y(a,function(a,m,j){if(!(b=b&&d.call(c,a,m,j)))return q});return!!b};
var B=d.some=d.any=function(a,c,b){c||(c=d.identity);var j=!1;if(null==a)return j;if(A&&a.some===A)return a.some(c,b);y(a,function(a,m,d){if(j||(j=c.call(b,a,m,d)))return q});return!!j};d.include=d.contains=function(a,d){var c=!1;return null==a?c:u&&a.indexOf===u?-1!=a.indexOf(d):c=B(a,function(a){return a===d})};d.invoke=function(a,b){var j=c.call(arguments,2);return d.map(a,function(a){return(d.isFunction(b)?b||a:a[b]).apply(a,j)})};d.pluck=function(a,c){return d.map(a,function(a){return a[c]})};
d.max=function(a,c,b){if(!c&&d.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!c&&d.isEmpty(a))return-Infinity;var j={computed:-Infinity};y(a,function(a,d,m){d=c?c.call(b,a,d,m):a;d>=j.computed&&(j={value:a,computed:d})});return j.value};d.min=function(a,c,b){if(!c&&d.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!c&&d.isEmpty(a))return Infinity;var j={computed:Infinity};y(a,function(a,d,m){d=c?c.call(b,a,d,m):a;d<j.computed&&(j={value:a,computed:d})});return j.value};d.shuffle=
function(a){var d=[],c;y(a,function(a,m){c=Math.floor(Math.random()*(m+1));d[m]=d[c];d[c]=a});return d};d.sortBy=function(a,c,b){var j=d.isFunction(c)?c:function(a){return a[c]};return d.pluck(d.map(a,function(a,d,m){return{value:a,criteria:j.call(b,a,d,m)}}).sort(function(a,d){var m=a.criteria,c=d.criteria;return void 0===m?1:void 0===c?-1:m<c?-1:m>c?1:0}),"value")};d.groupBy=function(a,c){var b={},j=d.isFunction(c)?c:function(a){return a[c]};y(a,function(a,d){var m=j(a,d);(b[m]||(b[m]=[])).push(a)});
return b};d.sortedIndex=function(a,c,b){b||(b=d.identity);for(var j=0,f=a.length;j<f;){var s=j+f>>1;b(a[s])<b(c)?j=s+1:f=s}return j};d.toArray=function(a){return!a?[]:d.isArray(a)||d.isArguments(a)?c.call(a):a.toArray&&d.isFunction(a.toArray)?a.toArray():d.values(a)};d.size=function(a){return d.isArray(a)?a.length:d.keys(a).length};d.first=d.head=d.take=function(a,d,b){return null!=d&&!b?c.call(a,0,d):a[0]};d.initial=function(a,d,b){return c.call(a,0,a.length-(null==d||b?1:d))};d.last=function(a,
d,b){return null!=d&&!b?c.call(a,Math.max(a.length-d,0)):a[a.length-1]};d.rest=d.tail=function(a,d,b){return c.call(a,null==d||b?1:d)};d.compact=function(a){return d.filter(a,function(a){return!!a})};d.flatten=function(a,c){return d.reduce(a,function(a,m){if(d.isArray(m))return a.concat(c?m:d.flatten(m));a[a.length]=m;return a},[])};d.without=function(a){return d.difference(a,c.call(arguments,1))};d.uniq=d.unique=function(a,c,b){b=b?d.map(a,b):a;var j=[];3>a.length&&(c=!0);d.reduce(b,function(b,f,
s){if(c?d.last(b)!==f||!b.length:!d.include(b,f))b.push(f),j.push(a[s]);return b},[]);return j};d.union=function(){return d.uniq(d.flatten(arguments,!0))};d.intersection=d.intersect=function(a){var b=c.call(arguments,1);return d.filter(d.uniq(a),function(a){return d.every(b,function(m){return 0<=d.indexOf(m,a)})})};d.difference=function(a){var b=d.flatten(c.call(arguments,1),!0);return d.filter(a,function(a){return!d.include(b,a)})};d.zip=function(){for(var a=c.call(arguments),b=d.max(d.pluck(a,"length")),
j=Array(b),f=0;f<b;f++)j[f]=d.pluck(a,""+f);return j};d.indexOf=function(a,c,b){if(null==a)return-1;var j;if(b)return b=d.sortedIndex(a,c),a[b]===c?b:-1;if(u&&a.indexOf===u)return a.indexOf(c);b=0;for(j=a.length;b<j;b++)if(b in a&&a[b]===c)return b;return-1};d.lastIndexOf=function(a,d){if(null==a)return-1;if(w&&a.lastIndexOf===w)return a.lastIndexOf(d);for(var b=a.length;b--;)if(b in a&&a[b]===d)return b;return-1};d.range=function(a,d,b){1>=arguments.length&&(d=a||0,a=0);b=arguments[2]||1;for(var c=
Math.max(Math.ceil((d-a)/b),0),j=0,f=Array(c);j<c;)f[j++]=a,a+=b;return f};var M=function(){};d.bind=function(a,b){var j,f;if(a.bind===v&&v)return v.apply(a,c.call(arguments,1));if(!d.isFunction(a))throw new TypeError;f=c.call(arguments,2);return j=function(){if(!(this instanceof j))return a.apply(b,f.concat(c.call(arguments)));M.prototype=a.prototype;var d=new M,s=a.apply(d,f.concat(c.call(arguments)));return Object(s)===s?s:d}};d.bindAll=function(a){var b=c.call(arguments,1);0==b.length&&(b=d.functions(a));
y(b,function(b){a[b]=d.bind(a[b],a)});return a};d.memoize=function(a,b){var c={};b||(b=d.identity);return function(){var j=b.apply(this,arguments);return d.has(c,j)?c[j]:c[j]=a.apply(this,arguments)}};d.delay=function(a,d){var b=c.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},d)};d.defer=function(a){return d.delay.apply(d,[a,1].concat(c.call(arguments,1)))};d.throttle=function(a,b){var c,j,f,s,p,v,n=d.debounce(function(){p=s=!1},b);return function(){c=this;j=arguments;f||
(f=setTimeout(function(){f=null;p&&a.apply(c,j);n()},b));s?p=!0:v=a.apply(c,j);n();s=!0;return v}};d.debounce=function(a,d,b){var c;return function(){var j=this,f=arguments;b&&!c&&a.apply(j,f);clearTimeout(c);c=setTimeout(function(){c=null;b||a.apply(j,f)},d)}};d.once=function(a){var d=!1,b;return function(){if(d)return b;d=!0;return b=a.apply(this,arguments)}};d.wrap=function(a,d){return function(){var b=[a].concat(c.call(arguments,0));return d.apply(this,b)}};d.compose=function(){var a=arguments;
return function(){for(var d=arguments,b=a.length-1;0<=b;b--)d=[a[b].apply(this,d)];return d[0]}};d.after=function(a,d){return 0>=a?d():function(){if(1>--a)return d.apply(this,arguments)}};d.keys=s||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)d.has(a,c)&&(b[b.length]=c);return b};d.values=function(a){return d.map(a,d.identity)};d.functions=d.methods=function(a){var b=[],c;for(c in a)d.isFunction(a[c])&&b.push(c);return b.sort()};d.extend=function(a){y(c.call(arguments,
1),function(d){for(var b in d)a[b]=d[b]});return a};d.pick=function(a){var b={};y(d.flatten(c.call(arguments,1)),function(d){d in a&&(b[d]=a[d])});return b};d.defaults=function(a){y(c.call(arguments,1),function(d){for(var b in d)null==a[b]&&(a[b]=d[b])});return a};d.clone=function(a){return!d.isObject(a)?a:d.isArray(a)?a.slice():d.extend({},a)};d.tap=function(a,d){d(a);return a};d.isEqual=function(a,d){return r(a,d,[])};d.isEmpty=function(a){if(null==a)return!0;if(d.isArray(a)||d.isString(a))return 0===
a.length;for(var b in a)if(d.has(a,b))return!1;return!0};d.isElement=function(a){return!!(a&&1==a.nodeType)};d.isArray=b||function(a){return"[object Array]"==n.call(a)};d.isObject=function(a){return a===Object(a)};d.isArguments=function(a){return"[object Arguments]"==n.call(a)};d.isArguments(arguments)||(d.isArguments=function(a){return!(!a||!d.has(a,"callee"))});d.isFunction=function(a){return"[object Function]"==n.call(a)};d.isString=function(a){return"[object String]"==n.call(a)};d.isNumber=function(a){return"[object Number]"==
n.call(a)};d.isFinite=function(a){return d.isNumber(a)&&isFinite(a)};d.isNaN=function(a){return a!==a};d.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==n.call(a)};d.isDate=function(a){return"[object Date]"==n.call(a)};d.isRegExp=function(a){return"[object RegExp]"==n.call(a)};d.isNull=function(a){return null===a};d.isUndefined=function(a){return void 0===a};d.has=function(d,b){return a.call(d,b)};d.noConflict=function(){e._=k;return this};d.identity=function(a){return a};d.times=
function(a,d,b){for(var c=0;c<a;c++)d.call(b,c)};d.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.result=function(a,b){if(null==a)return null;var c=a[b];return d.isFunction(c)?c.call(a):c};d.mixin=function(a){y(d.functions(a),function(b){var j=d[b]=a[b];I.prototype[b]=function(){var a=c.call(arguments);f.call(a,this._wrapped);return O(j.apply(d,a),this._chain)}})};var H=0;d.uniqueId=
function(a){var d=H++;return a?a+d:d};d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/.^/,N={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},P;for(P in N)N[N[P]]=P;var V=/\\|'|\r|\n|\t|\u2028|\u2029/g,W=/\\(\\|'|r|n|t|u2028|u2029)/g,Q=function(a){return a.replace(W,function(a,d){return N[d]})};d.template=function(a,b,c){c=d.defaults(c||{},d.templateSettings);a="__p+='"+a.replace(V,function(a){return"\\"+N[a]}).replace(c.escape||
E,function(a,d){return"'+\n_.escape("+Q(d)+")+\n'"}).replace(c.interpolate||E,function(a,d){return"'+\n("+Q(d)+")+\n'"}).replace(c.evaluate||E,function(a,d){return"';\n"+Q(d)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var j=new Function(c.variable||"obj","_",a);if(b)return j(b,d);b=function(a){return j.call(this,a,d)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};
d.chain=function(a){return d(a).chain()};var I=function(a){this._wrapped=a};d.prototype=I.prototype;var O=function(a,b){return b?d(a).chain():a};d.mixin(d);y("pop push reverse shift sort splice unshift".split(" "),function(a){var d=l[a];I.prototype[a]=function(){var b=this._wrapped;d.apply(b,arguments);var c=b.length;("shift"==a||"splice"==a)&&0===c&&delete b[0];return O(b,this._chain)}});y(["concat","join","slice"],function(a){var d=l[a];I.prototype[a]=function(){return O(d.apply(this._wrapped,arguments),
this._chain)}});I.prototype.chain=function(){this._chain=!0;return this};I.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var r=[].slice,e=/\s+/,k=function(b,c,f,n){if(!f)return!0;if("object"===typeof f)for(var a in f)b[c].apply(b,[a,f[a]].concat(n));else if(e.test(f)){f=f.split(e);a=0;for(var p=f.length;a<p;a++)b[c].apply(b,[f[a]].concat(n))}else return!0},q=function(b,c,f){var n;b=-1;var a=c.length;switch(f.length){case 0:for(;++b<a;)(n=c[b]).callback.call(n.ctx);break;case 1:for(;++b<a;)(n=c[b]).callback.call(n.ctx,f[0]);break;case 2:for(;++b<a;)(n=c[b]).callback.call(n.ctx,f[0],f[1]);break;case 3:for(;++b<
a;)(n=c[b]).callback.call(n.ctx,f[0],f[1],f[2]);break;default:for(;++b<a;)(n=c[b]).callback.apply(n.ctx,f)}},l=Backbone.Events={on:function(b,c,f){if(!k(this,"on",b,[c,f])||!c)return this;this._events||(this._events={});(this._events[b]||(this._events[b]=[])).push({callback:c,context:f,ctx:f||this});return this},once:function(b,c,f){if(!k(this,"once",b,[c,f])||!c)return this;var n=this,a=_.once(function(){n.off(b,a);c.apply(this,arguments)});a._callback=c;this.on(b,a,f);return this},off:function(b,
c,f){var n,a,p,l,e,j,q,C;if(!this._events||!k(this,"off",b,[c,f]))return this;if(!b&&!c&&!f)return this._events={},this;l=b?[b]:_.keys(this._events);e=0;for(j=l.length;e<j;e++)if(b=l[e],n=this._events[b]){p=[];if(c||f){q=0;for(C=n.length;q<C;q++)a=n[q],(c&&c!==(a.callback._callback||a.callback)||f&&f!==a.context)&&p.push(a)}this._events[b]=p}return this},trigger:function(b){if(!this._events)return this;var c=r.call(arguments,1);if(!k(this,"trigger",b,c))return this;var f=this._events[b],n=this._events.all;
f&&q(this,f,c);n&&q(this,n,arguments);return this},listenTo:function(b,c,f){var n=this._listeners||(this._listeners={}),a=b._listenerId||(b._listenerId=_.uniqueId("l"));n[a]=b;b.on(c,f||this,this);return this},stopListening:function(b,c,f){var n=this._listeners;if(n){if(b)b.off(c,f,this),!c&&!f&&delete n[b._listenerId];else{for(var a in n)n[a].off(null,null,this);this._listeners={}}return this}}};l.bind=l.on;l.unbind=l.off})();(function(){for(var r=0,e=["ms","moz","webkit","o"],k=0;k<e.length&&!window.requestAnimationFrame;++k)window.requestAnimationFrame=window[e[k]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[k]+"CancelAnimationFrame"]||window[e[k]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var l=(new Date).getTime(),b=Math.max(0,16-(l-r)),c=window.setTimeout(function(){e(l+b)},b);r=l+b;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(e){clearTimeout(e)})})();(function(){function r(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(j.Events.resize,b,a)}var e=this,k=e.Two||{},q=Math.sin,l=Math.cos,b=Math.atan2,c=Math.sqrt,f=Math.abs,n=Math.PI,a=2*n,p=n/2,x=Math.pow,t={hasEventListeners:_.isFunction(e.addEventListener),bind:function(a,b,d,c){this.hasEventListeners?a.addEventListener(b,d,!!c):a.attachEvent("on"+b,d);return this},unbind:function(a,b,d,c){this.hasEventListeners?
a.removeEventListeners(b,d,!!c):a.detachEvent("on"+b,d);return this}},j=e.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:j.Types.svg,autostart:!1});this.type=a.type;this.renderer=new j[this.type](this);j.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(r,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,
left:0,right:0,bottom:0,position:"fixed"}),t.bind(window,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);this.scene=new j.Group;this.renderer.add(this.scene);j.Instances.push(this)};_.extend(j,{Array:e.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,
Instances:[],noConflict:function(){e.Two=k;return this},Utils:{Curve:{CollinearityEpsilon:x(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},setPlaying:function(a){_.defer(_.bind(function(){this.playing=!!a},this))},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";_.each(a.attributes,function(a){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;
break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});return b},read:{svg:function(){return j.Utils.read.g.apply(this,arguments)},g:function(a){var b=new j.Group;this.add(b);_.each(a.childNodes,function(a){if(a.localName){var c=a.localName.toLowerCase();c in j.Utils.read&&(a=j.Utils.read[c].call(this,
a),b.add(a))}},this);return j.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var d=a.points,c=_.map(_.range(d.numberOfItems),function(a){a=d.getItem(a);return new j.Vector(a.x,a.y)}),c=(new j.Polygon(c,!b)).noStroke();return j.Utils.applySvgAttributes(a,c)},polyline:function(a){return j.Utils.read.polygon(a,!0)},path:function(a){var b=a.getAttribute("d"),b=_.flatten(_.map(_.compact(b.split(/M/g)),function(a){a=_.map(_.compact(a.split(/m/g)),function(a,d){return 0>=d?a:"m"+a});a[0]="M"+a[0];
return a})),d=new j.Vector,c=new j.Vector;return _.map(b,function(b){var f,p=!1,n=!1;b=_.flatten(_.map(b.match(/[a-z][^a-z]*/ig),function(a){var b,s,l=a[0],e=l.toLowerCase();f=a.slice(1).trim().split(/[\s,]+|(?=[+\-])/);p=l===e;var v,t,m;switch(e){case "z":n=!0;break;case "m":case "l":s=parseFloat(f[0]);b=parseFloat(f[1]);b=new j.Vector(s,b);p&&b.addSelf(d);d.copy(b);break;case "h":case "v":s="h"===e?"x":"y";a="x"===s?"y":"x";b=new j.Vector;b[s]=parseFloat(f[0]);b[a]=d[a];p&&(b[s]+=d[s]);d.copy(b);
break;case "s":case "c":b=d.x;a=d.y;"c"===e?(l=parseFloat(f[0]),s=parseFloat(f[1]),e=parseFloat(f[2]),v=parseFloat(f[3]),t=parseFloat(f[4]),m=parseFloat(f[5])):(v=(new j.Vector).copy(d).subSelf(c),l=parseFloat(v.x),s=parseFloat(v.y),e=parseFloat(f[0]),v=parseFloat(f[1]),t=parseFloat(f[2]),m=parseFloat(f[3]));p&&(l+=b,s+=a,e+=b,v+=a,t+=b,m+=a);b=j.Utils.subdivide(b,a,l,s,e,v,t,m);d.set(t,m);c.set(e,v);break;case "t":case "q":b=d.x;a=d.y;c.isZero()?(l=b,s=a):(l=c.x,a=c.y);"q"===e?(e=parseFloat(f[0]),
v=parseFloat(f[1]),t=parseFloat(f[1]),m=parseFloat(f[2])):(v=(new j.Vector).copy(d).subSelf(c),e=parseFloat(v.x),v=parseFloat(v.y),t=parseFloat(f[0]),m=parseFloat(f[1]));p&&(l+=b,s+=a,e+=b,v+=a,t+=b,m+=a);b=j.Utils.subdivide(b,a,l,s,e,v,t,m);d.set(t,m);c.set(e,v);break;case "a":throw new j.Utils.Error("not yet able to interpret Elliptical Arcs.");}return b}));_.isUndefined(b[b.length-1])&&b.pop();b=(new j.Polygon(b,n)).noStroke();return j.Utils.applySvgAttributes(a,b)})},circle:function(b){var c=
parseFloat(b.getAttribute("cx")),d=parseFloat(b.getAttribute("cy")),f=parseFloat(b.getAttribute("r")),p=j.Resolution,e=_.map(_.range(p),function(b){var d=b/p*a;b=f*l(d);d=f*q(d);return new j.Vector(b,d)},this),e=(new j.Polygon(e,!0,!0)).noStroke();e.translation.set(c,d);return j.Utils.applySvgAttributes(b,e)},ellipse:function(b){var c=parseFloat(b.getAttribute("cx")),d=parseFloat(b.getAttribute("cy")),f=parseFloat(b.getAttribute("rx")),p=parseFloat(b.getAttribute("ry")),e=j.Resolution,n=_.map(_.range(e),
function(b){var d=b/e*a;b=f*l(d);d=p*q(d);return new j.Vector(b,d)},this),n=(new j.Polygon(n,!0,!0)).noStroke();n.translation.set(c,d);return j.Utils.applySvgAttributes(b,n)},rect:function(a){var b=parseFloat(a.getAttribute("x")),d=parseFloat(a.getAttribute("y")),c=parseFloat(a.getAttribute("width")),f=parseFloat(a.getAttribute("height")),c=c/2,f=f/2,p=[new j.Vector(c,f),new j.Vector(-c,f),new j.Vector(-c,-f),new j.Vector(c,-f)],p=(new j.Polygon(p,!0)).noStroke();p.translation.set(b+c,d+f);return j.Utils.applySvgAttributes(a,
p)},line:function(a){var b=parseFloat(a.getAttribute("x1")),d=parseFloat(a.getAttribute("y1")),c=parseFloat(a.getAttribute("x2")),f=parseFloat(a.getAttribute("y2")),c=(c-b)/2,f=(f-d)/2,p=[new j.Vector(-c,-f),new j.Vector(c,f)],p=(new j.Polygon(p)).noFill();p.translation.set(b+c,d+f);return j.Utils.applySvgAttributes(a,p)}},subdivide:function(c,p,d,e,l,t,x,k,q){var z=j.Utils.Curve.CollinearityEpsilon,C=j.Utils.Curve.RecursionLimit,A=j.Utils.Curve.CuspLimit,r=j.Utils.Curve.Tolerance,u;q=q||0;if(q>C)return[];
var C=(c+d)/2,w=(p+e)/2,m=(d+l)/2,L=(e+t)/2,R=(l+x)/2,S=(t+k)/2,T=(C+m)/2,U=(w+L)/2,m=(m+R)/2,L=(L+S)/2,F=(T+m)/2,G=(U+L)/2;u=x-c;var D=k-p,J=f((d-x)*D-(e-k)*u),K=f((l-x)*D-(t-k)*u);if(0<q){if(J>z&&K>z&&(J+K)*(J+K)<=r.distance*(u*u+D*D)){if(r.angle<r.epsilon)return[new j.Vector(F,G)];u=b(t-e,l-d);z=f(u-b(e-p,d-c));u=f(b(k-t,x-l)-u);z>=n&&(z=a-z);u>=n&&(u=a-u);if(z+u<r.angle)return[new j.Vector(F,G)];if(0!==A){if(z>A)return[new j.Vector(d,e)];if(u>A)return[new j.Vector(l,t)]}}}else if(J>z)if(J*J<=
r.distance*(u*u+D*D)){if(r.angle<r.epsilon)return[new j.Vector(F,G)];z=f(b(t-e,l-d)-b(e-p,d-c));z>=n&&(z=a-z);if(z<r.angle)return[new j.Vector(d,e),new j.Vector(l,t)];if(0!==A&&z>A)return[new j.Vector(d,e)]}else if(K>z){if(K*K<=r.distance*(u*u+D*D)){if(r.angle<r.epsilon)return[new j.Vector(F,G)];z=f(b(k-t,x-l)-b(t-e,l-d));z>=n&&(z=a-z);if(z<r.angle)return[new j.Vector(d,e),new j.Vector(l,t)];if(0!==A&&z>A)return[new j.Vector2(l,t)]}}else if(u=F-(c+x)/2,D=G-(p+k)/2,u*u+D*D<=r.distance)return[new j.Vector(F,
G)];return j.Utils.subdivide(c,p,C,w,T,U,F,G,q+1).concat(j.Utils.subdivide(F,G,m,L,R,S,x,k,q+1))},getCurveFromPoints:function(a,b){for(var d=[],c=a.length,j=c-1,f=0;f<c;f++){var p=a[f],e={x:p.x,y:p.y};d.push(e);var p=b?w(f-1,c):Math.max(f-1,0),l=b?w(f+1,c):Math.min(f+1,j);u(a[p],e,a[l]);!e.u.x&&!e.u.y&&(e.u.x=e.x,e.u.y=e.y);!e.v.x&&!e.v.y&&(e.v.x=e.x,e.v.y=e.y)}return d},getControlPoints:function(a,b,d){var c=A(a,b),f=A(d,b);a=z(a,b);d=z(d,b);var j=(c+f)/2;if(1E-4>a||1E-4>d)return b.u={x:b.x,y:b.y},
b.v={x:b.x,y:b.y},b;a*=0.33;d*=0.33;j=f<c?j+p:j-p;c={x:b.x+l(j)*a,y:b.y+q(j)*a};j-=n;f={x:b.x+l(j)*d,y:b.y+q(j)*d};b.u=c;b.v=f;return b},angleBetween:function(a,c){return b(a.y-c.y,a.x-c.x)},distanceBetweenSquared:function(a,b){var d=a.x-b.x,c=a.y-b.y;return d*d+c*c},distanceBetween:function(a,b){return c(C(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Error:function(a){this.name="two.js";this.message=a}}});j.Utils.Error.prototype=Error();j.Utils.Error.prototype.constructor=j.Utils.Error;var z=
j.Utils.distanceBetween,C=j.Utils.distanceBetweenSquared,A=j.Utils.angleBetween,u=j.Utils.getControlPoints,w=j.Utils.mod;_.extend(j.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){j.Utils.setPlaying.call(this,!0);return this.trigger(j.Events.play)},pause:function(){this.playing=!1;return this.trigger(j.Events.pause)},update:function(){var a=!!this._lastFrame,b=(window.performance&&window.performance.now?window.performance:Date).now();
this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,d=this.renderer;(a!==d.width||b!==d.height)&&d.setSize(a,b);this.trigger(j.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(j.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||
(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){_.each(this.scene.children,function(a){a.remove()});return this},makeLine:function(a,b,d,c){d=(d-a)/2;c=(c-b)/2;var f=[new j.Vector(-d,-c),new j.Vector(d,c)],f=(new j.Polygon(f)).noFill();f.translation.set(a+d,b+c);this.scene.add(f);return f},makeRectangle:function(a,b,d,c){d/=2;c/=2;c=[new j.Vector(d,c),new j.Vector(-d,c),new j.Vector(-d,-c),new j.Vector(d,-c)];c=new j.Polygon(c,!0);c.translation.set(a,b);this.scene.add(c);
return c},makeCircle:function(a,b,d){return this.makeEllipse(a,b,d,d)},makeEllipse:function(b,c,d,f){var p=j.Resolution,e=_.map(_.range(p),function(b){var c=b/p*a;b=d*l(c);c=f*q(c);return new j.Vector(b,c)},this),e=new j.Polygon(e,!0,!0);e.translation.set(b,c);this.scene.add(e);return e},makeCurve:function(a){var b=arguments.length,d=a;if(!_.isArray(a))for(var d=[],c=0;c<b;c+=2){var f=arguments[c];if(!_.isNumber(f))break;d.push(new j.Vector(f,arguments[c+1]))}var b=arguments[b-1],d=new j.Polygon(d,
!(_.isBoolean(b)&&b),!0),b=d.getBoundingClientRect(),p=b.left+b.width/2,e=b.top+b.height/2;_.each(d.vertices,function(a){a.x-=p;a.y-=e});d.translation.set(p,e);this.scene.add(d);return d},makePolygon:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],f=0;f<b;f+=2){var p=arguments[f];if(!_.isNumber(p))break;c.push(new j.Vector(p,arguments[f+1]))}b=arguments[b-1];c=new j.Polygon(c,!(_.isBoolean(b)&&b));c.center();this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||
(b=_.toArray(arguments));var c=new j.Group;this.scene.add(c);c.add(b);return c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in j.Utils.read))return null;a=j.Utils.read[b].call(this,a);this.add(a);return a}});(function(){_.each(j.Instances,function(a){a.playing&&a.update()});requestAnimationFrame(arguments.callee)})()})();(function(){var r=Two.Vector=function(e,k){e=e||0;k=k||0;Object.defineProperty(this,"x",{get:function(){return e},set:function(k){e=k;this.trigger(Two.Events.change,"x")}});Object.defineProperty(this,"y",{get:function(){return k},set:function(e){k=e;this.trigger(Two.Events.change,"y")}})};_.extend(r,{});_.extend(r.prototype,Backbone.Events,{set:function(e,k){this.x=e;this.y=k;return this},copy:function(e){this.x=e.x;this.y=e.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new r(this.x,
this.y)},add:function(e,k){this.x=e.x+k.x;this.y=e.y+k.y;return this},addSelf:function(e){this.x+=e.x;this.y+=e.y;return this},sub:function(e,k){this.x=e.x-k.x;this.y=e.y-k.y;return this},subSelf:function(e){this.x-=e.x;this.y-=e.y;return this},multiplySelf:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){e?(this.x/=e,this.y/=e):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*
e.x+this.y*e.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var k=this.x-e.x;e=this.y-e.y;return k*k+e*e},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,k){return this.set((e.x-this.x)*
k+this.x,(e.y-this.y)*k+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var r=Math.cos,e=Math.sin,k=Math.tan,q=Two.Matrix=function(e,b,c,f,n,a){this.elements=new Two.Array(9);var p=e;_.isArray(p)||(p=_.toArray(arguments));this.identity().set(p)};_.extend(q,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(e,b){if(3>=b.length){var c=b[0]||0,f=b[1]||0,n=b[2]||0;return{x:e[0]*c+e[1]*f+e[2]*n,y:e[3]*c+e[4]*f+e[5]*n,z:e[6]*c+e[7]*f+e[8]*n}}var c=e[0],f=e[1],n=e[2],a=e[3],p=e[4],x=e[5],t=e[6],j=e[7],k=e[8],q=b[0],r=b[1],u=b[2],w=b[3],s=b[4],v=b[5],d=b[6],
y=b[7],B=b[8];return[c*q+f*w+n*d,c*r+f*s+n*y,c*u+f*v+n*B,a*q+p*w+x*d,a*r+p*s+x*y,a*u+p*v+x*B,t*q+j*w+k*d,t*r+j*s+k*y,t*u+j*v+k*B]}});_.extend(q.prototype,Backbone.Events,{set:function(e,b,c,f,n,a){var p=e;_.isArray(p)||(p=_.toArray(arguments));_.each(p,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(q.Identity);return this},multiply:function(e,b,c,f,n,a,p,x,t){var j=arguments,k=j.length;if(1>=k)return _.each(this.elements,
function(a,b){this.elements[b]=a*e},this),this.trigger(Two.Events.change);if(3>=k)return e=e||0,b=b||0,c=c||0,n=this.elements,{x:n[0]*e+n[1]*b+n[2]*c,y:n[3]*e+n[4]*b+n[5]*c,z:n[6]*e+n[7]*b+n[8]*c};k=this.elements;A0=k[0];A1=k[1];A2=k[2];A3=k[3];A4=k[4];A5=k[5];A6=k[6];A7=k[7];A8=k[8];B0=j[0];B1=j[1];B2=j[2];B3=j[3];B4=j[4];B5=j[5];B6=j[6];B7=j[7];B8=j[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=
A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this.trigger(Two.Events.change)},scale:function(e,b){1>=arguments.length&&(b=e);return this.multiply(e,0,0,0,b,0,0,0,1)},rotate:function(l){var b=r(l);l=e(l);return this.multiply(b,-l,0,l,b,0,0,0,1)},translate:function(e,b){return this.multiply(1,0,e,0,1,b,0,0,1)},skewX:function(e){e=k(e);return this.multiply(1,e,0,0,1,0,0,0,1)},skewY:function(e){e=
k(e);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(e){var b=this.elements,c=parseFloat(b[0].toFixed(3)),f=parseFloat(b[1].toFixed(3)),n=parseFloat(b[2].toFixed(3)),a=parseFloat(b[3].toFixed(3)),p=parseFloat(b[4].toFixed(3)),x=parseFloat(b[5].toFixed(3));if(e){e=parseFloat(b[6].toFixed(3));var t=parseFloat(b[7].toFixed(3)),b=parseFloat(b[8].toFixed(3));return[c,a,e,f,p,t,n,x,b]}return[c,a,f,p,n,x]},clone:function(){var e=this.elements[0],
b=this.elements[1],c=this.elements[2],f=this.elements[3],n=this.elements[4],a=this.elements[5];g=this.elements[6];h=this.elements[7];i=this.elements[8];return new Two.Matrix(e,b,c,f,n,a,g,h,i)}})})();(function(){function r(b){var c={},f=b.id,e=b.translation,a=b.rotation,p=b.scale,x=b.stroke,t=b.linewidth,j=b.fill,k=b.opacity,r=b.visible,A=b.cap,u=b.join,w=b.miter,s=b.curved,v=b.closed,d=b.vertices;f&&(c.id=l.Identifier+f);e&&(_.isNumber(p)&&_.isNumber(a))&&(c.transform="matrix("+b._matrix.toString()+")");x&&(c.stroke=x);j&&(c.fill=j);k&&(c["stroke-opacity"]=c["fill-opacity"]=k);c.visibility=r?"visible":"hidden";A&&(c["stroke-linecap"]=A);u&&(c["stroke-linejoin"]=u);w&&(c["stroke-miterlimit"]=
w);t&&(c["stroke-width"]=t);d&&(c.d=q.toString(d,v,s));return c}var e=Two.Utils.getCurveFromPoints,k=Two.Utils.mod,q={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(b,c){var f=b.toLowerCase(),e=document.createElementNS(this.ns,f);"svg"===f&&(c=_.defaults(c||{},{version:this.version}));_.isObject(c)&&this.setAttributes(e,c);return e},setAttributes:function(b,c){_.each(c,function(b,c){this.setAttribute(c,b)},b);return this},removeAttributes:function(b,
c){_.each(c,function(b){this.removeAttribute(b)},b);return this},toString:function(b,c,f){var n=b.length,a=n-1;if(!f)return _.map(b,function(b,f){var j;j=(0>=f?"M":"L")+(" "+b.x.toFixed(3)+" "+b.y.toFixed(3));f>=a&&c&&(j+=" Z");return j}).join(" ");var p=e(b,c);return _.map(p,function(b,f){var j,e=c?k(f-1,n):Math.max(f-1,0),l=c?k(f+1,n):Math.min(f+1,a);j=p[e];var l=p[l],e=j.v.x.toFixed(3),q=j.v.y.toFixed(3),r=b.u.x.toFixed(3),w=b.u.y.toFixed(3),s=b.x.toFixed(3),v=b.y.toFixed(3);j=0>=f?"M "+s+" "+
v:"C "+e+" "+q+" "+r+" "+w+" "+s+" "+v;f>=a&&c&&(e=b.v.x.toFixed(3),q=b.v.y.toFixed(3),r=l.u.x.toFixed(3),w=l.u.y.toFixed(3),s=l.x.toFixed(3),v=l.y.toFixed(3),j=j+(" C "+e+" "+q+" "+r+" "+w+" "+s+" "+v)+" Z");return j}).join(" ")}},l=Two[Two.Types.svg]=function(){this.count=0;this.domElement=q.createElement("svg");this.elements=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(l,{Identifier:"two-"});_.extend(l.prototype,
Backbone.Events,{setSize:function(b,c){this.width=b;this.height=c;q.setAttributes(this.domElement,{width:b,height:c});return this},add:function(b){var c=b,f=this.elements,e=this.domElement;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(a){var b;b=a instanceof Two.Group;if(_.isUndefined(a.id)){var c=this.count;this.count++;a.id=c}b?(b="g",_.isUndefined(a.parent)&&(a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),a=r(a),delete a.stroke,
delete a.fill,delete a["fill-opacity"],delete a["stroke-opacity"],delete a["stroke-linecap"],delete a["stroke-linejoin"],delete a["stroke-miterlimit"],delete a["stroke-width"]):(b="path",a=r(a));a=q.createElement(b,a);e.appendChild(a);f.push(a)},this);return this},update:function(b,c,f,e,a){var p=this.elements,l=p[b];switch(c){case Two.Properties.hierarchy:_.each(f,function(a){l.appendChild(p[a])});break;case Two.Properties.demotion:_.each(f,function(a){l.removeChild(p[a])});break;default:a:{b=c;
switch(b){case "matrix":b="transform";f="matrix("+f.toString()+")";break;case "visible":b="visibility";f=f?"visible":"hidden";break;case "cap":b="stroke-linecap";break;case "join":b="stroke-linejoin";break;case "miter":b="stroke-miterlimit";break;case "linewidth":b="stroke-width";break;case "vertices":b="d";f=q.toString(f,e,a);break;case "opacity":q.setAttributes(l,{"stroke-opacity":f,"fill-opacity":f});break a}l.setAttribute(b,f)}}return this},render:function(){this.unveil();return this}})})();(function(){var r=Two.Utils.getCurveFromPoints,e=Two.Utils.mod,k=function(b){_.each(b,function(b,c){this[c]=b},this);this.children={}};_.extend(k.prototype,{appendChild:function(b){var f=b.parent,e=b.id;_.isUndefined(f)||delete f.children[e];this.children[e]=b;b.parent=this;return this},removeChild:function(b){delete this.children[b.id];return this},render:function(b){var f=this.matrix;b.save();b.transform(f[0],f[1],f[2],f[3],f[4],f[5]);_.each(this.children,function(f){f.render(b)});b.restore();return this}});
var q=function(b){_.each(b,function(b,c){this[c]=b},this)};_.extend(q.prototype,{render:function(b){var f=this.matrix,n=this.stroke,a=this.linewidth,p=this.fill,l=this.opacity,t=this.cap,j=this.join,k=this.miter,q=this.curved,r=this.closed,u=this.commands,w=u.length,s=w-1;if(!this.visible)return this;b.save();f&&b.transform(f[0],f[1],f[2],f[3],f[4],f[5]);p&&(b.fillStyle=p);n&&(b.strokeStyle=n);a&&(b.lineWidth=a);k&&(b.miterLimit=k);j&&(b.lineJoin=j);t&&(b.lineCap=t);_.isNumber(l)&&(b.globalAlpha=
l);b.beginPath();_.each(u,function(a,d){var f=a.x.toFixed(3),j=a.y.toFixed(3);if(q){var p=r?e(d-1,w):Math.max(d-1,0),l=r?e(d+1,w):Math.min(d+1,s),n=u[p],l=u[l],p=n.v.x.toFixed(3),n=n.v.y.toFixed(3),t=a.u.x.toFixed(3),k=a.u.y.toFixed(3);0>=d?b.moveTo(f,j):(b.bezierCurveTo(p,n,t,k,f,j),d>=s&&r&&(p=a.v.x.toFixed(3),n=a.v.y.toFixed(3),t=l.u.x.toFixed(3),k=l.u.y.toFixed(3),f=l.x.toFixed(3),j=l.y.toFixed(3),b.bezierCurveTo(p,n,t,k,f,j)))}else 0>=d?b.moveTo(f,j):b.lineTo(f,j)});r&&!q&&b.closePath();b.fill();
b.stroke();b.restore()}});var l={toArray:function(b,f,e){return!f?_.map(b,function(a){return{x:a.x,y:a.y}}):r(b,e)}},b=Two[Two.Types.canvas]=function(){this.count=0;this.domElement=document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.elements=[];this.stage=null};_.extend(b,{});_.extend(b,{Group:k,Element:q,getStyles:function(b){var f={},e=b.id,a=b._matrix,p=b.stroke,k=b.linewidth,t=b.fill,j=b.opacity,q=b.visible,r=b.cap,A=b.join,u=b.miter,w=b.curved,s=b.closed;b=b.vertices;
e&&(f.id=e);_.isObject(a)&&(f.matrix=a.toArray());p&&(f.stroke=p);t&&(f.fill=t);_.isNumber(j)&&(f.opacity=j);r&&(f.cap=r);A&&(f.join=A);u&&(f.miter=u);k&&(f.linewidth=k);b&&(f.commands=l.toArray(b,w,s));f.visible=!!q;f.curved=!!w;f.closed=!!s;return f},setStyles:function(b,f,e,a,p){switch(f){case "matrix":f="matrix";e=e.toArray();break;case "vertices":f="commands",b.curved=p,b.closed=a,e=l.toArray(e,b.curved,b.closed)}b[f]=e},Utils:l});_.extend(b.prototype,Backbone.Events,{setSize:function(b,f){this.width=
this.domElement.width=b;this.height=this.domElement.height=f;_.extend(this.domElement.style,{width:this.width+"px",height:this.height+"px"});return this},add:function(b){constructor=Object.getPrototypeOf(this).constructor;var f=b,e=this.elements,a=constructor.Group,p=constructor.Element,l=constructor.getStyles;_.isArray(b)||(f=_.map(arguments,function(a){return a}));_.each(f,function(b){var c;c=b instanceof Two.Group;var f=_.isNull(this.stage);if(_.isUndefined(b.id)){var k=this.count;this.count++;
b.id=k}c?(c=l.call(this,b),delete c.stroke,delete c.fill,delete c.opacity,delete c.cap,delete c.join,delete c.miter,delete c.linewidth,c=new a(c),f&&(this.stage=c,this.stage.object=b,b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):c=new p(l.call(this,b));e.push(c);f||this.stage.appendChild(c)},this);return this},update:function(b,f,e,a,p,l){var k=Object.getPrototypeOf(this).constructor,j=this.elements,q=j[b];switch(f){case Two.Properties.hierarchy:_.each(e,
function(a){q.appendChild(j[a])});break;case Two.Properties.demotion:_.each(e,function(a){q.removeChild(j[a]);this.elements[a]=null},this);break;default:k.setStyles.call(this,q,f,e,a,p,l)}return this},render:function(){if(_.isNull(this.stage))return this;this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);return this}})})();(function(){function r(a,b){var c=Math.min(a.top,b.top),f=Math.min(a.left,b.left),e=Math.max(a.right,b.right),l=Math.max(a.bottom,b.bottom);return{top:c,left:f,right:e,bottom:l,width:e-f,height:l-c,centroid:{x:-f,y:-c}}}var e=Two[Two.Types.canvas],k=Two.Matrix.Multiply,q=Two[Two.Types.canvas].Utils.toArray,l=Two.Utils.mod,b=function(a){e.Group.call(this,a)};_.extend(b.prototype,e.Group.prototype,{appendChild:function(){e.Group.prototype.appendChild.apply(this,arguments);this.updateMatrix();return this},
updateTexture:function(a){_.each(this.children,function(b){b.updateTexture(a)});return this},updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=k(this.matrix,b);this._scale=this.scale*a;_.each(this.children,function(a){a.updateMatrix(this)},this);return this},render:function(a,b){_.each(this.children,function(c){c.render(a,b)})}});var c=function(a){e.Element.call(this,a)};_.extend(c.prototype,
e.Element.prototype,{updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=k(this.matrix,b);this._scale=this.scale*a;return this},updateTexture:function(a){f.updateTexture(a,this);return this},render:function(a,b){if(!this.visible||!this.opacity||!this.buffer)return this;a.bindBuffer(a.ARRAY_BUFFER,this.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,
this.texture);a.uniformMatrix3fv(b.matrix,!1,this._matrix);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this}});var f={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(a,b,c){var f=Infinity,e=-Infinity,l=Infinity,k=-Infinity;_.each(a,function(a){var b=a.x,p=a.y,n;l=Math.min(p,l);f=Math.min(b,f);e=Math.max(b,e);k=Math.max(p,k);c&&(b=a.u.x,p=a.u.y,n=a.v.x,
a=a.v.y,l=Math.min(p,a,l),f=Math.min(b,n,f),e=Math.max(b,n,e),k=Math.max(p,a,k))});_.isNumber(b)&&(l-=b,f-=b,e+=b,k+=b);return{top:l,left:f,right:e,bottom:k,width:e-f,height:k-l,centroid:{x:-f,y:-l}}},getTriangles:function(a){var b=a.top,c=a.left,f=a.right;a=a.bottom;return new Two.Array([c,b,f,b,c,a,c,a,f,b,f,a])},updateCanvas:function(a){var b=a.commands,c=this.canvas,f=this.ctx,e=a._scale,k=a.stroke,n=a.linewidth*e,q=a.fill,r=a.opacity,w=a.cap,s=a.join,v=a.miter,d=a.curved,y=a.closed,B=b.length,
M=B-1;c.width=Math.max(Math.ceil(a.rect.width*e),1);c.height=Math.max(Math.ceil(a.rect.height*e),1);a=a.rect.centroid;var H=a.x*e,E=a.y*e;f.clearRect(0,0,c.width,c.height);q&&(f.fillStyle=q);k&&(f.strokeStyle=k);n&&(f.lineWidth=n);v&&(f.miterLimit=v);s&&(f.lineJoin=s);w&&(f.lineCap=w);_.isNumber(r)&&(f.globalAlpha=r);f.beginPath();_.each(b,function(a,c){var k=(a.x*e+H).toFixed(3),n=(a.y*e+E).toFixed(3);if(d){var q=y?l(c-1,B):Math.max(c-1,0),r=y?l(c+1,B):Math.min(c+1,M),x=b[q],r=b[r],q=(x.v.x*e+H).toFixed(3),
x=(x.v.y*e+E).toFixed(3),m=(a.u.x*e+H).toFixed(3),s=(a.u.y*e+E).toFixed(3);0>=c?f.moveTo(k,n):(f.bezierCurveTo(q,x,m,s,k,n),c>=M&&y&&(q=(a.v.x*e+H).toFixed(3),x=(a.v.y*e+E).toFixed(3),m=(r.u.x*e+H).toFixed(3),s=(r.u.y*e+E).toFixed(3),k=(r.x*e+H).toFixed(3),n=(r.y*e+E).toFixed(3),f.bezierCurveTo(q,x,m,s,k,n)))}else 0>=c?f.moveTo(k,n):f.lineTo(k,n)});y&&!d&&f.closePath();f.fill();f.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b.texture&&a.deleteTexture(b.texture);a.bindBuffer(a.ARRAY_BUFFER,
b.textureCoordsBuffer);b.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b.buffer)&&a.deleteBuffer(b.buffer);b.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,
b.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW);_.isObject(b.textureCoordsBuffer)&&a.deleteBuffer(b.textureCoordsBuffer);b.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)});a.linkProgram(c);if(!a.getProgramParameter(c,
a.LINK_STATUS))throw error=a.getProgramInfoLog(c),a.deleteProgram(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){c=a.createShader(a[c]);a.shaderSource(c,b);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw b=a.getShaderInfoLog(c),a.deleteShader(c),new Two.Utils.Error("unable to compile shader "+c+": "+b);return c},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};f.ctx=f.canvas.getContext("2d");var n=Two[Two.Types.webgl]=function(a){this.count=0;this.domElement=document.createElement("canvas");this.elements=[];this.stage=null;a=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!1});a=this.ctx=this.domElement.getContext("webgl",a)||this.domElement.getContext("experimental-webgl",
a);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var b=f.shaders.create(a,f.shaders.vertex,f.shaders.types.vertex),c=f.shaders.create(a,f.shaders.fragment,f.shaders.types.fragment);this.program=f.program.create(a,[b,c]);a.useProgram(this.program);this.program.position=a.getAttribLocation(this.program,"a_position");this.program.matrix=a.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=a.getAttribLocation(this.program,"a_textureCoords");
a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)};_.extend(n,{Group:b,Element:c,getStyles:function(a){var b={},e=a.id,l=a._matrix,j=a.stroke,k=a.linewidth,n=a.fill,r=a.opacity,u=a.visible,w=a.cap,s=a.join,v=a.miter,d=a.curved,y=a.closed,B=a.vertices;e&&(b.id=e);_.isObject(l)&&(b.matrix=b._matrix=l.toArray(!0),b.scale=b._scale=1);j&&(b.stroke=j);n&&(b.fill=n);_.isNumber(r)&&(b.opacity=
r);w&&(b.cap=w);s&&(b.join=s);v&&(b.miter=v);k&&(b.linewidth=k);B&&(b.vertices=q(B,d,y),b.commands=b.vertices,b.rect=f.getBoundingClientRect(b.commands,b.linewidth,b.curved),b.triangles=f.getTriangles(b.rect));b.visible=!!u;b.curved=!!d;b.closed=!!y;a instanceof Two.Polygon&&(f.updateBuffer(this.ctx,b,this.program),c.prototype.updateTexture.call(b,this.ctx));return b},setStyles:function(a,b,c,e,j,l){var k=!1;/matrix/.test(b)?(a[b]=c.toArray(!0),_.isNumber(e)&&(k=a.scale!==e,a.scale=e),a.updateMatrix()):
/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(b)?(a[b]=c,a.rect=r(f.getBoundingClientRect(a.commands,a.linewidth,a.curved),a.rect),a.triangles=f.getTriangles(a.rect),f.updateBuffer(this.ctx,a,this.program),k=!0):"vertices"===b?(_.isUndefined(e)||(a.closed=e),_.isUndefined(j)||(a.curved=j),l?a.commands=q(c,a.curved,a.closed):(a.vertices=q(c,a.curved,a.closed),a.commands=a.vertices),a.rect=r(f.getBoundingClientRect(a.vertices,a.linewidth,a.curved),a.rect),a.triangles=f.getTriangles(a.rect),
f.updateBuffer(this.ctx,a,this.program),k=!0):a[b]=c;k&&a.updateTexture(this.ctx)}});_.extend(n.prototype,Backbone.Events,e.prototype,{setSize:function(a,b){e.prototype.setSize.apply(this,arguments);this.ctx.viewport(0,0,a,b);var c=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(c,a,b);return this},render:function(){if(_.isNull(this.stage))return this;this.stage.render(this.ctx,this.program);return this}})})();(function(){var r=Two.Shape=function(e){this._matrix=new Two.Matrix;var k=_.debounce(_.bind(function(){var e=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation).multiply.apply(this._matrix,this.matrix.elements);this.trigger(Two.Events.change,this.id,"matrix",e,this.scale)},this),0);this._rotation=0;Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e;k()}});this._scale="scale";Object.defineProperty(this,
"scale",{get:function(){return this._scale},set:function(e){this._scale=e;k()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,k);this.matrix=new Two.Matrix;this.matrix.bind(Two.Events.change,k);if(e)return this;r.MakeGetterSetter(this,r.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=1};_.extend(r,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),
MakeGetterSetter:function(e,k){_.isArray(k)||(k=[k]);_.each(k,function(k){var l="_"+k;Object.defineProperty(e,k,{get:function(){return this[l]},set:function(b){this[l]=b;this.trigger(Two.Events.change,this.id,k,b,this)}})})}});_.extend(r.prototype,Backbone.Events,{addTo:function(e){e.add(this);return this},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},clone:function(){var e=new r;e.translation.copy(this.translation);_.each(r.Properties,
function(k){e[k]=this[k]},this);return this}})})();(function(){var r=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;r.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(r,{MakeGetterSetter:function(e,k){_.isArray(k)||(k=[k]);_.each(k,function(k){var l="_"+k;Object.defineProperty(e,k,{get:function(){return this[l]},set:function(b){this[l]=b;_.each(this.children,function(c){c[k]=b})}})})}});_.extend(r.prototype,
Two.Shape.prototype,{clone:function(e){e=e||this.parent;var k=_.map(this.children,function(l){return l.clone(e)}),q=new r;e.add(q);q.add(k);q.translation.copy(this.translation);q.rotation=this.rotation;q.scale=this.scale;return q},center:function(){var e=this.getBoundingClientRect();e.centroid={x:e.left+e.width/2,y:e.top+e.height/2};_.each(this.children,function(k){k.translation.subSelf(e.centroid)});this.translation.copy(e.centroid);return this},add:function(e){var k=e,q=this.children,l=this.parent,
b=[];_.isArray(e)||(k=_.toArray(arguments));var c=_.bind(function(b,c,a,e,l,k){this.trigger(Two.Events.change,b,c,a,e,l,k)},this);_.each(k,function(f){var e=f.id,a=f.parent;_.isUndefined(e)&&(l.add(f),e=f.id);_.isUndefined(q[e])&&(a&&delete a.children[e],q[e]=f,f.parent=this,f.unbind(Two.Events.change).bind(Two.Events.change,c),b.push(e))},this);0<b.length&&this.trigger(Two.Events.change,this.id,Two.Properties.hierarchy,b);return this},remove:function(e){var k=e,q=this.children,l=this.parent,b=[];
if(0>=arguments.length&&l)return l.remove(this),this;_.isArray(e)||(k=_.toArray(arguments));_.each(k,function(c){var f=c.id;f in q&&(delete q[f],c.unbind(Two.Events.change),b.push(f))});0<b.length&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,b);return this},getBoundingClientRect:function(){var e=Infinity,k=-Infinity,q=Infinity,l=-Infinity;_.each(this.children,function(b){b=b.getBoundingClientRect();q&&(e&&k&&l)&&(q=Math.min(b.top,q),e=Math.min(b.left,e),k=Math.max(b.right,k),l=
Math.max(b.bottom,l))},this);var b=this._matrix.multiply(e,q,1),c=this._matrix.multiply(k,l,1);return{top:b.y,left:b.x,right:c.x,bottom:c.y,width:c.x-b.x,height:c.y-b.y}},noFill:function(){_.each(this.children,function(e){e.noFill()});return this},noStroke:function(){_.each(this.children,function(e){e.noStroke()});return this}})})();(function(){var r=Math.min,e=Math.max,k=Math.round,q=Two.Polygon=function(l,b,c){Two.Shape.call(this);b=!!b;c=!!c;var f=0,n=1,a=!1,p=l.slice(0),q=_.debounce(_.bind(function(){var e,j;if(a){e=this.vertices.length;e-=1;j=k(f*e);e=k(n*e);for(p.length=0;j<e+1;j++){var l=this.vertices[j];p.push(new Two.Vector(l.x,l.y))}}this.trigger(Two.Events.change,this.id,"vertices",p,b,c,a);a=!1},this),0);Object.defineProperty(this,"closed",{get:function(){return b},set:function(a){b=!!a;q()}});Object.defineProperty(this,
"curved",{get:function(){return c},set:function(a){c=!!a;q()}});Object.defineProperty(this,"beginning",{get:function(){return f},set:function(b){f=r(e(b,0),1);a=!0;q()}});Object.defineProperty(this,"ending",{get:function(){return n},set:function(b){n=r(e(b,0),1);a=!0;q()}});this.vertices=l.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,q)},this);q()};_.extend(q.prototype,Two.Shape.prototype,{clone:function(){var e=_.map(this.vertices,function(b){return new Two.Vector(b.x,b.y)}),
b=new q(e,this.closed,this.curved);_.each(Two.Shape.Properties,function(c){b[c]=this[c]},this);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},center:function(){var e=this.getBoundingClientRect();e.centroid={x:e.left+e.width/2,y:e.top+e.height/2};_.each(this.vertices,function(b){b.subSelf(e.centroid)});this.translation.addSelf(e.centroid);return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(){var e=
this.linewidth,b=Infinity,c=-Infinity,f=Infinity,k=-Infinity;_.each(this.vertices,function(a){var e=a.x;a=a.y;f=Math.min(a,f);b=Math.min(e,b);c=Math.max(e,c);k=Math.max(a,k)});var f=f-e,b=b-e,c=c+e,k=k+e,e=this._matrix.multiply(b,f,1),a=this._matrix.multiply(c,k,1);return{top:e.y,left:e.x,right:a.x,bottom:a.y,width:a.x-e.x,height:a.y-e.y}}})})();
