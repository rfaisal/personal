(function(){function n(b,j,p){if(b===j)return 0!==b||1/b==1/j;if(null==b||null==j)return b===j;b._chain&&(b=b._wrapped);j._chain&&(j=j._wrapped);if(b.isEqual&&d.isFunction(b.isEqual))return b.isEqual(j);if(j.isEqual&&d.isFunction(j.isEqual))return j.isEqual(b);var c=m.call(b);if(c!=m.call(j))return!1;switch(c){case "[object String]":return b==String(j);case "[object Number]":return b!=+b?j!=+j:0==b?1/b==1/j:b==+j;case "[object Date]":case "[object Boolean]":return+b==+j;case "[object RegExp]":return b.source==
j.source&&b.global==j.global&&b.multiline==j.multiline&&b.ignoreCase==j.ignoreCase}if("object"!=typeof b||"object"!=typeof j)return!1;for(var a=p.length;a--;)if(p[a]==b)return!0;p.push(b);var a=0,e=!0;if("[object Array]"==c){if(a=b.length,e=a==j.length)for(;a--&&(e=a in b==a in j&&n(b[a],j[a],p)););}else{if("constructor"in b!="constructor"in j||b.constructor!=j.constructor)return!1;for(var f in b)if(d.has(b,f)&&(a++,!(e=d.has(j,f)&&n(b[f],j[f],p))))break;if(e){for(f in j)if(d.has(j,f)&&!a--)break;
e=!a}}p.pop();return e}var g=this,h=g._,l={},f=Array.prototype,e=Object.prototype,c=f.slice,a=f.unshift,m=e.toString,w=e.hasOwnProperty,t=f.forEach,k=f.map,B=f.reduce,r=f.reduceRight,q=f.filter,D=f.every,z=f.some,u=f.indexOf,v=f.lastIndexOf,e=Array.isArray,y=Object.keys,x=Function.prototype.bind,d=function(b){return new A(b)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports._=d):g._=d;d.VERSION="1.3.3";var s=d.each=d.forEach=function(b,
j,p){if(null!=b)if(t&&b.forEach===t)b.forEach(j,p);else if(b.length===+b.length)for(var a=0,c=b.length;a<c&&!(a in b&&j.call(p,b[a],a,b)===l);a++);else for(a in b)if(d.has(b,a)&&j.call(p,b[a],a,b)===l)break};d.map=d.collect=function(b,d,p){var a=[];if(null==b)return a;if(k&&b.map===k)return b.map(d,p);s(b,function(b,c,e){a[a.length]=d.call(p,b,c,e)});b.length===+b.length&&(a.length=b.length);return a};d.reduce=d.foldl=d.inject=function(b,j,p,a){var c=2<arguments.length;null==b&&(b=[]);if(B&&b.reduce===
B)return a&&(j=d.bind(j,a)),c?b.reduce(j,p):b.reduce(j);s(b,function(b,d,e){c?p=j.call(a,p,b,d,e):(p=b,c=!0)});if(!c)throw new TypeError("Reduce of empty array with no initial value");return p};d.reduceRight=d.foldr=function(b,j,p,a){var c=2<arguments.length;null==b&&(b=[]);if(r&&b.reduceRight===r)return a&&(j=d.bind(j,a)),c?b.reduceRight(j,p):b.reduceRight(j);var e=d.toArray(b).reverse();a&&!c&&(j=d.bind(j,a));return c?d.reduce(e,j,p,a):d.reduce(e,j)};d.find=d.detect=function(b,d,p){var a;I(b,function(b,
c,e){if(d.call(p,b,c,e))return a=b,!0});return a};d.filter=d.select=function(b,d,p){var a=[];if(null==b)return a;if(q&&b.filter===q)return b.filter(d,p);s(b,function(b,c,e){d.call(p,b,c,e)&&(a[a.length]=b)});return a};d.reject=function(b,d,a){var c=[];if(null==b)return c;s(b,function(b,e,f){d.call(a,b,e,f)||(c[c.length]=b)});return c};d.every=d.all=function(b,d,a){var c=!0;if(null==b)return c;if(D&&b.every===D)return b.every(d,a);s(b,function(b,e,f){if(!(c=c&&d.call(a,b,e,f)))return l});return!!c};
var I=d.some=d.any=function(b,j,a){j||(j=d.identity);var c=!1;if(null==b)return c;if(z&&b.some===z)return b.some(j,a);s(b,function(b,d,e){if(c||(c=j.call(a,b,d,e)))return l});return!!c};d.include=d.contains=function(b,d){var a=!1;return null==b?a:u&&b.indexOf===u?-1!=b.indexOf(d):a=I(b,function(b){return b===d})};d.invoke=function(b,j){var a=c.call(arguments,2);return d.map(b,function(b){return(d.isFunction(j)?j||b:b[j]).apply(b,a)})};d.pluck=function(b,j){return d.map(b,function(b){return b[j]})};
d.max=function(b,j,a){if(!j&&d.isArray(b)&&b[0]===+b[0])return Math.max.apply(Math,b);if(!j&&d.isEmpty(b))return-Infinity;var c={computed:-Infinity};s(b,function(b,d,e){d=j?j.call(a,b,d,e):b;d>=c.computed&&(c={value:b,computed:d})});return c.value};d.min=function(b,j,a){if(!j&&d.isArray(b)&&b[0]===+b[0])return Math.min.apply(Math,b);if(!j&&d.isEmpty(b))return Infinity;var c={computed:Infinity};s(b,function(b,d,e){d=j?j.call(a,b,d,e):b;d<c.computed&&(c={value:b,computed:d})});return c.value};d.shuffle=
function(b){var d=[],a;s(b,function(b,c){a=Math.floor(Math.random()*(c+1));d[c]=d[a];d[a]=b});return d};d.sortBy=function(b,a,c){var e=d.isFunction(a)?a:function(b){return b[a]};return d.pluck(d.map(b,function(b,d,a){return{value:b,criteria:e.call(c,b,d,a)}}).sort(function(b,d){var a=b.criteria,j=d.criteria;return void 0===a?1:void 0===j?-1:a<j?-1:a>j?1:0}),"value")};d.groupBy=function(b,a){var c={},e=d.isFunction(a)?a:function(b){return b[a]};s(b,function(b,d){var a=e(b,d);(c[a]||(c[a]=[])).push(b)});
return c};d.sortedIndex=function(b,a,c){c||(c=d.identity);for(var e=0,f=b.length;e<f;){var g=e+f>>1;c(b[g])<c(a)?e=g+1:f=g}return e};d.toArray=function(b){return!b?[]:d.isArray(b)||d.isArguments(b)?c.call(b):b.toArray&&d.isFunction(b.toArray)?b.toArray():d.values(b)};d.size=function(b){return d.isArray(b)?b.length:d.keys(b).length};d.first=d.head=d.take=function(b,d,a){return null!=d&&!a?c.call(b,0,d):b[0]};d.initial=function(b,d,a){return c.call(b,0,b.length-(null==d||a?1:d))};d.last=function(b,
d,a){return null!=d&&!a?c.call(b,Math.max(b.length-d,0)):b[b.length-1]};d.rest=d.tail=function(b,d,a){return c.call(b,null==d||a?1:d)};d.compact=function(b){return d.filter(b,function(b){return!!b})};d.flatten=function(b,a){return d.reduce(b,function(b,c){if(d.isArray(c))return b.concat(a?c:d.flatten(c));b[b.length]=c;return b},[])};d.without=function(b){return d.difference(b,c.call(arguments,1))};d.uniq=d.unique=function(b,a,c){c=c?d.map(b,c):b;var e=[];3>b.length&&(a=!0);d.reduce(c,function(c,p,
f){if(a?d.last(c)!==p||!c.length:!d.include(c,p))c.push(p),e.push(b[f]);return c},[]);return e};d.union=function(){return d.uniq(d.flatten(arguments,!0))};d.intersection=d.intersect=function(b){var a=c.call(arguments,1);return d.filter(d.uniq(b),function(b){return d.every(a,function(a){return 0<=d.indexOf(a,b)})})};d.difference=function(b){var a=d.flatten(c.call(arguments,1),!0);return d.filter(b,function(b){return!d.include(a,b)})};d.zip=function(){for(var b=c.call(arguments),a=d.max(d.pluck(b,"length")),
e=Array(a),f=0;f<a;f++)e[f]=d.pluck(b,""+f);return e};d.indexOf=function(b,a,c){if(null==b)return-1;var e;if(c)return c=d.sortedIndex(b,a),b[c]===a?c:-1;if(u&&b.indexOf===u)return b.indexOf(a);c=0;for(e=b.length;c<e;c++)if(c in b&&b[c]===a)return c;return-1};d.lastIndexOf=function(b,d){if(null==b)return-1;if(v&&b.lastIndexOf===v)return b.lastIndexOf(d);for(var a=b.length;a--;)if(a in b&&b[a]===d)return a;return-1};d.range=function(b,d,a){1>=arguments.length&&(d=b||0,b=0);a=arguments[2]||1;for(var c=
Math.max(Math.ceil((d-b)/a),0),e=0,f=Array(c);e<c;)f[e++]=b,b+=a;return f};var J=function(){};d.bind=function(b,a){var e,f;if(b.bind===x&&x)return x.apply(b,c.call(arguments,1));if(!d.isFunction(b))throw new TypeError;f=c.call(arguments,2);return e=function(){if(!(this instanceof e))return b.apply(a,f.concat(c.call(arguments)));J.prototype=b.prototype;var d=new J,g=b.apply(d,f.concat(c.call(arguments)));return Object(g)===g?g:d}};d.bindAll=function(b){var a=c.call(arguments,1);0==a.length&&(a=d.functions(b));
s(a,function(a){b[a]=d.bind(b[a],b)});return b};d.memoize=function(b,a){var c={};a||(a=d.identity);return function(){var e=a.apply(this,arguments);return d.has(c,e)?c[e]:c[e]=b.apply(this,arguments)}};d.delay=function(b,d){var a=c.call(arguments,2);return setTimeout(function(){return b.apply(null,a)},d)};d.defer=function(b){return d.delay.apply(d,[b,1].concat(c.call(arguments,1)))};d.throttle=function(b,a){var c,e,f,g,m,u,v=d.debounce(function(){m=g=!1},a);return function(){c=this;e=arguments;f||
(f=setTimeout(function(){f=null;m&&b.apply(c,e);v()},a));g?m=!0:u=b.apply(c,e);v();g=!0;return u}};d.debounce=function(b,d,a){var c;return function(){var e=this,f=arguments;a&&!c&&b.apply(e,f);clearTimeout(c);c=setTimeout(function(){c=null;a||b.apply(e,f)},d)}};d.once=function(b){var d=!1,a;return function(){if(d)return a;d=!0;return a=b.apply(this,arguments)}};d.wrap=function(b,d){return function(){var a=[b].concat(c.call(arguments,0));return d.apply(this,a)}};d.compose=function(){var b=arguments;
return function(){for(var d=arguments,a=b.length-1;0<=a;a--)d=[b[a].apply(this,d)];return d[0]}};d.after=function(b,d){return 0>=b?d():function(){if(1>--b)return d.apply(this,arguments)}};d.keys=y||function(b){if(b!==Object(b))throw new TypeError("Invalid object");var a=[],c;for(c in b)d.has(b,c)&&(a[a.length]=c);return a};d.values=function(b){return d.map(b,d.identity)};d.functions=d.methods=function(b){var a=[],c;for(c in b)d.isFunction(b[c])&&a.push(c);return a.sort()};d.extend=function(b){s(c.call(arguments,
1),function(d){for(var a in d)b[a]=d[a]});return b};d.pick=function(b){var a={};s(d.flatten(c.call(arguments,1)),function(d){d in b&&(a[d]=b[d])});return a};d.defaults=function(b){s(c.call(arguments,1),function(d){for(var a in d)null==b[a]&&(b[a]=d[a])});return b};d.clone=function(b){return!d.isObject(b)?b:d.isArray(b)?b.slice():d.extend({},b)};d.tap=function(b,d){d(b);return b};d.isEqual=function(b,d){return n(b,d,[])};d.isEmpty=function(b){if(null==b)return!0;if(d.isArray(b)||d.isString(b))return 0===
b.length;for(var a in b)if(d.has(b,a))return!1;return!0};d.isElement=function(b){return!!(b&&1==b.nodeType)};d.isArray=e||function(b){return"[object Array]"==m.call(b)};d.isObject=function(b){return b===Object(b)};d.isArguments=function(b){return"[object Arguments]"==m.call(b)};d.isArguments(arguments)||(d.isArguments=function(b){return!(!b||!d.has(b,"callee"))});d.isFunction=function(b){return"[object Function]"==m.call(b)};d.isString=function(b){return"[object String]"==m.call(b)};d.isNumber=function(b){return"[object Number]"==
m.call(b)};d.isFinite=function(b){return d.isNumber(b)&&isFinite(b)};d.isNaN=function(b){return b!==b};d.isBoolean=function(b){return!0===b||!1===b||"[object Boolean]"==m.call(b)};d.isDate=function(b){return"[object Date]"==m.call(b)};d.isRegExp=function(b){return"[object RegExp]"==m.call(b)};d.isNull=function(b){return null===b};d.isUndefined=function(b){return void 0===b};d.has=function(b,d){return w.call(b,d)};d.noConflict=function(){g._=h;return this};d.identity=function(b){return b};d.times=
function(b,d,a){for(var c=0;c<b;c++)d.call(a,c)};d.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.result=function(b,a){if(null==b)return null;var c=b[a];return d.isFunction(c)?c.call(b):c};d.mixin=function(b){s(d.functions(b),function(e){var f=d[e]=b[e];A.prototype[e]=function(){var b=c.call(arguments);a.call(b,this._wrapped);return E(f.apply(d,b),this._chain)}})};var K=0;d.uniqueId=
function(b){var d=K++;return b?b+d:d};d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/.^/,C={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},G;for(G in C)C[C[G]]=G;var L=/\\|'|\r|\n|\t|\u2028|\u2029/g,M=/\\(\\|'|r|n|t|u2028|u2029)/g,H=function(b){return b.replace(M,function(b,d){return C[d]})};d.template=function(b,a,c){c=d.defaults(c||{},d.templateSettings);b="__p+='"+b.replace(L,function(b){return"\\"+C[b]}).replace(c.escape||
F,function(b,d){return"'+\n_.escape("+H(d)+")+\n'"}).replace(c.interpolate||F,function(b,d){return"'+\n("+H(d)+")+\n'"}).replace(c.evaluate||F,function(b,d){return"';\n"+H(d)+"\n;__p+='"})+"';\n";c.variable||(b="with(obj||{}){\n"+b+"}\n");b="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+b+"return __p;\n";var e=new Function(c.variable||"obj","_",b);if(a)return e(a,d);a=function(b){return e.call(this,b,d)};a.source="function("+(c.variable||"obj")+"){\n"+b+"}";return a};
d.chain=function(b){return d(b).chain()};var A=function(b){this._wrapped=b};d.prototype=A.prototype;var E=function(b,a){return a?d(b).chain():b};d.mixin(d);s("pop push reverse shift sort splice unshift".split(" "),function(b){var d=f[b];A.prototype[b]=function(){var a=this._wrapped;d.apply(a,arguments);var c=a.length;("shift"==b||"splice"==b)&&0===c&&delete a[0];return E(a,this._chain)}});s(["concat","join","slice"],function(b){var d=f[b];A.prototype[b]=function(){return E(d.apply(this._wrapped,arguments),
this._chain)}});A.prototype.chain=function(){this._chain=!0;return this};A.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var n=[].slice,g=/\s+/,h=function(e,c,a,f){if(!a)return!0;if("object"===typeof a)for(var w in a)e[c].apply(e,[w,a[w]].concat(f));else if(g.test(a)){a=a.split(g);w=0;for(var h=a.length;w<h;w++)e[c].apply(e,[a[w]].concat(f))}else return!0},l=function(e,c,a){var f;e=-1;var g=c.length;switch(a.length){case 0:for(;++e<g;)(f=c[e]).callback.call(f.ctx);break;case 1:for(;++e<g;)(f=c[e]).callback.call(f.ctx,a[0]);break;case 2:for(;++e<g;)(f=c[e]).callback.call(f.ctx,a[0],a[1]);break;case 3:for(;++e<
g;)(f=c[e]).callback.call(f.ctx,a[0],a[1],a[2]);break;default:for(;++e<g;)(f=c[e]).callback.apply(f.ctx,a)}},f=Backbone.Events={on:function(e,c,a){if(!h(this,"on",e,[c,a])||!c)return this;this._events||(this._events={});(this._events[e]||(this._events[e]=[])).push({callback:c,context:a,ctx:a||this});return this},once:function(e,c,a){if(!h(this,"once",e,[c,a])||!c)return this;var f=this,g=_.once(function(){f.off(e,g);c.apply(this,arguments)});g._callback=c;this.on(e,g,a);return this},off:function(e,
c,a){var f,g,t,k,l,r,q,n;if(!this._events||!h(this,"off",e,[c,a]))return this;if(!e&&!c&&!a)return this._events={},this;k=e?[e]:_.keys(this._events);l=0;for(r=k.length;l<r;l++)if(e=k[l],f=this._events[e]){t=[];if(c||a){q=0;for(n=f.length;q<n;q++)g=f[q],(c&&c!==(g.callback._callback||g.callback)||a&&a!==g.context)&&t.push(g)}this._events[e]=t}return this},trigger:function(e){if(!this._events)return this;var c=n.call(arguments,1);if(!h(this,"trigger",e,c))return this;var a=this._events[e],f=this._events.all;
a&&l(this,a,c);f&&l(this,f,arguments);return this},listenTo:function(e,c,a){var f=this._listeners||(this._listeners={}),g=e._listenerId||(e._listenerId=_.uniqueId("l"));f[g]=e;e.on(c,a||this,this);return this},stopListening:function(e,c,a){var f=this._listeners;if(f){if(e)e.off(c,a,this),!c&&!a&&delete f[e._listenerId];else{for(var g in f)f[g].off(null,null,this);this._listeners={}}return this}}};f.bind=f.on;f.unbind=f.off})();(function(){for(var n=0,g=["ms","moz","webkit","o"],h=0;h<g.length&&!window.requestAnimationFrame;++h)window.requestAnimationFrame=window[g[h]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[g[h]+"CancelAnimationFrame"]||window[g[h]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(g){var f=(new Date).getTime(),e=Math.max(0,16-(f-n)),c=window.setTimeout(function(){g(f+e)},e);n=f+e;return c});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(g){clearTimeout(g)})})();(function(){function n(){var a=document.body.getBoundingClientRect(),c=this.width=a.width,a=this.height=a.height;this.renderer.setSize(c,a);this.trigger(k.Events.resize,c,a)}var g=this,h=g.Two||{},l=Math.sin,f=Math.cos,e=Math.atan2,c=Math.sqrt,a=Math.PI,m=2*a,w=a/2,t={hasEventListeners:_.isFunction(g.addEventListener),bind:function(a,c,e,f){this.hasEventListeners?a.addEventListener(c,e,!!f):a.attachEvent("on"+c,e);return this},unbind:function(a,c,e,f){this.hasEventListeners?a.removeEventListeners(c,
e,!!f):a.detachEvent("on"+c,e);return this}},k=g.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:k.Types.svg,autostart:!1});this.type=a.type;this.renderer=new k[this.type](this);this.playing=a.autostart;this.frameCount=0;a.fullscreen?(a=_.bind(n,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),t.bind(window,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);
this.scene=new k.Group;this.renderer.add(this.scene);k.Instances.push(this)};_.extend(k,{Array:g.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,Instances:[],noConflict:function(){g.Two=h;return this},Utils:{getCurveFromPoints:function(a,c){for(var e=[],f=a.length,d=f-1,g=0;g<f;g++){var k=a[g],m={x:k.x,y:k.y};
e.push(m);var k=c?z(g-1,f):Math.max(g-1,0),h=c?z(g+1,f):Math.min(g+1,d);D(a[k],m,a[h]);!m.u.x&&!m.u.y&&(m.u.x=m.x,m.u.y=m.y);!m.v.x&&!m.v.y&&(m.v.x=m.x,m.v.y=m.y)}return e},getControlPoints:function(c,e,g){var m=q(c,e),d=q(g,e);c=B(c,e);g=B(g,e);var k=(m+d)/2;if(1E-4>c||1E-4>g)return e.u={x:e.x,y:e.y},e.v={x:e.x,y:e.y},e;c*=0.33;g*=0.33;k=d<m?k+w:k-w;m={x:e.x+f(k)*c,y:e.y+l(k)*c};k-=a;d={x:e.x+f(k)*g,y:e.y+l(k)*g};e.u=m;e.v=d;return e},angleBetween:function(a,c){return e(a.y-c.y,a.x-c.x)},distanceBetweenSquared:function(a,
c){var e=a.x-c.x,f=a.y-c.y;return e*e+f*f},distanceBetween:function(a,e){return c(r(a,e))},mod:function(a,c){for(;0>a;)a+=c;return a%c}}});var B=k.Utils.distanceBetween,r=k.Utils.distanceBetweenSquared,q=k.Utils.angleBetween,D=k.Utils.getControlPoints,z=k.Utils.mod;_.extend(k.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){this.playing=!0;return this.trigger(k.Events.play)},pause:function(){this.playing=!1;return this.trigger(k.Events.pause)},
update:function(){this.frameCount++;var a=this.width,c=this.height,e=this.renderer;(a!==e.width||c!==e.height)&&e.setSize(a,c);return this.trigger(k.Events.update,this.frameCount)},render:function(){this.renderer.render();return this.trigger(k.Events.render,this.frameCount)},add:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));this.scene.add(c);return this},makeLine:function(a,c,e,f){e=(e-a)/2;f=(f-c)/2;var d=[new k.Vector(-e,-f),new k.Vector(e,f)],d=(new k.Polygon(d)).noFill();d.translation.set(a+
e,c+f);this.scene.add(d);return d},makeRectangle:function(a,c,e,f){e/=2;f/=2;f=[new k.Vector(e,f),new k.Vector(-e,f),new k.Vector(-e,-f),new k.Vector(e,-f)];f=new k.Polygon(f,!0);f.translation.set(a,c);this.scene.add(f);return f},makeCircle:function(a,c,e){return this.makeEllipse(a,c,e,e)},makeEllipse:function(a,c,e,g){var d=k.Resolution,h=_.map(_.range(d),function(a){var c=a/d*m;a=e*f(c);c=g*l(c);return new k.Vector(a,c)},this),h=new k.Polygon(h,!0,!0);h.translation.set(a,c);this.scene.add(h);return h},
makeCurve:function(a){var c=arguments.length,e=a;if(!_.isArray(a))for(var e=[],f=0;f<c;f+=2){var d=arguments[f];if(!_.isNumber(d))break;e.push(new k.Vector(d,arguments[f+1]))}var c=arguments[c-1],e=new k.Polygon(e,!(_.isBoolean(c)&&c),!0),c=e.getBoundingClientRect(),g=c.left+c.width/2,m=c.top+c.height/2;_.each(e.vertices,function(a){a.x-=g;a.y-=m});e.translation.set(g,m);this.scene.add(e);return e},makePolygon:function(a){var c=arguments.length,e=a;if(!_.isArray(a))for(var e=[],f=0;f<c;f+=2){var d=
arguments[f];if(!_.isNumber(d))break;e.push(new k.Vector(d,arguments[f+1]))}var c=arguments[c-1],e=new k.Polygon(e,!(_.isBoolean(c)&&c)),c=e.getBoundingClientRect(),g=c.left+c.width/2,m=c.top+c.height/2;_.each(e.vertices,function(a){a.x-=g;a.y-=m});e.translation.set(g,m);this.scene.add(e);return e},makeGroup:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));var e=new k.Group;this.scene.add(e);e.add(c);return e},importSVG:function(){}});(function(){_.each(k.Instances,function(a){a.playing&&
a.update().render()});requestAnimationFrame(arguments.callee)})()})();(function(){function n(c){var a={},g=c.id,h=c.translation,t=c.rotation,k=c.scale,l=c.stroke,r=c.linewidth,q=c.fill,n=c.opacity,z=c.visible,u=c.cap,v=c.join,y=c.miter,x=c.curved,d=c.closed;c=c.vertices;g&&(a.id=e.Identifier+g);h&&(_.isNumber(k)&&_.isNumber(t))&&(a.transform="translate("+h.x+","+h.y+") scale("+k+") rotate("+t+")");l&&(a.stroke=l);q&&(a.fill=q);n&&(a["stroke-opacity"]=a["fill-opacity"]=n);a.visibility=z?"visible":"hidden";u&&(a["stroke-linecap"]=u);v&&(a["stroke-linejoin"]=v);y&&(a["stroke-miterlimit"]=
y);r&&(a["stroke-width"]=r);c&&(a.d=f.toString(c,d,x));return a}var g=0,h=Two.Utils.getCurveFromPoints,l=Two.Utils.mod,f={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(c,a){var e=c.toLowerCase(),f=document.createElementNS(this.ns,e);"svg"===e&&(a=_.defaults(a||{},{version:this.version}));_.isObject(a)&&this.setAttributes(f,a);return f},setAttributes:function(c,a){_.each(a,function(a,c){this.setAttribute(c,a)},c);return this},removeAttributes:function(c,
a){_.each(a,function(a){this.removeAttribute(a)},c);return this},toString:function(c,a,e){var f=c.length,g=f-1;if(!e)return _.map(c,function(c,e){var f;f=(0>=e?"M":"L")+(" "+c.x.toFixed(3)+" "+c.y.toFixed(3));e>=g&&a&&(f+=" Z");return f}).join(" ");var k=h(c,a);return _.map(k,function(c,e){var m,h=a?l(e-1,f):Math.max(e-1,0),n=a?l(e+1,f):Math.min(e+1,g);m=k[h];var n=k[n],h=m.v.x.toFixed(3),u=m.v.y.toFixed(3),v=c.u.x.toFixed(3),y=c.u.y.toFixed(3),x=c.x.toFixed(3),d=c.y.toFixed(3);m=0>=e?"M "+x+" "+
d:"C "+h+" "+u+" "+v+" "+y+" "+x+" "+d;e>=g&&a&&(h=c.v.x.toFixed(3),u=c.v.y.toFixed(3),v=n.u.x.toFixed(3),y=n.u.y.toFixed(3),x=n.x.toFixed(3),d=n.y.toFixed(3),m=m+(" C "+h+" "+u+" "+v+" "+y+" "+x+" "+d)+" Z");return m}).join(" ")}},e=Two[Two.Types.svg]=function(){this.domElement=f.createElement("svg");this.elements=[];this.commands=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(e,{Identifier:"two-"});_.extend(e.prototype,
Backbone.Events,{setSize:function(c,a){this.width=c;this.height=a;f.setAttributes(this.domElement,{width:c,height:a});return this},add:function(c){var a=c,e=this.elements,h=this.domElement;_.isArray(c)||(a=_.map(arguments,function(a){return a}));_.each(a,function(a){var c;c=a instanceof Two.Group;if(_.isUndefined(a.id)){var l=g;g++;a.id=l}c?(c="g",_.isUndefined(a.parent)&&(a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),a=n(a),delete a.stroke,delete a.fill,
delete a["fill-opacity"],delete a["stroke-opacity"],delete a["stroke-linecap"],delete a["stroke-linejoin"],delete a["stroke-miterlimit"],delete a["stroke-width"]):(c="path",a=n(a));a=f.createElement(c,a);h.appendChild(a);e.push(a)},this);return this},update:function(c,a,e){this.commands.push(arguments);return this},render:function(){this.unveil();var c=this.elements;_.each(this.commands,function(a){var e=a[1],g=a[2],h=a[3],k=a[4],l=c[a[0]];switch(e){case Two.Properties.hierarchy:_.each(g,function(a){l.appendChild(c[a])});
break;default:a:{a=e;switch(a){case "matrix":a="transform";g="matrix("+g.toString()+")";break;case "visible":a="visibility";g=g?"visible":"hidden";break;case "cap":a="stroke-linecap";break;case "join":a="stroke-linejoin";break;case "miter":a="stroke-miterlimit";break;case "linewidth":a="stroke-width";break;case "vertices":a="d";g=f.toString(g,h,k);break;case "opacity":f.setAttributes(l,{"stroke-opacity":opacity,"fill-opacity":opacity});break a}l.setAttribute(a,g)}}},this);this.commands.length=0;return this}})})();(function(){var n=Two.Vector=function(g,h){g=g||0;h=h||0;Object.defineProperty(this,"x",{get:function(){return g},set:function(h){g=h;this.trigger("change","x")}});Object.defineProperty(this,"y",{get:function(){return h},set:function(g){h=g;this.trigger("change","y")}})};_.extend(n,{});_.extend(n.prototype,Backbone.Events,{set:function(g,h){this.x=g;this.y=h;return this},copy:function(g){this.x=g.x;this.y=g.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new n(this.x,
this.y)},add:function(g,h){this.x=g.x+h.x;this.y=g.y+h.y;return this},addSelf:function(g){this.x+=g.x;this.y+=g.y;return this},sub:function(g,h){this.x=g.x-h.x;this.y=g.y-h.y;return this},subSelf:function(g){this.x-=g.x;this.y-=g.y;return this},multiplySelf:function(g){this.x*=g.x;this.y*=g.y;return this},multiplyScalar:function(g){this.x*=g;this.y*=g;return this},divideScalar:function(g){g?(this.x/=g,this.y/=g):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(g){return this.x*
g.x+this.y*g.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(g){return Math.sqrt(this.distanceToSquared(g))},distanceToSquared:function(g){var h=this.x-g.x;g=this.y-g.y;return h*h+g*g},setLength:function(g){return this.normalize().multiplyScalar(g)},equals:function(g){return 1E-4>this.distanceTo(g)},lerp:function(g,h){return this.set((g.x-this.x)*
h+this.x,(g.y-this.y)*h+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var n=Math.cos,g=Math.sin,h=Math.tan,l=Two.Matrix=function(f,e,c,a,g,h){this.elements=new Two.Array(9);var l=f;_.isArray(l)||(l=_.toArray(arguments));this.identity().set(l)};_.extend(l,{Identity:[1,0,0,0,1,0,0,0,1]});_.extend(l.prototype,{set:function(f,e,c,a,g,h){var l=f;_.isArray(l)||(l=_.toArray(arguments));_.each(l,function(a,c){_.isNumber(a)&&(this.elements[c]=a)},this);return this},identity:function(){this.set(l.Identity);return this},multiply:function(f,e,c,a,g,h,l,k,
n){var r=arguments,q=r.length;if(1>=q)return _.each(this.elements,function(a,c){this.elements[c]=a*f},this),this;if(3>=q)return f=f||0,e=e||0,c=c||0,g=this.elements,{x:g[0]*f+g[1]*e+g[2]*c,y:g[3]*f+g[4]*e+g[5]*c,z:g[6]*f+g[7]*e+g[8]*c};q=this.elements;A0=q[0];A1=q[1];A2=q[2];A3=q[3];A4=q[4];A5=q[5];A6=q[6];A7=q[7];A8=q[8];B0=r[0];B1=r[1];B2=r[2];B3=r[3];B4=r[4];B5=r[5];B6=r[6];B7=r[7];B8=r[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;
this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this},scale:function(f,e){1>=arguments.length&&(e=f);return this.multiply(f,0,0,0,e,0,0,0,1)},rotate:function(f){var e=n(f);f=g(f);return this.multiply(e,-f,0,f,e,0,0,0,1)},translate:function(f,e){return this.multiply(1,0,f,0,1,e,0,0,1)},skewX:function(f){f=h(f);return this.multiply(1,
f,0,0,1,0,0,0,1)},skewY:function(f){f=h(f);return this.multiply(1,0,0,f,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(){var f=this.elements,e=f[0].toFixed(3),c=f[1].toFixed(3),a=f[2].toFixed(3),g=f[3].toFixed(3),h=f[4].toFixed(3),f=f[5].toFixed(3);return[e,g,c,h,a,f]},clone:function(){return new Two.Matrix(this.elements.slice(0))}})})();(function(){var n=Two.Shape=function(g){this._matrix=new Two.Matrix;var h=_.debounce(_.bind(function(){var g=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",g)},this),0);this._rotation="rotation";Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(g){this._rotation=g;h()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(g){this._scale=g;h()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,h);if(g)return this;n.MakeGetterSetter(this,n.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.miter=this.join=this.cap="round"};_.extend(n,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(g,h){_.isArray(h)||(h=[h]);_.each(h,function(h){var f="_"+h;Object.defineProperty(g,
h,{get:function(){return this[f]},set:function(e){this[f]=e;this.trigger(Two.Events.change,this.id,h,e,this)}})})}});_.extend(n.prototype,Backbone.Events,{addTo:function(g){g.add(this);return this},noFill:function(){this.fill="none";return this},noStroke:function(){this.stroke="none";return this},clone:function(){var g=new n;g.translation.copy(this.translation);_.each(n.Properties,function(h){g[h]=this[h]},this);return this}})})();(function(){var n=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;n.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(n,{MakeGetterSetter:function(g,h){_.isArray(h)||(h=[h]);_.each(h,function(h){var f="_"+h;Object.defineProperty(g,h,{get:function(){return this[f]},set:function(e){this[f]=e;_.each(this.children,function(c){c[h]=e})}})})}});_.extend(n.prototype,
Two.Shape.prototype,{add:function(g){var h=g,l=this.children,f=this.parent,e=[];_.isArray(g)||(h=_.toArray(arguments));var c=_.bind(function(a,c,e,f,g){this.trigger(Two.Events.change,a,c,e,f,g)},this);_.each(h,function(a){var g=a.id,h=a.parent;_.isUndefined(g)&&(f.add(a),g=a.id);_.isUndefined(l[g])&&(h&&delete h.children[g],l[g]=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,c),e.push(g))},this);0<e.length&&this.trigger(Two.Events.change,this.id,"hierarchy",e);return this},getBoundingClientRect:function(){var g=
Infinity,h=-Infinity,l=Infinity,f=-Infinity;_.each(this.children,function(a){a=a.getBoundingClientRect();l=Math.min(a.top,l);g=Math.min(a.left,g);h=Math.max(a.right,h);f=Math.max(a.bottom,f)},this);var e=this._matrix.multiply(g,l,1),c=this._matrix.multiply(h,f,1);return{top:e.y,left:e.x,right:c.x,bottom:c.y,width:c.x-e.x,height:c.y-e.y}},noFill:function(){_.each(this.children,function(g){g.noFill()});return this},noStroke:function(){_.each(this.children,function(g){g.noStroke()});return this}})})();(function(){var n=Math.min,g=Math.max,h=Math.round,l=Two.Polygon=function(f,e,c){Two.Shape.call(this);e=!!e;c=!!c;var a=0,m=1,l=!1,t=f.slice(0),k=_.debounce(_.bind(function(){var c,e;if(l){c=this.vertices.length;c-=1;e=h(a*c);c=h(m*c);for(t.length=0;e<c+1;e++){var f=this.vertices[e];t.push({x:f.x,y:f.y})}l=!1}this.trigger(Two.Events.change,this.id,"vertices",t,this.closed,this.curved)},this),0);Object.defineProperty(this,"closed",{get:function(){return e},set:function(a){e=!!a;k()}});Object.defineProperty(this,
"curved",{get:function(){return c},set:function(a){c=!!a;k()}});Object.defineProperty(this,"beginning",{get:function(){return a},set:function(c){a=n(g(c,0),1);l=!0;k()}});Object.defineProperty(this,"ending",{get:function(){return m},set:function(a){m=n(g(a,0),1);l=!0;k()}});this.vertices=f.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,k)},this);k()};_.extend(l,{});_.extend(l.prototype,Two.Shape.prototype,{clone:function(){var f=_.map(this.vertices,function(c){return new Two.Vector(c.x,
c.y)}),e=new l(f,this.closed,this.curved);_.each(Two.Shape.Properties,function(c){e[c]=this[c]},this);e.translation.copy(this.translation);e.rotation=this.rotation;e.scale=this.scale;return e},getBoundingClientRect:function(){var f=this.linewidth,e=Infinity,c=-Infinity,a=Infinity,g=-Infinity;_.each(this.vertices,function(f){var h=f.x;f=f.y;a=Math.min(f,a);e=Math.min(h,e);c=Math.max(h,c);g=Math.max(f,g)});var a=a-f,e=e-f,c=c+f,g=g+f,f=this._matrix.multiply(e,a,1),h=this._matrix.multiply(c,g,1);return{top:f.y,
left:f.x,right:h.x,bottom:h.y,width:h.x-f.x,height:h.y-f.y}}})})();
