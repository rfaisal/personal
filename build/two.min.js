(function(){function m(b,j,p){if(b===j)return 0!==b||1/b==1/j;if(null==b||null==j)return b===j;b._chain&&(b=b._wrapped);j._chain&&(j=j._wrapped);if(b.isEqual&&d.isFunction(b.isEqual))return b.isEqual(j);if(j.isEqual&&d.isFunction(j.isEqual))return j.isEqual(b);var H=a.call(b);if(H!=a.call(j))return!1;switch(H){case "[object String]":return b==String(j);case "[object Number]":return b!=+b?j!=+j:0==b?1/b==1/j:b==+j;case "[object Date]":case "[object Boolean]":return+b==+j;case "[object RegExp]":return b.source==
j.source&&b.global==j.global&&b.multiline==j.multiline&&b.ignoreCase==j.ignoreCase}if("object"!=typeof b||"object"!=typeof j)return!1;for(var c=p.length;c--;)if(p[c]==b)return!0;p.push(b);var c=0,f=!0;if("[object Array]"==H){if(c=b.length,f=c==j.length)for(;c--&&(f=c in b==c in j&&m(b[c],j[c],p)););}else{if("constructor"in b!="constructor"in j||b.constructor!=j.constructor)return!1;for(var g in b)if(d.has(b,g)&&(c++,!(f=d.has(j,g)&&m(b[g],j[g],p))))break;if(f){for(g in j)if(d.has(j,g)&&!c--)break;
f=!c}}p.pop();return f}var e=this,h=e._,l={},k=Array.prototype,c=Object.prototype,g=k.slice,f=k.unshift,a=c.toString,q=c.hasOwnProperty,t=k.forEach,y=k.map,z=k.reduce,n=k.reduceRight,u=k.filter,K=k.every,L=k.some,F=k.indexOf,G=k.lastIndexOf,c=Array.isArray,B=Object.keys,s=Function.prototype.bind,d=function(b){return new C(b)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports._=d):e._=d;d.VERSION="1.3.3";var r=d.each=d.forEach=function(b,
j,p){if(null!=b)if(t&&b.forEach===t)b.forEach(j,p);else if(b.length===+b.length)for(var a=0,c=b.length;a<c&&!(a in b&&j.call(p,b[a],a,b)===l);a++);else for(a in b)if(d.has(b,a)&&j.call(p,b[a],a,b)===l)break};d.map=d.collect=function(b,j,d){var a=[];if(null==b)return a;if(y&&b.map===y)return b.map(j,d);r(b,function(b,c,f){a[a.length]=j.call(d,b,c,f)});b.length===+b.length&&(a.length=b.length);return a};d.reduce=d.foldl=d.inject=function(b,j,p,a){var c=2<arguments.length;null==b&&(b=[]);if(z&&b.reduce===
z)return a&&(j=d.bind(j,a)),c?b.reduce(j,p):b.reduce(j);r(b,function(b,d,f){c?p=j.call(a,p,b,d,f):(p=b,c=!0)});if(!c)throw new TypeError("Reduce of empty array with no initial value");return p};d.reduceRight=d.foldr=function(b,j,p,a){var c=2<arguments.length;null==b&&(b=[]);if(n&&b.reduceRight===n)return a&&(j=d.bind(j,a)),c?b.reduceRight(j,p):b.reduceRight(j);var f=d.toArray(b).reverse();a&&!c&&(j=d.bind(j,a));return c?d.reduce(f,j,p,a):d.reduce(f,j)};d.find=d.detect=function(b,j,d){var a;v(b,function(b,
c,f){if(j.call(d,b,c,f))return a=b,!0});return a};d.filter=d.select=function(b,d,p){var a=[];if(null==b)return a;if(u&&b.filter===u)return b.filter(d,p);r(b,function(b,c,f){d.call(p,b,c,f)&&(a[a.length]=b)});return a};d.reject=function(b,d,p){var a=[];if(null==b)return a;r(b,function(b,c,f){d.call(p,b,c,f)||(a[a.length]=b)});return a};d.every=d.all=function(b,d,p){var a=!0;if(null==b)return a;if(K&&b.every===K)return b.every(d,p);r(b,function(b,c,f){if(!(a=a&&d.call(p,b,c,f)))return l});return!!a};
var v=d.some=d.any=function(b,j,a){j||(j=d.identity);var c=!1;if(null==b)return c;if(L&&b.some===L)return b.some(j,a);r(b,function(b,d,f){if(c||(c=j.call(a,b,d,f)))return l});return!!c};d.include=d.contains=function(b,d){var a=!1;return null==b?a:F&&b.indexOf===F?-1!=b.indexOf(d):a=v(b,function(b){return b===d})};d.invoke=function(b,j){var a=g.call(arguments,2);return d.map(b,function(b){return(d.isFunction(j)?j||b:b[j]).apply(b,a)})};d.pluck=function(b,j){return d.map(b,function(b){return b[j]})};
d.max=function(b,j,a){if(!j&&d.isArray(b)&&b[0]===+b[0])return Math.max.apply(Math,b);if(!j&&d.isEmpty(b))return-Infinity;var c={computed:-Infinity};r(b,function(b,d,f){d=j?j.call(a,b,d,f):b;d>=c.computed&&(c={value:b,computed:d})});return c.value};d.min=function(b,j,a){if(!j&&d.isArray(b)&&b[0]===+b[0])return Math.min.apply(Math,b);if(!j&&d.isEmpty(b))return Infinity;var c={computed:Infinity};r(b,function(b,d,f){d=j?j.call(a,b,d,f):b;d<c.computed&&(c={value:b,computed:d})});return c.value};d.shuffle=
function(b){var d=[],a;r(b,function(b,c){a=Math.floor(Math.random()*(c+1));d[c]=d[a];d[a]=b});return d};d.sortBy=function(b,j,a){var c=d.isFunction(j)?j:function(b){return b[j]};return d.pluck(d.map(b,function(b,d,j){return{value:b,criteria:c.call(a,b,d,j)}}).sort(function(b,d){var j=b.criteria,a=d.criteria;return void 0===j?1:void 0===a?-1:j<a?-1:j>a?1:0}),"value")};d.groupBy=function(b,j){var a={},c=d.isFunction(j)?j:function(b){return b[j]};r(b,function(b,d){var j=c(b,d);(a[j]||(a[j]=[])).push(b)});
return a};d.sortedIndex=function(b,j,a){a||(a=d.identity);for(var c=0,f=b.length;c<f;){var g=c+f>>1;a(b[g])<a(j)?c=g+1:f=g}return c};d.toArray=function(b){return!b?[]:d.isArray(b)||d.isArguments(b)?g.call(b):b.toArray&&d.isFunction(b.toArray)?b.toArray():d.values(b)};d.size=function(b){return d.isArray(b)?b.length:d.keys(b).length};d.first=d.head=d.take=function(b,d,a){return null!=d&&!a?g.call(b,0,d):b[0]};d.initial=function(b,d,a){return g.call(b,0,b.length-(null==d||a?1:d))};d.last=function(b,
d,a){return null!=d&&!a?g.call(b,Math.max(b.length-d,0)):b[b.length-1]};d.rest=d.tail=function(b,d,a){return g.call(b,null==d||a?1:d)};d.compact=function(b){return d.filter(b,function(b){return!!b})};d.flatten=function(b,a){return d.reduce(b,function(b,c){if(d.isArray(c))return b.concat(a?c:d.flatten(c));b[b.length]=c;return b},[])};d.without=function(b){return d.difference(b,g.call(arguments,1))};d.uniq=d.unique=function(b,a,c){c=c?d.map(b,c):b;var f=[];3>b.length&&(a=!0);d.reduce(c,function(c,p,
g){if(a?d.last(c)!==p||!c.length:!d.include(c,p))c.push(p),f.push(b[g]);return c},[]);return f};d.union=function(){return d.uniq(d.flatten(arguments,!0))};d.intersection=d.intersect=function(b){var a=g.call(arguments,1);return d.filter(d.uniq(b),function(b){return d.every(a,function(a){return 0<=d.indexOf(a,b)})})};d.difference=function(b){var a=d.flatten(g.call(arguments,1),!0);return d.filter(b,function(b){return!d.include(a,b)})};d.zip=function(){for(var b=g.call(arguments),a=d.max(d.pluck(b,"length")),
c=Array(a),f=0;f<a;f++)c[f]=d.pluck(b,""+f);return c};d.indexOf=function(b,a,c){if(null==b)return-1;var f;if(c)return c=d.sortedIndex(b,a),b[c]===a?c:-1;if(F&&b.indexOf===F)return b.indexOf(a);c=0;for(f=b.length;c<f;c++)if(c in b&&b[c]===a)return c;return-1};d.lastIndexOf=function(b,d){if(null==b)return-1;if(G&&b.lastIndexOf===G)return b.lastIndexOf(d);for(var a=b.length;a--;)if(a in b&&b[a]===d)return a;return-1};d.range=function(b,d,a){1>=arguments.length&&(d=b||0,b=0);a=arguments[2]||1;for(var c=
Math.max(Math.ceil((d-b)/a),0),f=0,g=Array(c);f<c;)g[f++]=b,b+=a;return g};var w=function(){};d.bind=function(b,a){var c,f;if(b.bind===s&&s)return s.apply(b,g.call(arguments,1));if(!d.isFunction(b))throw new TypeError;f=g.call(arguments,2);return c=function(){if(!(this instanceof c))return b.apply(a,f.concat(g.call(arguments)));w.prototype=b.prototype;var d=new w,e=b.apply(d,f.concat(g.call(arguments)));return Object(e)===e?e:d}};d.bindAll=function(b){var a=g.call(arguments,1);0==a.length&&(a=d.functions(b));
r(a,function(a){b[a]=d.bind(b[a],b)});return b};d.memoize=function(b,a){var c={};a||(a=d.identity);return function(){var f=a.apply(this,arguments);return d.has(c,f)?c[f]:c[f]=b.apply(this,arguments)}};d.delay=function(b,d){var a=g.call(arguments,2);return setTimeout(function(){return b.apply(null,a)},d)};d.defer=function(b){return d.delay.apply(d,[b,1].concat(g.call(arguments,1)))};d.throttle=function(b,a){var c,f,g,e,q,k,n=d.debounce(function(){q=e=!1},a);return function(){c=this;f=arguments;g||
(g=setTimeout(function(){g=null;q&&b.apply(c,f);n()},a));e?q=!0:k=b.apply(c,f);n();e=!0;return k}};d.debounce=function(b,d,a){var c;return function(){var f=this,g=arguments;a&&!c&&b.apply(f,g);clearTimeout(c);c=setTimeout(function(){c=null;a||b.apply(f,g)},d)}};d.once=function(b){var d=!1,a;return function(){if(d)return a;d=!0;return a=b.apply(this,arguments)}};d.wrap=function(b,d){return function(){var a=[b].concat(g.call(arguments,0));return d.apply(this,a)}};d.compose=function(){var b=arguments;
return function(){for(var d=arguments,a=b.length-1;0<=a;a--)d=[b[a].apply(this,d)];return d[0]}};d.after=function(b,d){return 0>=b?d():function(){if(1>--b)return d.apply(this,arguments)}};d.keys=B||function(b){if(b!==Object(b))throw new TypeError("Invalid object");var a=[],c;for(c in b)d.has(b,c)&&(a[a.length]=c);return a};d.values=function(b){return d.map(b,d.identity)};d.functions=d.methods=function(b){var a=[],c;for(c in b)d.isFunction(b[c])&&a.push(c);return a.sort()};d.extend=function(b){r(g.call(arguments,
1),function(d){for(var a in d)b[a]=d[a]});return b};d.pick=function(b){var a={};r(d.flatten(g.call(arguments,1)),function(d){d in b&&(a[d]=b[d])});return a};d.defaults=function(b){r(g.call(arguments,1),function(d){for(var a in d)null==b[a]&&(b[a]=d[a])});return b};d.clone=function(b){return!d.isObject(b)?b:d.isArray(b)?b.slice():d.extend({},b)};d.tap=function(b,d){d(b);return b};d.isEqual=function(b,d){return m(b,d,[])};d.isEmpty=function(b){if(null==b)return!0;if(d.isArray(b)||d.isString(b))return 0===
b.length;for(var a in b)if(d.has(b,a))return!1;return!0};d.isElement=function(b){return!!(b&&1==b.nodeType)};d.isArray=c||function(b){return"[object Array]"==a.call(b)};d.isObject=function(b){return b===Object(b)};d.isArguments=function(b){return"[object Arguments]"==a.call(b)};d.isArguments(arguments)||(d.isArguments=function(b){return!(!b||!d.has(b,"callee"))});d.isFunction=function(b){return"[object Function]"==a.call(b)};d.isString=function(b){return"[object String]"==a.call(b)};d.isNumber=function(b){return"[object Number]"==
a.call(b)};d.isFinite=function(b){return d.isNumber(b)&&isFinite(b)};d.isNaN=function(b){return b!==b};d.isBoolean=function(b){return!0===b||!1===b||"[object Boolean]"==a.call(b)};d.isDate=function(b){return"[object Date]"==a.call(b)};d.isRegExp=function(b){return"[object RegExp]"==a.call(b)};d.isNull=function(b){return null===b};d.isUndefined=function(b){return void 0===b};d.has=function(b,d){return q.call(b,d)};d.noConflict=function(){e._=h;return this};d.identity=function(b){return b};d.times=
function(b,d,a){for(var c=0;c<b;c++)d.call(a,c)};d.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.result=function(b,a){if(null==b)return null;var c=b[a];return d.isFunction(c)?c.call(b):c};d.mixin=function(b){r(d.functions(b),function(a){var c=d[a]=b[a];C.prototype[a]=function(){var b=g.call(arguments);f.call(b,this._wrapped);return I(c.apply(d,b),this._chain)}})};var D=0;d.uniqueId=
function(b){var d=D++;return b?b+d:d};d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var x=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},E;for(E in A)A[A[E]]=E;var M=/\\|'|\r|\n|\t|\u2028|\u2029/g,N=/\\(\\|'|r|n|t|u2028|u2029)/g,J=function(b){return b.replace(N,function(b,d){return A[d]})};d.template=function(b,a,c){c=d.defaults(c||{},d.templateSettings);b="__p+='"+b.replace(M,function(b){return"\\"+A[b]}).replace(c.escape||
x,function(b,d){return"'+\n_.escape("+J(d)+")+\n'"}).replace(c.interpolate||x,function(b,d){return"'+\n("+J(d)+")+\n'"}).replace(c.evaluate||x,function(b,d){return"';\n"+J(d)+"\n;__p+='"})+"';\n";c.variable||(b="with(obj||{}){\n"+b+"}\n");b="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+b+"return __p;\n";var f=new Function(c.variable||"obj","_",b);if(a)return f(a,d);a=function(b){return f.call(this,b,d)};a.source="function("+(c.variable||"obj")+"){\n"+b+"}";return a};
d.chain=function(b){return d(b).chain()};var C=function(b){this._wrapped=b};d.prototype=C.prototype;var I=function(b,a){return a?d(b).chain():b};d.mixin(d);r("pop push reverse shift sort splice unshift".split(" "),function(b){var d=k[b];C.prototype[b]=function(){var a=this._wrapped;d.apply(a,arguments);var c=a.length;("shift"==b||"splice"==b)&&0===c&&delete a[0];return I(a,this._chain)}});r(["concat","join","slice"],function(b){var d=k[b];C.prototype[b]=function(){return I(d.apply(this._wrapped,arguments),
this._chain)}});C.prototype.chain=function(){this._chain=!0;return this};C.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var m=[].slice,e=/\s+/,h=function(c,g,f,a){if(!f)return!0;if("object"===typeof f)for(var q in f)c[g].apply(c,[q,f[q]].concat(a));else if(e.test(f)){f=f.split(e);q=0;for(var k=f.length;q<k;q++)c[g].apply(c,[f[q]].concat(a))}else return!0},l=function(c,g,f){var a;c=-1;var e=g.length;switch(f.length){case 0:for(;++c<e;)(a=g[c]).callback.call(a.ctx);break;case 1:for(;++c<e;)(a=g[c]).callback.call(a.ctx,f[0]);break;case 2:for(;++c<e;)(a=g[c]).callback.call(a.ctx,f[0],f[1]);break;case 3:for(;++c<
e;)(a=g[c]).callback.call(a.ctx,f[0],f[1],f[2]);break;default:for(;++c<e;)(a=g[c]).callback.apply(a.ctx,f)}},k=Backbone.Events={on:function(c,g,f){if(!h(this,"on",c,[g,f])||!g)return this;this._events||(this._events={});(this._events[c]||(this._events[c]=[])).push({callback:g,context:f,ctx:f||this});return this},once:function(c,g,f){if(!h(this,"once",c,[g,f])||!g)return this;var a=this,e=_.once(function(){a.off(c,e);g.apply(this,arguments)});e._callback=g;this.on(c,e,f);return this},off:function(c,
g,f){var a,e,k,y,z,n,u,l;if(!this._events||!h(this,"off",c,[g,f]))return this;if(!c&&!g&&!f)return this._events={},this;y=c?[c]:_.keys(this._events);z=0;for(n=y.length;z<n;z++)if(c=y[z],a=this._events[c]){k=[];if(g||f){u=0;for(l=a.length;u<l;u++)e=a[u],(g&&g!==(e.callback._callback||e.callback)||f&&f!==e.context)&&k.push(e)}this._events[c]=k}return this},trigger:function(c){if(!this._events)return this;var e=m.call(arguments,1);if(!h(this,"trigger",c,e))return this;var f=this._events[c],a=this._events.all;
f&&l(this,f,e);a&&l(this,a,arguments);return this},listenTo:function(c,e,f){var a=this._listeners||(this._listeners={}),k=c._listenerId||(c._listenerId=_.uniqueId("l"));a[k]=c;c.on(e,f||this,this);return this},stopListening:function(c,e,f){var a=this._listeners;if(a){if(c)c.off(e,f,this),!e&&!f&&delete a[c._listenerId];else{for(var k in a)a[k].off(null,null,this);this._listeners={}}return this}}};k.bind=k.on;k.unbind=k.off})();(function(){for(var m=0,e=["ms","moz","webkit","o"],h=0;h<e.length&&!window.requestAnimationFrame;++h)window.requestAnimationFrame=window[e[h]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[h]+"CancelAnimationFrame"]||window[e[h]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var k=(new Date).getTime(),c=Math.max(0,16-(k-m)),g=window.setTimeout(function(){e(k+c)},c);m=k+c;return g});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(e){clearTimeout(e)})})();(function(){function m(){var a=document.body.getBoundingClientRect(),c=this.width=a.width,a=this.height=a.height;this.renderer.setSize(c,a);this.trigger(f.Events.resize,c,a)}var e=this,h=e.Two||{},l=2*Math.PI,k=Math.cos,c=Math.sin,g={hasEventListeners:_.isFunction(e.addEventListener),bind:function(a,c,f,e){this.hasEventListeners?a.addEventListener(c,f,!!e):a.attachEvent("on"+c,f);return this},unbind:function(a,c,f,e){this.hasEventListeners?a.removeEventListeners(c,f,!!e):a.detachEvent("on"+c,f);return this}},
f=e.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:f.Types.svg,autostart:!0});this.type=a.type;this.renderer=new f[this.type](this);this.playing=a.autostart;this.frameCount=0;a.fullscreen?(a=_.bind(m,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),g.bind(window,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);this.scene=new f.Group;this.renderer.add(this.scene);
f.Instances.push(this)};_.extend(f,{Array:e.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,Instances:[],noConflict:function(){e.Two=h;return this}});_.extend(f.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){this.playing=!0;return this.trigger(f.Events.play)},
pause:function(){this.playing=!1;return this.trigger(f.Events.pause)},update:function(){this.frameCount++;var a=this.width,c=this.height,e=this.renderer;(a!==e.width||c!==e.height)&&e.setSize(a,c);return this.trigger(f.Events.update,this.frameCount)},render:function(){this.renderer.render();return this.trigger(f.Events.render,this.frameCount)},add:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));this.scene.add(c);return this},makeLine:function(a,c,e,g){e=(e-a)/2;g=(g-c)/2;var k=[new f.Vector(-e,
-g),new f.Vector(e,g)],k=(new f.Polygon(k)).noFill();k.translation.set(a+e,c+g);this.scene.add(k);return k},makeRectangle:function(a,c,e,g){e/=2;g/=2;g=[new f.Vector(e,g),new f.Vector(-e,g),new f.Vector(-e,-g),new f.Vector(e,-g)];g=new f.Polygon(g,!0);g.translation.set(a,c);this.scene.add(g);return g},makeCircle:function(a,c,f){return this.makeEllipse(a,c,f,f)},makeEllipse:function(a,e,g,h){var z=f.Resolution,n=_.map(_.range(z),function(a){var e=a/z*l;a=g*k(e);e=h*c(e);return new f.Vector(a,e)},this),
n=new f.Polygon(n,!0,!0);n.translation.set(a,e);this.scene.add(n);return n},makeCurve:function(a){var c=arguments.length,e=a;if(!_.isArray(a))for(var e=[],g=0;g<c;g+=2){var k=arguments[g];if(!_.isNumber(k))break;e.push(new f.Vector(k,arguments[g+1]))}var c=arguments[c-1],e=new f.Polygon(e,!(_.isBoolean(c)&&c),!0),c=e.getBoundingClientRect(),n=c.left+c.width/2,h=c.top+c.height/2;_.each(e.vertices,function(a){a.x-=n;a.y-=h});e.translation.set(n,h);this.scene.add(e);return e},makePolygon:function(a){var c=
arguments.length,e=a;if(!_.isArray(a))for(var e=[],g=0;g<c;g+=2){var k=arguments[g];if(!_.isNumber(k))break;e.push(new f.Vector(k,arguments[g+1]))}var c=arguments[c-1],e=new f.Polygon(e,!(_.isBoolean(c)&&c)),c=e.getBoundingClientRect(),n=c.left+c.width/2,h=c.top+c.height/2;_.each(e.vertices,function(a){a.x-=n;a.y-=h});e.translation.set(n,h);this.scene.add(e);return e},makeGroup:function(){var a=new f.Group;this.scene.add(a);a.add(_.toArray(arguments));return a}});(function(){_.each(f.Instances,function(a){a.playing&&
a.update().render()});requestAnimationFrame(arguments.callee)})()})();(function(){function m(a){var c={},e=a.translation,f=a.rotation,g=a.scale,k=a.stroke,h=a.linewidth,l=a.fill,q=a.opacity,d=a.visible,m=a.cap,v=a.join,w=a.miter,D=a.curved,x=a.closed,A=a.vertices;a.id&&(c.id=y.Identifier+a.id);e&&(_.isNumber(g)&&_.isNumber(f))&&(c.transform="translate("+e.x+","+e.y+") scale("+g+") rotate("+f+")");k&&(c.stroke=k);l&&(c.fill=l);q&&(c["stroke-opacity"]=c["fill-opacity"]=q);d&&(c.visibility=d?"visible":"hidden");m&&(c["stroke-linecap"]=m);v&&(c["stroke-linejoin"]=v);w&&
(c["stroke-miterlimit"]=w);h&&(c["stroke-width"]=h);A&&(c.d=t.toString(A,x,D));return c}function e(a,c){var e=a.x-c.x,g=a.y-c.y;return f(e*e+g*g)}function h(a,c){for(;0>a;)a+=c;return a%c}var l=0,k=Math.sin,c=Math.cos,g=Math.atan2,f=Math.sqrt,a=Math.PI,q=a/2,t={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(a,c){var e=a.toLowerCase(),f=document.createElementNS(this.ns,e);"svg"===e&&(c=_.defaults(c||{},{version:this.version}));_.isObject(c)&&
this.setAttributes(f,c);return f},setAttributes:function(a,c){_.each(c,function(a,c){this.setAttribute(c,a)},a);return this},removeAttributes:function(a,c){_.each(c,function(a){this.removeAttribute(a)},a);return this},toString:function(f,n,l){var y=f.length,m=y-1;if(!l)return _.map(f,function(a,d){var c;c=(0>=d?"M":"L")+(" "+a.x.toFixed(3)+" "+a.y.toFixed(3));d>=m&&n&&(c+=" Z");return c}).join(" ");var t=[];l=f.length;for(var G=l-1,B=0;B<l;B++){var s=f[B],s={x:s.x,y:s.y};t.push(s);var d=n?h(B-1,l):
Math.max(B-1,0),r=n?h(B+1,l):Math.min(B+1,G);var v=f[d],d=s,w=f[r],r=g(v.y-d.y,v.x-d.x),D=g(w.y-d.y,w.x-d.x),v=e(v,d),w=e(w,d),x=(r+D)/2,A=void 0,E=void 0;1E-4>v||1E-4>w?(d.u={x:d.x,y:d.y},d.v={x:d.x,y:d.y}):(v*=0.33,w*=0.33,x=D<r?x+q:x-q,A={x:d.x+c(x)*v,y:d.y+k(x)*v},x-=a,E={x:d.x+c(x)*w,y:d.y+k(x)*w},d.u=A,d.v=E);!s.u.x&&!s.u.y&&(s.u.x=s.x,s.u.y=s.y);!s.v.x&&!s.v.y&&(s.v.x=s.x,s.v.y=s.y)}return _.map(t,function(a,d){var c,e=n?h(d-1,y):Math.max(d-1,0),f=n?h(d+1,y):Math.min(d+1,m);c=t[e];var f=t[f],
e=c.v.x.toFixed(3),b=c.v.y.toFixed(3),g=a.u.x.toFixed(3),k=a.u.y.toFixed(3),l=a.x.toFixed(3),q=a.y.toFixed(3);c=0>=d?"M "+l+" "+q:"C "+e+" "+b+" "+g+" "+k+" "+l+" "+q;d>=m&&n&&(e=a.v.x.toFixed(3),b=a.v.y.toFixed(3),g=f.u.x.toFixed(3),k=f.u.y.toFixed(3),l=f.x.toFixed(3),q=f.y.toFixed(3),c=c+(" C "+e+" "+b+" "+g+" "+k+" "+l+" "+q)+" Z");return c}).join(" ")}},y=Two[Two.Types.svg]=function(a){this.two=a;this.domElement=t.createElement("svg");this.elements=[];this.commands=[]};_.extend(y,{Identifier:"two-"});
_.extend(y.prototype,Backbone.Events,{setSize:function(a,c){this.width=a;this.height=c;t.setAttributes(this.domElement,{width:a,height:c});return this},add:function(a){var c=a,e=this.elements,f=this.domElement;_.isArray(a)||(c=_.map(arguments,function(a){return a}));_.each(c,function(a){var c;c=a instanceof Two.Group;if(_.isUndefined(a.id)){var g=l;l++;a.id=g}c?(c="g",_.isUndefined(a.parent)&&(a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),a=m(a),delete a.stroke,
delete a.fill,delete a["fill-opacity"],delete a["stroke-opacity"],delete a["stroke-linecap"],delete a["stroke-linejoin"],delete a["stroke-miterlimit"],delete a["stroke-width"]):(c="path",a=m(a));a=t.createElement(c,a);f.appendChild(a);e.push(a)},this);return this},update:function(a,c,e){this.commands.push(arguments);return this},render:function(){var a=this.elements;_.each(this.commands,function(c){var e=c[1],f=c[2],g=c[3],k=c[4],h=a[c[0]];switch(e){case Two.Properties.hierarchy:_.each(f,function(c){h.appendChild(a[c])});
break;default:a:{c=e;switch(c){case "matrix":c="transform";f="matrix("+f+")";break;case "visible":c="visibility";f=f?"visible":"hidden";break;case "cap":c="stroke-linecap";break;case "join":c="stroke-linejoin";break;case "miter":c="stroke-miterlimit";break;case "linewidth":c="stroke-width";break;case "vertices":c="d";f=t.toString(f,g,k);break;case "opacity":t.setAttributes(h,{"stroke-opacity":opacity,"fill-opacity":opacity});break a}h.setAttribute(c,f)}}},this);this.commands.length=0;return this}})})();(function(){var m=Two.Vector=function(e,h){e=e||0;h=h||0;Object.defineProperty(this,"x",{get:function(){return e},set:function(h){e=h;this.trigger("change","x")}});Object.defineProperty(this,"y",{get:function(){return h},set:function(e){h=e;this.trigger("change","y")}})};_.extend(m,{});_.extend(m.prototype,Backbone.Events,{set:function(e,h){this.x=e;this.y=h;return this},copy:function(e){this.x=e.x;this.y=e.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new m(this.x,
this.y)},add:function(e,h){this.x=e.x+h.x;this.y=e.y+h.y;return this},addSelf:function(e){this.x+=e.x;this.y+=e.y;return this},sub:function(e,h){this.x=e.x-h.x;this.y=e.y-h.y;return this},subSelf:function(e){this.x-=e.x;this.y-=e.y;return this},multiplySelf:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){e?(this.x/=e,this.y/=e):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*
e.x+this.y*e.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var h=this.x-e.x;e=this.y-e.y;return h*h+e*e},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,h){return this.set((e.x-this.x)*
h+this.x,(e.y-this.y)*h+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var m=Math.cos,e=Math.sin,h=Math.tan,l=Two.Matrix=function(e,c,g,f,a,h){this.elements=new Two.Array(9);var l=e;_.isArray(l)||(l=_.toArray(arguments));this.identity().set(l)};_.extend(l,{Identity:[1,0,0,0,1,0,0,0,1]});_.extend(l.prototype,{set:function(e,c,g,f,a,h){var l=e;_.isArray(l)||(l=_.toArray(arguments));_.each(l,function(a,c){_.isNumber(a)&&(this.elements[c]=a)},this);return this},identity:function(){this.set(l.Identity);return this},multiply:function(e,c,g,f,a,h,l,m,
z){var n=arguments,u=n.length;if(1>=u)return _.each(this.elements,function(a,c){this.elements[c]=a*e},this),this;if(3>=u)return e=e||0,c=c||0,g=g||0,a=this.elements,{x:a[0]*e+a[1]*c+a[2]*g,y:a[3]*e+a[4]*c+a[5]*g,z:a[6]*e+a[7]*c+a[8]*g};u=this.elements;A0=u[0];A1=u[1];A2=u[2];A3=u[3];A4=u[4];A5=u[5];A6=u[6];A7=u[7];A8=u[8];B0=n[0];B1=n[1];B2=n[2];B3=n[3];B4=n[4];B5=n[5];B6=n[6];B7=n[7];B8=n[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;
this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this},scale:function(e,c){1>=arguments.length&&(c=e);return this.multiply(e,0,0,0,c,0,0,0,1)},rotate:function(k){var c=m(k);k=e(k);return this.multiply(c,-k,0,k,c,0,0,0,1)},translate:function(e,c){return this.multiply(1,0,e,0,1,c,0,0,1)},skewX:function(e){e=h(e);return this.multiply(1,
e,0,0,1,0,0,0,1)},skewY:function(e){e=h(e);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(){var e=this.elements,c=e[0].toFixed(3),g=e[1].toFixed(3),f=e[2].toFixed(3),a=e[3].toFixed(3),h=e[4].toFixed(3),e=e[5].toFixed(3);return[c,a,g,h,f,e].join(" ")},clone:function(){return new Two.Matrix(this.elements.slice(0))}})})();(function(){var m=Two.Shape=function(e){this._matrix=new Two.Matrix;var h=_.debounce(_.bind(function(){var e=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation).toString();this.trigger(Two.Events.change,this.id,"matrix",e)},this),0);this._rotation="rotation";Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e;h()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(e){this._scale=e;h()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,h);if(e)return this;m.MakeGetterSetter(this,m.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.miter=this.join=this.cap="round"};_.extend(m,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(e,h){_.isArray(h)||(h=[h]);_.each(h,function(h){var k="_"+h;Object.defineProperty(e,
h,{get:function(){return this[k]},set:function(c){this[k]=c;this.trigger(Two.Events.change,this.id,h,c,this)}})})}});_.extend(m.prototype,Backbone.Events,{addTo:function(e){e.add(this);return this},noFill:function(){this.fill="none";return this},noStroke:function(){this.stroke="none";return this},clone:function(){var e=new m;e.translation.copy(this.translation);_.each(m.Properties,function(h){e[h]=this[h]},this);return this}})})();(function(){var m=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;m.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(m,{MakeGetterSetter:function(e,h){_.isArray(h)||(h=[h]);_.each(h,function(h){var k="_"+h;Object.defineProperty(e,h,{get:function(){return this[k]},set:function(c){this[k]=c;_.each(this.children,function(e){e[h]=c})}})})}});_.extend(m.prototype,
Two.Shape.prototype,{add:function(e){var h=e,l=this.children,k=this.parent,c=[];_.isArray(e)||(h=_.toArray(arguments));var g=_.bind(function(c,a,e,g,h){this.trigger(Two.Events.change,c,a,e,g,h)},this);_.each(h,function(e){var a=e.id,h=e.parent;_.isUndefined(a)&&(k.add(e),a=e.id);_.isUndefined(l[a])&&(h&&delete h.children[a],l[a]=e,e.parent=this,e.unbind(Two.Events.change).bind(Two.Events.change,g),c.push(a))},this);0<c.length&&this.trigger(Two.Events.change,this.id,"hierarchy",c);return this},getBoundingClientRect:function(){var e=
Infinity,h=-Infinity,l=Infinity,k=-Infinity;_.each(this.children,function(c){c=c.getBoundingClientRect();l=Math.min(c.top,l);e=Math.min(c.left,e);h=Math.max(c.right,h);k=Math.max(c.bottom,k)},this);var c=this._matrix.multiply(e,l,1),g=this._matrix.multiply(h,k,1);return{top:c.y,left:c.x,right:g.x,bottom:g.y,width:g.x-c.x,height:g.y-c.y}},noFill:function(){_.each(this.children,function(e){e.noFill()});return this},noStroke:function(){_.each(this.children,function(e){e.noStroke()});return this}})})();(function(){var m=Math.min,e=Math.max,h=Math.round,l=Two.Polygon=function(k,c,g){Two.Shape.call(this);c=!!c;g=!!g;var f=0,a=1,l=!1,t=_.debounce(_.bind(function(){var c,e;if(l){c=this.vertices.length;c-=1;e=h(f*c);c=h(a*c);for(k.length=0;e<c+1;e++){var g=this.vertices[e];k.push({x:g.x,y:g.y})}l=!1}this.trigger(Two.Events.change,this.id,"vertices",k,this.closed,this.curved)},this),0);Object.defineProperty(this,"closed",{get:function(){return c},set:function(a){c=!!a;t()}});Object.defineProperty(this,
"curved",{get:function(){return g},set:function(a){g=!!a;t()}});Object.defineProperty(this,"beginning",{get:function(){return f},set:function(a){f=m(e(a,0),1);l=!0;t()}});Object.defineProperty(this,"ending",{get:function(){return a},set:function(c){a=m(e(c,0),1);l=!0;t()}});this.vertices=k.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,t)},this)};_.extend(l,{});_.extend(l.prototype,Two.Shape.prototype,{clone:function(){var e=_.map(this.vertices,function(c){return new Two.Vector(c.x,
c.y)}),c=new l(e,this.closed,this.curved);_.each(Two.Shape.Properties,function(e){c[e]=this[e]},this);c.translation.copy(this.translation);c.rotation=this.rotation;c.scale=this.scale;return c},getBoundingClientRect:function(){var e=this.linewidth,c=Infinity,g=-Infinity,f=Infinity,a=-Infinity;_.each(this.vertices,function(e){var h=e.x;e=e.y;f=Math.min(e,f);c=Math.min(h,c);g=Math.max(h,g);a=Math.max(e,a)});var f=f-e,c=c-e,g=g+e,a=a+e,e=this._matrix.multiply(c,f,1),h=this._matrix.multiply(g,a,1);return{top:e.y,
left:e.x,right:h.x,bottom:h.y,width:h.x-e.x,height:h.y-e.y}}})})();
