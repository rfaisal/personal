(function(){function n(a,k,p){if(a===k)return 0!==a||1/a==1/k;if(null==a||null==k)return a===k;a._chain&&(a=a._wrapped);k._chain&&(k=k._wrapped);if(a.isEqual&&d.isFunction(a.isEqual))return a.isEqual(k);if(k.isEqual&&d.isFunction(k.isEqual))return k.isEqual(a);var y=b.call(a);if(y!=b.call(k))return!1;switch(y){case "[object String]":return a==String(k);case "[object Number]":return a!=+a?k!=+k:0==a?1/a==1/k:a==+k;case "[object Date]":case "[object Boolean]":return+a==+k;case "[object RegExp]":return a.source==
k.source&&a.global==k.global&&a.multiline==k.multiline&&a.ignoreCase==k.ignoreCase}if("object"!=typeof a||"object"!=typeof k)return!1;for(var c=p.length;c--;)if(p[c]==a)return!0;p.push(a);var c=0,f=!0;if("[object Array]"==y){if(c=a.length,f=c==k.length)for(;c--&&(f=c in a==c in k&&n(a[c],k[c],p)););}else{if("constructor"in a!="constructor"in k||a.constructor!=k.constructor)return!1;for(var l in a)if(d.has(a,l)&&(c++,!(f=d.has(k,l)&&n(a[l],k[l],p))))break;if(f){for(l in k)if(d.has(k,l)&&!c--)break;
f=!c}}p.pop();return f}var e=this,h=e._,m={},j=Array.prototype,c=Object.prototype,g=j.slice,f=j.unshift,b=c.toString,l=c.hasOwnProperty,u=j.forEach,z=j.map,B=j.reduce,q=j.reduceRight,t=j.filter,K=j.every,L=j.some,G=j.indexOf,H=j.lastIndexOf,c=Array.isArray,C=Object.keys,s=Function.prototype.bind,d=function(a){return new D(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports._=d):e._=d;d.VERSION="1.3.3";var r=d.each=d.forEach=function(a,
k,p){if(null!=a)if(u&&a.forEach===u)a.forEach(k,p);else if(a.length===+a.length)for(var y=0,b=a.length;y<b&&!(y in a&&k.call(p,a[y],y,a)===m);y++);else for(y in a)if(d.has(a,y)&&k.call(p,a[y],y,a)===m)break};d.map=d.collect=function(a,k,d){var b=[];if(null==a)return b;if(z&&a.map===z)return a.map(k,d);r(a,function(a,c,f){b[b.length]=k.call(d,a,c,f)});a.length===+a.length&&(b.length=a.length);return b};d.reduce=d.foldl=d.inject=function(a,k,p,b){var c=2<arguments.length;null==a&&(a=[]);if(B&&a.reduce===
B)return b&&(k=d.bind(k,b)),c?a.reduce(k,p):a.reduce(k);r(a,function(a,d,f){c?p=k.call(b,p,a,d,f):(p=a,c=!0)});if(!c)throw new TypeError("Reduce of empty array with no initial value");return p};d.reduceRight=d.foldr=function(a,k,p,b){var c=2<arguments.length;null==a&&(a=[]);if(q&&a.reduceRight===q)return b&&(k=d.bind(k,b)),c?a.reduceRight(k,p):a.reduceRight(k);var f=d.toArray(a).reverse();b&&!c&&(k=d.bind(k,b));return c?d.reduce(f,k,p,b):d.reduce(f,k)};d.find=d.detect=function(a,k,d){var b;v(a,function(a,
c,f){if(k.call(d,a,c,f))return b=a,!0});return b};d.filter=d.select=function(a,d,p){var b=[];if(null==a)return b;if(t&&a.filter===t)return a.filter(d,p);r(a,function(a,c,f){d.call(p,a,c,f)&&(b[b.length]=a)});return b};d.reject=function(a,d,p){var b=[];if(null==a)return b;r(a,function(a,c,f){d.call(p,a,c,f)||(b[b.length]=a)});return b};d.every=d.all=function(a,d,p){var b=!0;if(null==a)return b;if(K&&a.every===K)return a.every(d,p);r(a,function(a,c,f){if(!(b=b&&d.call(p,a,c,f)))return m});return!!b};
var v=d.some=d.any=function(a,k,p){k||(k=d.identity);var b=!1;if(null==a)return b;if(L&&a.some===L)return a.some(k,p);r(a,function(a,d,c){if(b||(b=k.call(p,a,d,c)))return m});return!!b};d.include=d.contains=function(a,d){var p=!1;return null==a?p:G&&a.indexOf===G?-1!=a.indexOf(d):p=v(a,function(a){return a===d})};d.invoke=function(a,k){var p=g.call(arguments,2);return d.map(a,function(a){return(d.isFunction(k)?k||a:a[k]).apply(a,p)})};d.pluck=function(a,k){return d.map(a,function(a){return a[k]})};
d.max=function(a,k,p){if(!k&&d.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!k&&d.isEmpty(a))return-Infinity;var b={computed:-Infinity};r(a,function(a,d,c){d=k?k.call(p,a,d,c):a;d>=b.computed&&(b={value:a,computed:d})});return b.value};d.min=function(a,k,b){if(!k&&d.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!k&&d.isEmpty(a))return Infinity;var c={computed:Infinity};r(a,function(a,d,f){d=k?k.call(b,a,d,f):a;d<c.computed&&(c={value:a,computed:d})});return c.value};d.shuffle=
function(a){var d=[],b;r(a,function(a,c){b=Math.floor(Math.random()*(c+1));d[c]=d[b];d[b]=a});return d};d.sortBy=function(a,k,b){var c=d.isFunction(k)?k:function(a){return a[k]};return d.pluck(d.map(a,function(a,d,k){return{value:a,criteria:c.call(b,a,d,k)}}).sort(function(a,d){var k=a.criteria,b=d.criteria;return void 0===k?1:void 0===b?-1:k<b?-1:k>b?1:0}),"value")};d.groupBy=function(a,k){var b={},c=d.isFunction(k)?k:function(a){return a[k]};r(a,function(a,d){var k=c(a,d);(b[k]||(b[k]=[])).push(a)});
return b};d.sortedIndex=function(a,k,b){b||(b=d.identity);for(var c=0,f=a.length;c<f;){var l=c+f>>1;b(a[l])<b(k)?c=l+1:f=l}return c};d.toArray=function(a){return!a?[]:d.isArray(a)||d.isArguments(a)?g.call(a):a.toArray&&d.isFunction(a.toArray)?a.toArray():d.values(a)};d.size=function(a){return d.isArray(a)?a.length:d.keys(a).length};d.first=d.head=d.take=function(a,d,b){return null!=d&&!b?g.call(a,0,d):a[0]};d.initial=function(a,d,b){return g.call(a,0,a.length-(null==d||b?1:d))};d.last=function(a,
d,b){return null!=d&&!b?g.call(a,Math.max(a.length-d,0)):a[a.length-1]};d.rest=d.tail=function(a,d,b){return g.call(a,null==d||b?1:d)};d.compact=function(a){return d.filter(a,function(a){return!!a})};d.flatten=function(a,b){return d.reduce(a,function(a,c){if(d.isArray(c))return a.concat(b?c:d.flatten(c));a[a.length]=c;return a},[])};d.without=function(a){return d.difference(a,g.call(arguments,1))};d.uniq=d.unique=function(a,b,c){c=c?d.map(a,c):a;var f=[];3>a.length&&(b=!0);d.reduce(c,function(c,p,
l){if(b?d.last(c)!==p||!c.length:!d.include(c,p))c.push(p),f.push(a[l]);return c},[]);return f};d.union=function(){return d.uniq(d.flatten(arguments,!0))};d.intersection=d.intersect=function(a){var b=g.call(arguments,1);return d.filter(d.uniq(a),function(a){return d.every(b,function(b){return 0<=d.indexOf(b,a)})})};d.difference=function(a){var b=d.flatten(g.call(arguments,1),!0);return d.filter(a,function(a){return!d.include(b,a)})};d.zip=function(){for(var a=g.call(arguments),b=d.max(d.pluck(a,"length")),
c=Array(b),f=0;f<b;f++)c[f]=d.pluck(a,""+f);return c};d.indexOf=function(a,b,c){if(null==a)return-1;var f;if(c)return c=d.sortedIndex(a,b),a[c]===b?c:-1;if(G&&a.indexOf===G)return a.indexOf(b);c=0;for(f=a.length;c<f;c++)if(c in a&&a[c]===b)return c;return-1};d.lastIndexOf=function(a,d){if(null==a)return-1;if(H&&a.lastIndexOf===H)return a.lastIndexOf(d);for(var b=a.length;b--;)if(b in a&&a[b]===d)return b;return-1};d.range=function(a,d,b){1>=arguments.length&&(d=a||0,a=0);b=arguments[2]||1;for(var c=
Math.max(Math.ceil((d-a)/b),0),f=0,l=Array(c);f<c;)l[f++]=a,a+=b;return l};var w=function(){};d.bind=function(a,b){var c,f;if(a.bind===s&&s)return s.apply(a,g.call(arguments,1));if(!d.isFunction(a))throw new TypeError;f=g.call(arguments,2);return c=function(){if(!(this instanceof c))return a.apply(b,f.concat(g.call(arguments)));w.prototype=a.prototype;var d=new w,l=a.apply(d,f.concat(g.call(arguments)));return Object(l)===l?l:d}};d.bindAll=function(a){var b=g.call(arguments,1);0==b.length&&(b=d.functions(a));
r(b,function(b){a[b]=d.bind(a[b],a)});return a};d.memoize=function(a,b){var c={};b||(b=d.identity);return function(){var f=b.apply(this,arguments);return d.has(c,f)?c[f]:c[f]=a.apply(this,arguments)}};d.delay=function(a,d){var b=g.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},d)};d.defer=function(a){return d.delay.apply(d,[a,1].concat(g.call(arguments,1)))};d.throttle=function(a,b){var c,f,l,g,e,j,u=d.debounce(function(){e=g=!1},b);return function(){c=this;f=arguments;l||
(l=setTimeout(function(){l=null;e&&a.apply(c,f);u()},b));g?e=!0:j=a.apply(c,f);u();g=!0;return j}};d.debounce=function(a,d,b){var c;return function(){var f=this,l=arguments;b&&!c&&a.apply(f,l);clearTimeout(c);c=setTimeout(function(){c=null;b||a.apply(f,l)},d)}};d.once=function(a){var d=!1,b;return function(){if(d)return b;d=!0;return b=a.apply(this,arguments)}};d.wrap=function(a,d){return function(){var b=[a].concat(g.call(arguments,0));return d.apply(this,b)}};d.compose=function(){var a=arguments;
return function(){for(var d=arguments,b=a.length-1;0<=b;b--)d=[a[b].apply(this,d)];return d[0]}};d.after=function(a,d){return 0>=a?d():function(){if(1>--a)return d.apply(this,arguments)}};d.keys=C||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)d.has(a,c)&&(b[b.length]=c);return b};d.values=function(a){return d.map(a,d.identity)};d.functions=d.methods=function(a){var b=[],c;for(c in a)d.isFunction(a[c])&&b.push(c);return b.sort()};d.extend=function(a){r(g.call(arguments,
1),function(d){for(var b in d)a[b]=d[b]});return a};d.pick=function(a){var b={};r(d.flatten(g.call(arguments,1)),function(d){d in a&&(b[d]=a[d])});return b};d.defaults=function(a){r(g.call(arguments,1),function(d){for(var b in d)null==a[b]&&(a[b]=d[b])});return a};d.clone=function(a){return!d.isObject(a)?a:d.isArray(a)?a.slice():d.extend({},a)};d.tap=function(a,d){d(a);return a};d.isEqual=function(a,d){return n(a,d,[])};d.isEmpty=function(a){if(null==a)return!0;if(d.isArray(a)||d.isString(a))return 0===
a.length;for(var b in a)if(d.has(a,b))return!1;return!0};d.isElement=function(a){return!!(a&&1==a.nodeType)};d.isArray=c||function(a){return"[object Array]"==b.call(a)};d.isObject=function(a){return a===Object(a)};d.isArguments=function(a){return"[object Arguments]"==b.call(a)};d.isArguments(arguments)||(d.isArguments=function(a){return!(!a||!d.has(a,"callee"))});d.isFunction=function(a){return"[object Function]"==b.call(a)};d.isString=function(a){return"[object String]"==b.call(a)};d.isNumber=function(a){return"[object Number]"==
b.call(a)};d.isFinite=function(a){return d.isNumber(a)&&isFinite(a)};d.isNaN=function(a){return a!==a};d.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==b.call(a)};d.isDate=function(a){return"[object Date]"==b.call(a)};d.isRegExp=function(a){return"[object RegExp]"==b.call(a)};d.isNull=function(a){return null===a};d.isUndefined=function(a){return void 0===a};d.has=function(a,d){return l.call(a,d)};d.noConflict=function(){e._=h;return this};d.identity=function(a){return a};d.times=
function(a,d,b){for(var c=0;c<a;c++)d.call(b,c)};d.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.result=function(a,b){if(null==a)return null;var c=a[b];return d.isFunction(c)?c.call(a):c};d.mixin=function(a){r(d.functions(a),function(b){var c=d[b]=a[b];D.prototype[b]=function(){var a=g.call(arguments);f.call(a,this._wrapped);return I(c.apply(d,a),this._chain)}})};var E=0;d.uniqueId=
function(a){var d=E++;return a?a+d:d};d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var x=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},F;for(F in A)A[A[F]]=F;var M=/\\|'|\r|\n|\t|\u2028|\u2029/g,N=/\\(\\|'|r|n|t|u2028|u2029)/g,J=function(a){return a.replace(N,function(a,d){return A[d]})};d.template=function(a,b,c){c=d.defaults(c||{},d.templateSettings);a="__p+='"+a.replace(M,function(a){return"\\"+A[a]}).replace(c.escape||
x,function(a,d){return"'+\n_.escape("+J(d)+")+\n'"}).replace(c.interpolate||x,function(a,d){return"'+\n("+J(d)+")+\n'"}).replace(c.evaluate||x,function(a,d){return"';\n"+J(d)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var f=new Function(c.variable||"obj","_",a);if(b)return f(b,d);b=function(a){return f.call(this,a,d)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};
d.chain=function(a){return d(a).chain()};var D=function(a){this._wrapped=a};d.prototype=D.prototype;var I=function(a,b){return b?d(a).chain():a};d.mixin(d);r("pop push reverse shift sort splice unshift".split(" "),function(a){var d=j[a];D.prototype[a]=function(){var b=this._wrapped;d.apply(b,arguments);var c=b.length;("shift"==a||"splice"==a)&&0===c&&delete b[0];return I(b,this._chain)}});r(["concat","join","slice"],function(a){var d=j[a];D.prototype[a]=function(){return I(d.apply(this._wrapped,arguments),
this._chain)}});D.prototype.chain=function(){this._chain=!0;return this};D.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var n=[].slice,e=/\s+/,h=function(c,g,f,b){if(!f)return!0;if("object"===typeof f)for(var l in f)c[g].apply(c,[l,f[l]].concat(b));else if(e.test(f)){f=f.split(e);l=0;for(var j=f.length;l<j;l++)c[g].apply(c,[f[l]].concat(b))}else return!0},m=function(c,g,f){var b;c=-1;var l=g.length;switch(f.length){case 0:for(;++c<l;)(b=g[c]).callback.call(b.ctx);break;case 1:for(;++c<l;)(b=g[c]).callback.call(b.ctx,f[0]);break;case 2:for(;++c<l;)(b=g[c]).callback.call(b.ctx,f[0],f[1]);break;case 3:for(;++c<
l;)(b=g[c]).callback.call(b.ctx,f[0],f[1],f[2]);break;default:for(;++c<l;)(b=g[c]).callback.apply(b.ctx,f)}},j=Backbone.Events={on:function(c,g,f){if(!h(this,"on",c,[g,f])||!g)return this;this._events||(this._events={});(this._events[c]||(this._events[c]=[])).push({callback:g,context:f,ctx:f||this});return this},once:function(c,g,f){if(!h(this,"once",c,[g,f])||!g)return this;var b=this,l=_.once(function(){b.off(c,l);g.apply(this,arguments)});l._callback=g;this.on(c,l,f);return this},off:function(c,
g,f){var b,l,e,j,B,q,t,m;if(!this._events||!h(this,"off",c,[g,f]))return this;if(!c&&!g&&!f)return this._events={},this;j=c?[c]:_.keys(this._events);B=0;for(q=j.length;B<q;B++)if(c=j[B],b=this._events[c]){e=[];if(g||f){t=0;for(m=b.length;t<m;t++)l=b[t],(g&&g!==(l.callback._callback||l.callback)||f&&f!==l.context)&&e.push(l)}this._events[c]=e}return this},trigger:function(c){if(!this._events)return this;var e=n.call(arguments,1);if(!h(this,"trigger",c,e))return this;var f=this._events[c],b=this._events.all;
f&&m(this,f,e);b&&m(this,b,arguments);return this},listenTo:function(c,e,f){var b=this._listeners||(this._listeners={}),l=c._listenerId||(c._listenerId=_.uniqueId("l"));b[l]=c;c.on(e,f||this,this);return this},stopListening:function(c,e,f){var b=this._listeners;if(b){if(c)c.off(e,f,this),!e&&!f&&delete b[c._listenerId];else{for(var l in b)b[l].off(null,null,this);this._listeners={}}return this}}};j.bind=j.on;j.unbind=j.off})();(function(){for(var n=0,e=["ms","moz","webkit","o"],h=0;h<e.length&&!window.requestAnimationFrame;++h)window.requestAnimationFrame=window[e[h]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[h]+"CancelAnimationFrame"]||window[e[h]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var j=(new Date).getTime(),c=Math.max(0,16-(j-n)),g=window.setTimeout(function(){e(j+c)},c);n=j+c;return g});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(e){clearTimeout(e)})})();(function(){function n(){var b=document.body.getBoundingClientRect(),c=this.width=b.width,b=this.height=b.height;this.renderer.setSize(c,b);this.trigger(f.Events.resize,c,b)}var e=this,h=e.Two||{},m=2*Math.PI,j=Math.cos,c=Math.sin,g={hasEventListeners:_.isFunction(e.addEventListener),bind:function(b,c,f,e){this.hasEventListeners?b.addEventListener(c,f,!!e):b.attachEvent("on"+c,f);return this},unbind:function(b,c,f,e){this.hasEventListeners?b.removeEventListeners(c,f,!!e):b.detachEvent("on"+c,f);return this}},
f=e.Two=function(b){b=_.defaults(b||{},{fullscreen:!1,width:640,height:480,type:f.Types.svg,autostart:!0});this.type=b.type;this.renderer=new f[this.type](this);this.playing=b.autostart;this.frameCount=0;b.fullscreen?(b=_.bind(n,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),g.bind(window,"resize",b),b()):(this.renderer.setSize(b.width,b.height),this.width=b.width,this.height=b.height);this.scene=new f.Group;this.renderer.add(this.scene);
f.Instances.push(this)};_.extend(f,{Array:e.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,Instances:[],noConflict:function(){e.Two=h;return this}});_.extend(f.prototype,Backbone.Events,{appendTo:function(b){b.appendChild(this.renderer.domElement);return this},play:function(){this.playing=!0;return this.trigger(f.Events.play)},
pause:function(){this.playing=!1;return this.trigger(f.Events.pause)},update:function(){this.frameCount++;var b=this.width,c=this.height,e=this.renderer;(b!==e.width||c!==e.height)&&e.setSize(b,c);return this.trigger(f.Events.update,this.frameCount)},render:function(){this.renderer.render();return this.trigger(f.Events.render,this.frameCount)},add:function(b){var c=b;_.isArray(b)||(c=_.toArray(arguments));this.scene.add(c);return this},makeLine:function(b,c,e,j){e=(e-b)/2;j=(j-c)/2;var g=[new f.Vector(-e,
-j),new f.Vector(e,j)],g=(new f.Polygon(g)).noFill();g.translation.set(b+e,c+j);this.scene.add(g);return g},makeRectangle:function(b,c,e,j){e/=2;j/=2;j=[new f.Vector(e,j),new f.Vector(-e,j),new f.Vector(-e,-j),new f.Vector(e,-j)];j=new f.Polygon(j,!0);j.translation.set(b,c);this.scene.add(j);return j},makeCircle:function(b,c,f){return this.makeEllipse(b,c,f,f)},makeEllipse:function(b,e,g,h){var B=f.Resolution,q=_.map(_.range(B),function(b){var e=b/B*m;b=g*j(e);e=h*c(e);return new f.Vector(b,e)},this),
q=new f.Polygon(q,!0,!0);q.translation.set(b,e);this.scene.add(q);return q},makeCurve:function(b){var c=arguments.length,e=b;if(!_.isArray(b))for(var e=[],j=0;j<c;j+=2){var g=arguments[j];if(!_.isNumber(g))break;e.push(new f.Vector(g,arguments[j+1]))}var c=arguments[c-1],e=new f.Polygon(e,!(_.isBoolean(c)&&c),!0),c=e.getBoundingClientRect(),q=c.left+c.width/2,h=c.top+c.height/2;_.each(e.vertices,function(b){b.x-=q;b.y-=h});e.translation.set(q,h);this.scene.add(e);return e},makePolygon:function(b){var c=
arguments.length,e=b;if(!_.isArray(b))for(var e=[],j=0;j<c;j+=2){var g=arguments[j];if(!_.isNumber(g))break;e.push(new f.Vector(g,arguments[j+1]))}var c=arguments[c-1],e=new f.Polygon(e,!(_.isBoolean(c)&&c)),c=e.getBoundingClientRect(),q=c.left+c.width/2,h=c.top+c.height/2;_.each(e.vertices,function(b){b.x-=q;b.y-=h});e.translation.set(q,h);this.scene.add(e);return e},makeGroup:function(b){var c=b;_.isArray(b)||(c=_.toArray(arguments));var e=new f.Group;this.scene.add(e);e.add(c);return e},importSVG:function(){}});
(function(){_.each(f.Instances,function(b){b.playing&&b.update().render()});requestAnimationFrame(arguments.callee)})()})();(function(){function n(b){var c={},f=b.translation,e=b.rotation,j=b.scale,g=b.stroke,l=b.linewidth,h=b.fill,m=b.opacity,d=b.visible,n=b.cap,v=b.join,w=b.miter,E=b.curved,x=b.closed,A=b.vertices;b.id&&(c.id=z.Identifier+b.id);f&&(_.isNumber(j)&&_.isNumber(e))&&(c.transform="translate("+f.x+","+f.y+") scale("+j+") rotate("+e+")");g&&(c.stroke=g);h&&(c.fill=h);m&&(c["stroke-opacity"]=c["fill-opacity"]=m);d&&(c.visibility=d?"visible":"hidden");n&&(c["stroke-linecap"]=n);v&&(c["stroke-linejoin"]=v);w&&
(c["stroke-miterlimit"]=w);l&&(c["stroke-width"]=l);A&&(c.d=u.toString(A,x,E));return c}function e(b,c){var e=b.x-c.x,j=b.y-c.y;return f(e*e+j*j)}function h(b,c){for(;0>b;)b+=c;return b%c}var m=0,j=Math.sin,c=Math.cos,g=Math.atan2,f=Math.sqrt,b=Math.PI,l=b/2,u={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(b,c){var f=b.toLowerCase(),e=document.createElementNS(this.ns,f);"svg"===f&&(c=_.defaults(c||{},{version:this.version}));_.isObject(c)&&
this.setAttributes(e,c);return e},setAttributes:function(b,c){_.each(c,function(b,c){this.setAttribute(c,b)},b);return this},removeAttributes:function(b,c){_.each(c,function(b){this.removeAttribute(b)},b);return this},toString:function(f,q,m){var n=f.length,u=n-1;if(!m)return _.map(f,function(b,d){var c;c=(0>=d?"M":"L")+(" "+b.x.toFixed(3)+" "+b.y.toFixed(3));d>=u&&q&&(c+=" Z");return c}).join(" ");var z=[];m=f.length;for(var H=m-1,C=0;C<m;C++){var s=f[C],s={x:s.x,y:s.y};z.push(s);var d=q?h(C-1,m):
Math.max(C-1,0),r=q?h(C+1,m):Math.min(C+1,H);var v=f[d],d=s,w=f[r],r=g(v.y-d.y,v.x-d.x),E=g(w.y-d.y,w.x-d.x),v=e(v,d),w=e(w,d),x=(r+E)/2,A=void 0,F=void 0;1E-4>v||1E-4>w?(d.u={x:d.x,y:d.y},d.v={x:d.x,y:d.y}):(v*=0.33,w*=0.33,x=E<r?x+l:x-l,A={x:d.x+c(x)*v,y:d.y+j(x)*v},x-=b,F={x:d.x+c(x)*w,y:d.y+j(x)*w},d.u=A,d.v=F);!s.u.x&&!s.u.y&&(s.u.x=s.x,s.u.y=s.y);!s.v.x&&!s.v.y&&(s.v.x=s.x,s.v.y=s.y)}return _.map(z,function(b,d){var c,f=q?h(d-1,n):Math.max(d-1,0),e=q?h(d+1,n):Math.min(d+1,u);c=z[f];var e=z[e],
f=c.v.x.toFixed(3),a=c.v.y.toFixed(3),j=b.u.x.toFixed(3),g=b.u.y.toFixed(3),l=b.x.toFixed(3),m=b.y.toFixed(3);c=0>=d?"M "+l+" "+m:"C "+f+" "+a+" "+j+" "+g+" "+l+" "+m;d>=u&&q&&(f=b.v.x.toFixed(3),a=b.v.y.toFixed(3),j=e.u.x.toFixed(3),g=e.u.y.toFixed(3),l=e.x.toFixed(3),m=e.y.toFixed(3),c=c+(" C "+f+" "+a+" "+j+" "+g+" "+l+" "+m)+" Z");return c}).join(" ")}},z=Two[Two.Types.svg]=function(){this.domElement=u.createElement("svg");this.elements=[];this.commands=[]};_.extend(z,{Identifier:"two-"});_.extend(z.prototype,
Backbone.Events,{setSize:function(b,c){this.width=b;this.height=c;u.setAttributes(this.domElement,{width:b,height:c});return this},add:function(b){var c=b,f=this.elements,e=this.domElement;_.isArray(b)||(c=_.map(arguments,function(b){return b}));_.each(c,function(b){var c;c=b instanceof Two.Group;if(_.isUndefined(b.id)){var j=m;m++;b.id=j}c?(c="g",_.isUndefined(b.parent)&&(b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),b=n(b),delete b.stroke,delete b.fill,
delete b["fill-opacity"],delete b["stroke-opacity"],delete b["stroke-linecap"],delete b["stroke-linejoin"],delete b["stroke-miterlimit"],delete b["stroke-width"]):(c="path",b=n(b));b=u.createElement(c,b);e.appendChild(b);f.push(b)},this);return this},update:function(b,c,f){this.commands.push(arguments);return this},render:function(){var b=this.elements;_.each(this.commands,function(c){var f=c[1],e=c[2],j=c[3],g=c[4],l=b[c[0]];switch(f){case Two.Properties.hierarchy:_.each(e,function(c){l.appendChild(b[c])});
break;default:a:{c=f;switch(c){case "matrix":c="transform";e="matrix("+e+")";break;case "visible":c="visibility";e=e?"visible":"hidden";break;case "cap":c="stroke-linecap";break;case "join":c="stroke-linejoin";break;case "miter":c="stroke-miterlimit";break;case "linewidth":c="stroke-width";break;case "vertices":c="d";e=u.toString(e,j,g);break;case "opacity":u.setAttributes(l,{"stroke-opacity":opacity,"fill-opacity":opacity});break a}l.setAttribute(c,e)}}},this);this.commands.length=0;return this}})})();(function(){var n=Two.Vector=function(e,h){e=e||0;h=h||0;Object.defineProperty(this,"x",{get:function(){return e},set:function(h){e=h;this.trigger("change","x")}});Object.defineProperty(this,"y",{get:function(){return h},set:function(e){h=e;this.trigger("change","y")}})};_.extend(n,{});_.extend(n.prototype,Backbone.Events,{set:function(e,h){this.x=e;this.y=h;return this},copy:function(e){this.x=e.x;this.y=e.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new n(this.x,
this.y)},add:function(e,h){this.x=e.x+h.x;this.y=e.y+h.y;return this},addSelf:function(e){this.x+=e.x;this.y+=e.y;return this},sub:function(e,h){this.x=e.x-h.x;this.y=e.y-h.y;return this},subSelf:function(e){this.x-=e.x;this.y-=e.y;return this},multiplySelf:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){e?(this.x/=e,this.y/=e):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*
e.x+this.y*e.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var h=this.x-e.x;e=this.y-e.y;return h*h+e*e},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,h){return this.set((e.x-this.x)*
h+this.x,(e.y-this.y)*h+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var n=Math.cos,e=Math.sin,h=Math.tan,m=Two.Matrix=function(e,c,g,f,b,l){this.elements=new Two.Array(9);var h=e;_.isArray(h)||(h=_.toArray(arguments));this.identity().set(h)};_.extend(m,{Identity:[1,0,0,0,1,0,0,0,1]});_.extend(m.prototype,{set:function(e,c,g,f,b,l){var h=e;_.isArray(h)||(h=_.toArray(arguments));_.each(h,function(b,c){_.isNumber(b)&&(this.elements[c]=b)},this);return this},identity:function(){this.set(m.Identity);return this},multiply:function(e,c,g,f,b,l,h,m,
n){var q=arguments,t=q.length;if(1>=t)return _.each(this.elements,function(b,c){this.elements[c]=b*e},this),this;if(3>=t)return e=e||0,c=c||0,g=g||0,b=this.elements,{x:b[0]*e+b[1]*c+b[2]*g,y:b[3]*e+b[4]*c+b[5]*g,z:b[6]*e+b[7]*c+b[8]*g};t=this.elements;A0=t[0];A1=t[1];A2=t[2];A3=t[3];A4=t[4];A5=t[5];A6=t[6];A7=t[7];A8=t[8];B0=q[0];B1=q[1];B2=q[2];B3=q[3];B4=q[4];B5=q[5];B6=q[6];B7=q[7];B8=q[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;
this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this},scale:function(e,c){1>=arguments.length&&(c=e);return this.multiply(e,0,0,0,c,0,0,0,1)},rotate:function(j){var c=n(j);j=e(j);return this.multiply(c,-j,0,j,c,0,0,0,1)},translate:function(e,c){return this.multiply(1,0,e,0,1,c,0,0,1)},skewX:function(e){e=h(e);return this.multiply(1,
e,0,0,1,0,0,0,1)},skewY:function(e){e=h(e);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(){var e=this.elements,c=e[0].toFixed(3),g=e[1].toFixed(3),f=e[2].toFixed(3),b=e[3].toFixed(3),h=e[4].toFixed(3),e=e[5].toFixed(3);return[c,b,g,h,f,e].join(" ")},clone:function(){return new Two.Matrix(this.elements.slice(0))}})})();(function(){var n=Two.Shape=function(e){this._matrix=new Two.Matrix;var h=_.debounce(_.bind(function(){var e=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation).toString();this.trigger(Two.Events.change,this.id,"matrix",e)},this),0);this._rotation="rotation";Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e;h()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(e){this._scale=e;h()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,h);if(e)return this;n.MakeGetterSetter(this,n.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.miter=this.join=this.cap="round"};_.extend(n,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(e,h){_.isArray(h)||(h=[h]);_.each(h,function(h){var j="_"+h;Object.defineProperty(e,
h,{get:function(){return this[j]},set:function(c){this[j]=c;this.trigger(Two.Events.change,this.id,h,c,this)}})})}});_.extend(n.prototype,Backbone.Events,{addTo:function(e){e.add(this);return this},noFill:function(){this.fill="none";return this},noStroke:function(){this.stroke="none";return this},clone:function(){var e=new n;e.translation.copy(this.translation);_.each(n.Properties,function(h){e[h]=this[h]},this);return this}})})();(function(){var n=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;n.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(n,{MakeGetterSetter:function(e,h){_.isArray(h)||(h=[h]);_.each(h,function(h){var j="_"+h;Object.defineProperty(e,h,{get:function(){return this[j]},set:function(c){this[j]=c;_.each(this.children,function(e){e[h]=c})}})})}});_.extend(n.prototype,
Two.Shape.prototype,{add:function(e){var h=e,m=this.children,j=this.parent,c=[];_.isArray(e)||(h=_.toArray(arguments));var g=_.bind(function(c,b,e,j,g){this.trigger(Two.Events.change,c,b,e,j,g)},this);_.each(h,function(e){var b=e.id,h=e.parent;_.isUndefined(b)&&(j.add(e),b=e.id);_.isUndefined(m[b])&&(h&&delete h.children[b],m[b]=e,e.parent=this,e.unbind(Two.Events.change).bind(Two.Events.change,g),c.push(b))},this);0<c.length&&this.trigger(Two.Events.change,this.id,"hierarchy",c);return this},getBoundingClientRect:function(){var e=
Infinity,h=-Infinity,m=Infinity,j=-Infinity;_.each(this.children,function(c){c=c.getBoundingClientRect();m=Math.min(c.top,m);e=Math.min(c.left,e);h=Math.max(c.right,h);j=Math.max(c.bottom,j)},this);var c=this._matrix.multiply(e,m,1),g=this._matrix.multiply(h,j,1);return{top:c.y,left:c.x,right:g.x,bottom:g.y,width:g.x-c.x,height:g.y-c.y}},noFill:function(){_.each(this.children,function(e){e.noFill()});return this},noStroke:function(){_.each(this.children,function(e){e.noStroke()});return this}})})();(function(){var n=Math.min,e=Math.max,h=Math.round,m=Two.Polygon=function(j,c,g){Two.Shape.call(this);c=!!c;g=!!g;var f=0,b=1,l=!1,m=_.debounce(_.bind(function(){var c,e;if(l){c=this.vertices.length;c-=1;e=h(f*c);c=h(b*c);for(j.length=0;e<c+1;e++){var g=this.vertices[e];j.push({x:g.x,y:g.y})}l=!1}this.trigger(Two.Events.change,this.id,"vertices",j,this.closed,this.curved)},this),0);Object.defineProperty(this,"closed",{get:function(){return c},set:function(b){c=!!b;m()}});Object.defineProperty(this,
"curved",{get:function(){return g},set:function(b){g=!!b;m()}});Object.defineProperty(this,"beginning",{get:function(){return f},set:function(b){f=n(e(b,0),1);l=!0;m()}});Object.defineProperty(this,"ending",{get:function(){return b},set:function(c){b=n(e(c,0),1);l=!0;m()}});this.vertices=j.slice(0);_.each(this.vertices,function(b){b.bind(Two.Events.change,m)},this)};_.extend(m,{});_.extend(m.prototype,Two.Shape.prototype,{clone:function(){var e=_.map(this.vertices,function(c){return new Two.Vector(c.x,
c.y)}),c=new m(e,this.closed,this.curved);_.each(Two.Shape.Properties,function(e){c[e]=this[e]},this);c.translation.copy(this.translation);c.rotation=this.rotation;c.scale=this.scale;return c},getBoundingClientRect:function(){var e=this.linewidth,c=Infinity,g=-Infinity,f=Infinity,b=-Infinity;_.each(this.vertices,function(e){var h=e.x;e=e.y;f=Math.min(e,f);c=Math.min(h,c);g=Math.max(h,g);b=Math.max(e,b)});var f=f-e,c=c-e,g=g+e,b=b+e,e=this._matrix.multiply(c,f,1),h=this._matrix.multiply(g,b,1);return{top:e.y,
left:e.x,right:h.x,bottom:h.y,width:h.x-e.x,height:h.y-e.y}}})})();
