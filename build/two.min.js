(function(){function k(a,b,c){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a._chain&&(a=a._wrapped);b._chain&&(b=b._wrapped);if(a.isEqual&&e.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&e.isFunction(b.isEqual))return b.isEqual(a);var g=m.call(a);if(g!=m.call(b))return!1;switch(g){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==
b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var d=c.length;d--;)if(c[d]==a)return!0;c.push(a);var d=0,f=!0;if("[object Array]"==g){if(d=a.length,f=d==b.length)for(;d--&&(f=d in a==d in b&&k(a[d],b[d],c)););}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var l in a)if(e.has(a,l)&&(d++,!(f=e.has(b,l)&&k(a[l],b[l],c))))break;if(f){for(l in b)if(e.has(b,l)&&!d--)break;
f=!d}}c.pop();return f}var a=this,b=a._,c={},d=Array.prototype,f=Object.prototype,h=d.slice,g=d.unshift,m=f.toString,p=f.hasOwnProperty,n=d.forEach,l=d.map,s=d.reduce,j=d.reduceRight,q=d.filter,y=d.every,r=d.some,u=d.indexOf,t=d.lastIndexOf,f=Array.isArray,A=Object.keys,z=Function.prototype.bind,e=function(a){return new F(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports._=e):a._=e;e.VERSION="1.3.3";var v=e.each=e.forEach=function(a,
b,d){if(null!=a)if(n&&a.forEach===n)a.forEach(b,d);else if(a.length===+a.length)for(var g=0,f=a.length;g<f&&!(g in a&&b.call(d,a[g],g,a)===c);g++);else for(g in a)if(e.has(a,g)&&b.call(d,a[g],g,a)===c)break};e.map=e.collect=function(a,b,c){var e=[];if(null==a)return e;if(l&&a.map===l)return a.map(b,c);v(a,function(a,x,g){e[e.length]=b.call(c,a,x,g)});a.length===+a.length&&(e.length=a.length);return e};e.reduce=e.foldl=e.inject=function(a,b,c,g){var d=2<arguments.length;null==a&&(a=[]);if(s&&a.reduce===
s)return g&&(b=e.bind(b,g)),d?a.reduce(b,c):a.reduce(b);v(a,function(a,e,x){d?c=b.call(g,c,a,e,x):(c=a,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return c};e.reduceRight=e.foldr=function(a,b,c,g){var d=2<arguments.length;null==a&&(a=[]);if(j&&a.reduceRight===j)return g&&(b=e.bind(b,g)),d?a.reduceRight(b,c):a.reduceRight(b);var f=e.toArray(a).reverse();g&&!d&&(b=e.bind(b,g));return d?e.reduce(f,b,c,g):e.reduce(f,b)};e.find=e.detect=function(a,b,c){var e;G(a,function(a,
x,g){if(b.call(c,a,x,g))return e=a,!0});return e};e.filter=e.select=function(a,b,c){var e=[];if(null==a)return e;if(q&&a.filter===q)return a.filter(b,c);v(a,function(a,x,g){b.call(c,a,x,g)&&(e[e.length]=a)});return e};e.reject=function(a,b,c){var e=[];if(null==a)return e;v(a,function(a,x,g){b.call(c,a,x,g)||(e[e.length]=a)});return e};e.every=e.all=function(a,b,e){var g=!0;if(null==a)return g;if(y&&a.every===y)return a.every(b,e);v(a,function(a,x,d){if(!(g=g&&b.call(e,a,x,d)))return c});return!!g};
var G=e.some=e.any=function(a,b,g){b||(b=e.identity);var d=!1;if(null==a)return d;if(r&&a.some===r)return a.some(b,g);v(a,function(a,e,x){if(d||(d=b.call(g,a,e,x)))return c});return!!d};e.include=e.contains=function(a,b){var c=!1;return null==a?c:u&&a.indexOf===u?-1!=a.indexOf(b):c=G(a,function(a){return a===b})};e.invoke=function(a,b){var c=h.call(arguments,2);return e.map(a,function(a){return(e.isFunction(b)?b||a:a[b]).apply(a,c)})};e.pluck=function(a,b){return e.map(a,function(a){return a[b]})};
e.max=function(a,b,c){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&e.isEmpty(a))return-Infinity;var g={computed:-Infinity};v(a,function(a,e,d){e=b?b.call(c,a,e,d):a;e>=g.computed&&(g={value:a,computed:e})});return g.value};e.min=function(a,b,c){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&e.isEmpty(a))return Infinity;var g={computed:Infinity};v(a,function(a,e,d){e=b?b.call(c,a,e,d):a;e<g.computed&&(g={value:a,computed:e})});return g.value};e.shuffle=
function(a){var b=[],c;v(a,function(a,e){c=Math.floor(Math.random()*(e+1));b[e]=b[c];b[c]=a});return b};e.sortBy=function(a,b,c){var g=e.isFunction(b)?b:function(a){return a[b]};return e.pluck(e.map(a,function(a,b,e){return{value:a,criteria:g.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,e=b.criteria;return void 0===c?1:void 0===e?-1:c<e?-1:c>e?1:0}),"value")};e.groupBy=function(a,b){var c={},g=e.isFunction(b)?b:function(a){return a[b]};v(a,function(a,b){var e=g(a,b);(c[e]||(c[e]=[])).push(a)});
return c};e.sortedIndex=function(a,b,c){c||(c=e.identity);for(var g=0,d=a.length;g<d;){var f=g+d>>1;c(a[f])<c(b)?g=f+1:d=f}return g};e.toArray=function(a){return!a?[]:e.isArray(a)||e.isArguments(a)?h.call(a):a.toArray&&e.isFunction(a.toArray)?a.toArray():e.values(a)};e.size=function(a){return e.isArray(a)?a.length:e.keys(a).length};e.first=e.head=e.take=function(a,b,c){return null!=b&&!c?h.call(a,0,b):a[0]};e.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))};e.last=function(a,
b,c){return null!=b&&!c?h.call(a,Math.max(a.length-b,0)):a[a.length-1]};e.rest=e.tail=function(a,b,c){return h.call(a,null==b||c?1:b)};e.compact=function(a){return e.filter(a,function(a){return!!a})};e.flatten=function(a,b){return e.reduce(a,function(a,c){if(e.isArray(c))return a.concat(b?c:e.flatten(c));a[a.length]=c;return a},[])};e.without=function(a){return e.difference(a,h.call(arguments,1))};e.uniq=e.unique=function(a,b,c){c=c?e.map(a,c):a;var g=[];3>a.length&&(b=!0);e.reduce(c,function(c,d,
f){if(b?e.last(c)!==d||!c.length:!e.include(c,d))c.push(d),g.push(a[f]);return c},[]);return g};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=e.intersect=function(a){var b=h.call(arguments,1);return e.filter(e.uniq(a),function(a){return e.every(b,function(b){return 0<=e.indexOf(b,a)})})};e.difference=function(a){var b=e.flatten(h.call(arguments,1),!0);return e.filter(a,function(a){return!e.include(b,a)})};e.zip=function(){for(var a=h.call(arguments),b=e.max(e.pluck(a,"length")),
c=Array(b),g=0;g<b;g++)c[g]=e.pluck(a,""+g);return c};e.indexOf=function(a,b,c){if(null==a)return-1;var g;if(c)return c=e.sortedIndex(a,b),a[c]===b?c:-1;if(u&&a.indexOf===u)return a.indexOf(b);c=0;for(g=a.length;c<g;c++)if(c in a&&a[c]===b)return c;return-1};e.lastIndexOf=function(a,b){if(null==a)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);for(var c=a.length;c--;)if(c in a&&a[c]===b)return c;return-1};e.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);c=arguments[2]||1;for(var e=
Math.max(Math.ceil((b-a)/c),0),g=0,d=Array(e);g<e;)d[g++]=a,a+=c;return d};var H=function(){};e.bind=function(a,b){var c,g;if(a.bind===z&&z)return z.apply(a,h.call(arguments,1));if(!e.isFunction(a))throw new TypeError;g=h.call(arguments,2);return c=function(){if(!(this instanceof c))return a.apply(b,g.concat(h.call(arguments)));H.prototype=a.prototype;var e=new H,d=a.apply(e,g.concat(h.call(arguments)));return Object(d)===d?d:e}};e.bindAll=function(a){var b=h.call(arguments,1);0==b.length&&(b=e.functions(a));
v(b,function(b){a[b]=e.bind(a[b],a)});return a};e.memoize=function(a,b){var c={};b||(b=e.identity);return function(){var g=b.apply(this,arguments);return e.has(c,g)?c[g]:c[g]=a.apply(this,arguments)}};e.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(h.call(arguments,1)))};e.throttle=function(a,b){var c,g,d,f,l,h,j=e.debounce(function(){l=f=!1},b);return function(){c=this;g=arguments;d||
(d=setTimeout(function(){d=null;l&&a.apply(c,g);j()},b));f?l=!0:h=a.apply(c,g);j();f=!0;return h}};e.debounce=function(a,b,c){var e;return function(){var g=this,d=arguments;c&&!e&&a.apply(g,d);clearTimeout(e);e=setTimeout(function(){e=null;c||a.apply(g,d)},b)}};e.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;return c=a.apply(this,arguments)}};e.wrap=function(a,b){return function(){var c=[a].concat(h.call(arguments,0));return b.apply(this,c)}};e.compose=function(){var a=arguments;
return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};e.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};e.keys=A||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)e.has(a,c)&&(b[b.length]=c);return b};e.values=function(a){return e.map(a,e.identity)};e.functions=e.methods=function(a){var b=[],c;for(c in a)e.isFunction(a[c])&&b.push(c);return b.sort()};e.extend=function(a){v(h.call(arguments,
1),function(b){for(var c in b)a[c]=b[c]});return a};e.pick=function(a){var b={};v(e.flatten(h.call(arguments,1)),function(c){c in a&&(b[c]=a[c])});return b};e.defaults=function(a){v(h.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])});return a};e.clone=function(a){return!e.isObject(a)?a:e.isArray(a)?a.slice():e.extend({},a)};e.tap=function(a,b){b(a);return a};e.isEqual=function(a,b){return k(a,b,[])};e.isEmpty=function(a){if(null==a)return!0;if(e.isArray(a)||e.isString(a))return 0===
a.length;for(var b in a)if(e.has(a,b))return!1;return!0};e.isElement=function(a){return!!(a&&1==a.nodeType)};e.isArray=f||function(a){return"[object Array]"==m.call(a)};e.isObject=function(a){return a===Object(a)};e.isArguments=function(a){return"[object Arguments]"==m.call(a)};e.isArguments(arguments)||(e.isArguments=function(a){return!(!a||!e.has(a,"callee"))});e.isFunction=function(a){return"[object Function]"==m.call(a)};e.isString=function(a){return"[object String]"==m.call(a)};e.isNumber=function(a){return"[object Number]"==
m.call(a)};e.isFinite=function(a){return e.isNumber(a)&&isFinite(a)};e.isNaN=function(a){return a!==a};e.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==m.call(a)};e.isDate=function(a){return"[object Date]"==m.call(a)};e.isRegExp=function(a){return"[object RegExp]"==m.call(a)};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.has=function(a,b){return p.call(a,b)};e.noConflict=function(){a._=b;return this};e.identity=function(a){return a};e.times=
function(a,b,c){for(var e=0;e<a;e++)b.call(c,e)};e.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};e.result=function(a,b){if(null==a)return null;var c=a[b];return e.isFunction(c)?c.call(a):c};e.mixin=function(a){v(e.functions(a),function(b){var c=e[b]=a[b];F.prototype[b]=function(){var a=h.call(arguments);g.call(a,this._wrapped);return C(c.apply(e,a),this._chain)}})};var S=0;e.uniqueId=
function(a){var b=S++;return a?a+b:b};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/.^/,K={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},M;for(M in K)K[K[M]]=M;var T=/\\|'|\r|\n|\t|\u2028|\u2029/g,U=/\\(\\|'|r|n|t|u2028|u2029)/g,N=function(a){return a.replace(U,function(a,b){return K[b]})};e.template=function(a,b,c){c=e.defaults(c||{},e.templateSettings);a="__p+='"+a.replace(T,function(a){return"\\"+K[a]}).replace(c.escape||
L,function(a,b){return"'+\n_.escape("+N(b)+")+\n'"}).replace(c.interpolate||L,function(a,b){return"'+\n("+N(b)+")+\n'"}).replace(c.evaluate||L,function(a,b){return"';\n"+N(b)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var g=new Function(c.variable||"obj","_",a);if(b)return g(b,e);b=function(a){return g.call(this,a,e)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};
e.chain=function(a){return e(a).chain()};var F=function(a){this._wrapped=a};e.prototype=F.prototype;var C=function(a,b){return b?e(a).chain():a};e.mixin(e);v("pop push reverse shift sort splice unshift".split(" "),function(a){var b=d[a];F.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var e=c.length;("shift"==a||"splice"==a)&&0===e&&delete c[0];return C(c,this._chain)}});v(["concat","join","slice"],function(a){var b=d[a];F.prototype[a]=function(){return C(b.apply(this._wrapped,arguments),
this._chain)}});F.prototype.chain=function(){this._chain=!0;return this};F.prototype.value=function(){return this._wrapped}}).call(this);var Backbone=Backbone||{};
(function(){var k=[].slice,a=/\s+/,b=function(b,c,g,d){if(!g)return!0;if("object"===typeof g)for(var p in g)b[c].apply(b,[p,g[p]].concat(d));else if(a.test(g)){g=g.split(a);p=0;for(var n=g.length;p<n;p++)b[c].apply(b,[g[p]].concat(d))}else return!0},c=function(a,b,c){var d;a=-1;var p=b.length;switch(c.length){case 0:for(;++a<p;)(d=b[a]).callback.call(d.ctx);break;case 1:for(;++a<p;)(d=b[a]).callback.call(d.ctx,c[0]);break;case 2:for(;++a<p;)(d=b[a]).callback.call(d.ctx,c[0],c[1]);break;case 3:for(;++a<
p;)(d=b[a]).callback.call(d.ctx,c[0],c[1],c[2]);break;default:for(;++a<p;)(d=b[a]).callback.apply(d.ctx,c)}},d=Backbone.Events={on:function(a,c,g){if(!b(this,"on",a,[c,g])||!c)return this;this._events||(this._events={});(this._events[a]||(this._events[a]=[])).push({callback:c,context:g,ctx:g||this});return this},once:function(a,c,g){if(!b(this,"once",a,[c,g])||!c)return this;var d=this,p=_.once(function(){d.off(a,p);c.apply(this,arguments)});p._callback=c;this.on(a,p,g);return this},off:function(a,
c,g){var d,p,n,l,s,j,q,y;if(!this._events||!b(this,"off",a,[c,g]))return this;if(!a&&!c&&!g)return this._events={},this;l=a?[a]:_.keys(this._events);s=0;for(j=l.length;s<j;s++)if(a=l[s],d=this._events[a]){n=[];if(c||g){q=0;for(y=d.length;q<y;q++)p=d[q],(c&&c!==(p.callback._callback||p.callback)||g&&g!==p.context)&&n.push(p)}this._events[a]=n}return this},trigger:function(a){if(!this._events)return this;var d=k.call(arguments,1);if(!b(this,"trigger",a,d))return this;var g=this._events[a],m=this._events.all;
g&&c(this,g,d);m&&c(this,m,arguments);return this},listenTo:function(a,b,c){var d=this._listeners||(this._listeners={}),p=a._listenerId||(a._listenerId=_.uniqueId("l"));d[p]=a;a.on(b,c||this,this);return this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,c,this),!b&&!c&&delete d[a._listenerId];else{for(var p in d)d[p].off(null,null,this);this._listeners={}}return this}}};d.bind=d.on;d.unbind=d.off})();(function(){for(var k=0,a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;++b)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"]||window[a[b]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=(new Date).getTime(),f=Math.max(0,16-(b-k)),h=window.setTimeout(function(){a(b+f)},f);k=b+f;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})})();(function(){var k=this;previousTessellation=k.tessellation;tessellation=k.tessellation={noConflict:function(){k.tessellation=previousTessellation;return this}};tessellation.cmp=function(a,b){return a.y==b.y?a.x-b.x:a.y-b.y};tessellation.equals=function(a,b){return a.x==b.x&&a.y==b.y};tessellation.Edge=function(){this.q=this.p=null;2==arguments.length?arguments[0].y>arguments[1].y?(this.q=arguments[0],this.p=arguments[1]):arguments[0].y==arguments[1].y?arguments[0].x>arguments[1].x?(this.q=arguments[0],
this.p=arguments[1]):arguments[0].x==arguments[1].x?alert("Invalid tessellation.edge constructor call: repeated points!"):(this.p=arguments[0],this.q=arguments[1]):(this.p=arguments[0],this.q=arguments[1]):alert("Invalid tessellation.Edge constructor call!");this.p&&!_.isArray(this.p.edges)&&(this.p.edges=[]);this.q&&!_.isArray(this.q.edges)&&(this.q.edges=[]);this.q.edges.push(this)};tessellation.Triangle=function(a,b,c){this.points=[null,null,null];this.neighbors=[null,null,null];this.interior=
!1;this.constrained_edge=[!1,!1,!1];this.delaunay_edge=[!1,!1,!1];3==arguments.length&&(this.points[0]=a,this.points[1]=b,this.points[2]=c)};tessellation.Triangle.prototype.GetPoint=function(a){return this.points[a]};tessellation.Triangle.prototype.GetNeighbor=function(a){return this.neighbors[a]};tessellation.Triangle.prototype.ContainsP=function(){for(var a=!0,b=0;b<arguments.length;++b)a=a&&(arguments[b].equals(this.points[0])||arguments[b].equals(this.points[1])||arguments[b].equals(this.points[2]));
return a};tessellation.Triangle.prototype.ContainsE=function(){for(var a=!0,b=0;b<arguments.length;++b)a=a&&this.ContainsP(arguments[b].p,arguments[b].q);return a};tessellation.Triangle.prototype.IsInterior=function(){0!=arguments.length&&(this.interior=arguments[0]);return this.interior};tessellation.Triangle.prototype.MarkNeighbor=function(){var a;if(3==arguments.length){var b=arguments[0],c=arguments[1];a=arguments[2];b.equals(this.points[2])&&c.equals(this.points[1])||b.equals(this.points[1])&&
c.equals(this.points[2])?this.neighbors[0]=a:b.equals(this.points[0])&&c.equals(this.points[2])||b.equals(this.points[2])&&c.equals(this.points[0])?this.neighbors[1]=a:b.equals(this.points[0])&&c.equals(this.points[1])||b.equals(this.points[1])&&c.equals(this.points[0])?this.neighbors[2]=a:alert("Invalid tessellation.Triangle.MarkNeighbor call (1)!")}else 1==arguments.length?(a=arguments[0],a.ContainsP(this.points[1],this.points[2])?(this.neighbors[0]=a,a.MarkNeighbor(this.points[1],this.points[2],
this)):a.ContainsP(this.points[0],this.points[2])?(this.neighbors[1]=a,a.MarkNeighbor(this.points[0],this.points[2],this)):a.ContainsP(this.points[0],this.points[1])&&(this.neighbors[2]=a,a.MarkNeighbor(this.points[0],this.points[1],this))):alert("Invalid tessellation.Triangle.MarkNeighbor call! (2)")};tessellation.Triangle.prototype.ClearNeigbors=function(){this.neighbors[0]=null;this.neighbors[1]=null;this.neighbors[2]=null};tessellation.Triangle.prototype.ClearDelunayEdges=function(){this.delaunay_edge[0]=
!1;this.delaunay_edge[1]=!1;this.delaunay_edge[2]=!1};tessellation.Triangle.prototype.PointCW=function(a){return a.equals(this.points[0])?this.points[2]:a.equals(this.points[1])?this.points[0]:a.equals(this.points[2])?this.points[1]:null};tessellation.Triangle.prototype.PointCCW=function(a){return a.equals(this.points[0])?this.points[1]:a.equals(this.points[1])?this.points[2]:a.equals(this.points[2])?this.points[0]:null};tessellation.Triangle.prototype.NeighborCW=function(a){return a.equals(this.points[0])?
this.neighbors[1]:a.equals(this.points[1])?this.neighbors[2]:this.neighbors[0]};tessellation.Triangle.prototype.NeighborCCW=function(a){return a.equals(this.points[0])?this.neighbors[2]:a.equals(this.points[1])?this.neighbors[0]:this.neighbors[1]};tessellation.Triangle.prototype.GetConstrainedEdgeCW=function(a){return a.equals(this.points[0])?this.constrained_edge[1]:a.equals(this.points[1])?this.constrained_edge[2]:this.constrained_edge[0]};tessellation.Triangle.prototype.GetConstrainedEdgeCCW=function(a){return a.equals(this.points[0])?
this.constrained_edge[2]:a.equals(this.points[1])?this.constrained_edge[0]:this.constrained_edge[1]};tessellation.Triangle.prototype.SetConstrainedEdgeCW=function(a,b){a.equals(this.points[0])?this.constrained_edge[1]=b:a.equals(this.points[1])?this.constrained_edge[2]=b:this.constrained_edge[0]=b};tessellation.Triangle.prototype.SetConstrainedEdgeCCW=function(a,b){a.equals(this.points[0])?this.constrained_edge[2]=b:a.equals(this.points[1])?this.constrained_edge[0]=b:this.constrained_edge[1]=b};tessellation.Triangle.prototype.GetDelaunayEdgeCW=
function(a){return a.equals(this.points[0])?this.delaunay_edge[1]:a.equals(this.points[1])?this.delaunay_edge[2]:this.delaunay_edge[0]};tessellation.Triangle.prototype.GetDelaunayEdgeCCW=function(a){return a.equals(this.points[0])?this.delaunay_edge[2]:a.equals(this.points[1])?this.delaunay_edge[0]:this.delaunay_edge[1]};tessellation.Triangle.prototype.SetDelaunayEdgeCW=function(a,b){a.equals(this.points[0])?this.delaunay_edge[1]=b:a.equals(this.points[1])?this.delaunay_edge[2]=b:this.delaunay_edge[0]=
b};tessellation.Triangle.prototype.SetDelaunayEdgeCCW=function(a,b){a.equals(this.points[0])?this.delaunay_edge[2]=b:a.equals(this.points[1])?this.delaunay_edge[0]=b:this.delaunay_edge[1]=b};tessellation.Triangle.prototype.NeighborAcross=function(a){return a.equals(this.points[0])?this.neighbors[0]:a.equals(this.points[1])?this.neighbors[1]:this.neighbors[2]};tessellation.Triangle.prototype.OppositePoint=function(a,b){var c=a.PointCW(b);return this.PointCW(c)};tessellation.Triangle.prototype.Legalize=
function(){if(1==arguments.length)this.Legalize(this.points[0],arguments[0]);else if(2==arguments.length){var a=arguments[0],b=arguments[1];a.equals(this.points[0])?(this.points[1]=this.points[0],this.points[0]=this.points[2],this.points[2]=b):a.equals(this.points[1])?(this.points[2]=this.points[1],this.points[1]=this.points[0],this.points[0]=b):a.equals(this.points[2])?(this.points[0]=this.points[2],this.points[2]=this.points[1],this.points[1]=b):alert("Invalid tessellation.Triangle.Legalize call!")}else alert("Invalid tessellation.Triangle.Legalize call!")};
tessellation.Triangle.prototype.Index=function(a){return a.equals(this.points[0])?0:a.equals(this.points[1])?1:a.equals(this.points[2])?2:-1};tessellation.Triangle.prototype.EdgeIndex=function(a,b){if(a.equals(this.points[0])){if(b.equals(this.points[1]))return 2;if(b.equals(this.points[2]))return 1}else if(a.equals(this.points[1])){if(b.equals(this.points[2]))return 0;if(b.equals(this.points[0]))return 2}else if(a.equals(this.points[2])){if(b.equals(this.points[0]))return 1;if(b.equals(this.points[1]))return 0}return-1};
tessellation.Triangle.prototype.MarkConstrainedEdge=function(){if(1==arguments.length)"number"==typeof arguments[0]?this.constrained_edge[arguments[0]]=!0:this.MarkConstrainedEdge(arguments[0].p,arguments[0].q);else if(2==arguments.length){var a=arguments[0],b=arguments[1];if(b.equals(this.points[0])&&a.equals(this.points[1])||b.equals(this.points[1])&&a.equals(this.points[0]))this.constrained_edge[2]=!0;else if(b.equals(this.points[0])&&a.equals(this.points[2])||b.equals(this.points[2])&&a.equals(this.points[0]))this.constrained_edge[1]=
!0;else if(b.equals(this.points[1])&&a.equals(this.points[2])||b.equals(this.points[2])&&a.equals(this.points[1]))this.constrained_edge[0]=!0}else alert("Invalid tessellation.Triangle.MarkConstrainedEdge call!")};tessellation.PI_3div4=3*Math.PI/4;tessellation.PI_2=Math.PI/2;tessellation.EPSILON=1E-12;tessellation.kAlpha=0.3;tessellation.Orientation={CW:1,CCW:-1,COLLINEAR:0};tessellation.Orient2d=function(a,b,c){a=(a.x-c.x)*(b.y-c.y)-(a.y-c.y)*(b.x-c.x);return a>-tessellation.EPSILON&&a<tessellation.EPSILON?
tessellation.Orientation.COLLINEAR:0<a?tessellation.Orientation.CCW:tessellation.Orientation.CW};tessellation.InScanArea=function(a,b,c,d){var f=d.x;d=d.y;var h=a.x-f;a=a.y-d;return h*(b.y-d)-(b.x-f)*a<=tessellation.EPSILON||(c.x-f)*a-h*(c.y-d)<=tessellation.EPSILON?!1:!0};tessellation.Node=function(){this.prev=this.next=this.triangle=this.point=null;this.value=0;1==arguments.length?(this.point=arguments[0],this.value=this.point.x):2==arguments.length?(this.point=arguments[0],this.triangle=arguments[1],
this.value=this.point.x):alert("Invalid tessellation.Node constructor call!")};tessellation.AdvancingFront=function(a,b){this.head=a;this.tail=b;this.search_node=a};tessellation.AdvancingFront.prototype.search=function(){return this.search_node};tessellation.AdvancingFront.prototype.set_search=function(a){this.search_node=a};tessellation.AdvancingFront.prototype.FindSearchNode=function(){return this.search_node};tessellation.AdvancingFront.prototype.LocateNode=function(a){var b=this.search_node;if(a<
b.value)for(;null!=(b=b.prev);){if(a>=b.value)return this.search_node=b}else for(;null!=(b=b.next);)if(a<b.value)return this.search_node=b.prev;return null};tessellation.AdvancingFront.prototype.LocatePoint=function(a){var b=a.x,c=this.FindSearchNode(b),d=c.point.x;if(b==d)if(c.prev&&a.equals(c.prev.point))c=c.prev;else if(c.next&&a.equals(c.next.point))c=c.next;else{if(!a.equals(c.point))return alert("Invalid tessellation.AdvancingFront.LocatePoint call!"),null}else if(b<d)for(;null!=(c=c.prev)&&
!a.equals(c.point););else for(;null!=(c=c.next)&&!a.equals(c.point););null!=c&&(this.search_node=c);return c};tessellation.Basin=function(){this.right_node=this.bottom_node=this.left_node=null;this.width=0;this.left_highest=!1};tessellation.Basin.prototype.Clear=function(){this.right_node=this.bottom_node=this.left_node=null;this.width=0;this.left_highest=!1};tessellation.EdgeEvent=function(){this.constrained_edge=null;this.right=!1};tessellation.SweepContext=function(a){this.triangles=[];this.map=
[];this.points=a;this.edges=[];this.af_tail=this.af_middle_=this.af_head=this.tail=this.head=this.front=null;this.basin=new tessellation.Basin;this.edge_event=new tessellation.EdgeEvent;this.InitEdges(this.points)};tessellation.SweepContext.prototype.AddHole=function(a){this.InitEdges(a);for(var b in a)this.points.push(a[b])};tessellation.SweepContext.prototype.point_count=function(){return this.points.length};tessellation.SweepContext.prototype.GetTriangles=function(){return this.triangles};tessellation.SweepContext.prototype.GetMap=
function(){return this.map};tessellation.SweepContext.prototype.InitTriangulation=function(){var a=this.points[0].x,b=this.points[0].x,c=this.points[0].y,d=this.points[0].y,f;for(f in this.points){var h=this.points[f];h.x>a&&(a=h.x);h.x<b&&(b=h.x);h.y>c&&(c=h.y);h.y<d&&(d=h.y)}c=tessellation.kAlpha*(c-d);this.head=new Two.Vector(a+tessellation.kAlpha*(a-b),d-c);this.tail=new Two.Vector(b-c,d-c);this.points.sort(tessellation.cmp)};tessellation.SweepContext.prototype.InitEdges=function(a){for(var b=
0;b<a.length;++b)this.edges.push(new tessellation.Edge(a[b],a[(b+1)%a.length]))};tessellation.SweepContext.prototype.GetPoint=function(a){return this.points[a]};tessellation.SweepContext.prototype.AddToMap=function(a){this.map.push(a)};tessellation.SweepContext.prototype.LocateNode=function(a){return this.front.LocateNode(a.x)};tessellation.SweepContext.prototype.CreateAdvancingFront=function(){var a,b,c;c=new tessellation.Triangle(this.points[0],this.tail,this.head);this.map.push(c);a=new tessellation.Node(c.GetPoint(1),
c);b=new tessellation.Node(c.GetPoint(0),c);c=new tessellation.Node(c.GetPoint(2));this.front=new tessellation.AdvancingFront(a,c);a.next=b;b.next=c;b.prev=a;c.prev=b};tessellation.SweepContext.prototype.RemoveNode=function(){};tessellation.SweepContext.prototype.MapTriangleToNodes=function(a){for(var b=0;3>b;++b)if(null==a.GetNeighbor(b)){var c=this.front.LocatePoint(a.PointCW(a.GetPoint(b)));null!=c&&(c.triangle=a)}};tessellation.SweepContext.prototype.RemoveFromMap=function(a){for(var b in this.map)if(this.map[b]==
a){delete this.map[b];break}};tessellation.SweepContext.prototype.MeshClean=function(a){if(null!=a&&!a.IsInterior()){a.IsInterior(!0);this.triangles.push(a);for(var b=0;3>b;++b)a.constrained_edge[b]||this.MeshClean(a.GetNeighbor(b))}};tessellation.sweep={};tessellation.sweep.Triangulate=function(a){a.InitTriangulation();a.CreateAdvancingFront();tessellation.sweep.SweepPoints(a);tessellation.sweep.FinalizationPolygon(a)};tessellation.sweep.SweepPoints=function(a){for(var b=1;b<a.point_count();++b)for(var c=
a.GetPoint(b),d=tessellation.sweep.PointEvent(a,c),f=0;f<c.edges.length;++f)tessellation.sweep.EdgeEvent(a,c.edges[f],d)};tessellation.sweep.FinalizationPolygon=function(a){for(var b=a.front.head.next.triangle,c=a.front.head.next.point;!b.GetConstrainedEdgeCW(c);)b=b.NeighborCCW(c);a.MeshClean(b)};tessellation.sweep.PointEvent=function(a,b){var c=a.LocateNode(b),d=tessellation.sweep.NewFrontTriangle(a,b,c);b.x<=c.point.x+tessellation.EPSILON&&tessellation.sweep.Fill(a,c);tessellation.sweep.FillAdvancingFront(a,
d);return d};tessellation.sweep.EdgeEvent=function(){var a;if(3==arguments.length){a=arguments[0];var b=arguments[1],c=arguments[2];a.edge_event.constrained_edge=b;a.edge_event.right=b.p.x>b.q.x;tessellation.sweep.IsEdgeSideOfTriangle(c.triangle,b.p,b.q)||(tessellation.sweep.FillEdgeEvent(a,b,c),tessellation.sweep.EdgeEvent(a,b.p,b.q,c.triangle,b.q))}else if(5==arguments.length){a=arguments[0];var b=arguments[1],c=arguments[2],d=arguments[3],f=arguments[4];if(!tessellation.sweep.IsEdgeSideOfTriangle(d,
b,c)){var h=d.PointCCW(f),h=tessellation.Orient2d(c,h,b);if(h==tessellation.Orientation.COLLINEAR)alert("tessellation.sweep.EdgeEvent: Collinear not supported!");else{var g=d.PointCW(f),g=tessellation.Orient2d(c,g,b);g==tessellation.Orientation.COLLINEAR?alert("tessellation.sweep.EdgeEvent: Collinear not supported!"):h==g?(d=h==tessellation.Orientation.CW?d.NeighborCCW(f):d.NeighborCW(f),tessellation.sweep.EdgeEvent(a,b,c,d,f)):tessellation.sweep.FlipEdgeEvent(a,b,c,d,f)}}}else alert("Invalid tessellation.sweep.EdgeEvent call!")};
tessellation.sweep.IsEdgeSideOfTriangle=function(a,b,c){var d=a.EdgeIndex(b,c);return-1!=d?(a.MarkConstrainedEdge(d),a=a.GetNeighbor(d),null!=a&&a.MarkConstrainedEdge(b,c),!0):!1};tessellation.sweep.NewFrontTriangle=function(a,b,c){var d=new tessellation.Triangle(b,c.point,c.next.point);d.MarkNeighbor(c.triangle);a.AddToMap(d);b=new tessellation.Node(b);b.next=c.next;b.prev=c;c.next.prev=b;c.next=b;tessellation.sweep.Legalize(a,d)||a.MapTriangleToNodes(d);return b};tessellation.sweep.Fill=function(a,
b){var c=new tessellation.Triangle(b.prev.point,b.point,b.next.point);c.MarkNeighbor(b.prev.triangle);c.MarkNeighbor(b.triangle);a.AddToMap(c);b.prev.next=b.next;b.next.prev=b.prev;tessellation.sweep.Legalize(a,c)||a.MapTriangleToNodes(c)};tessellation.sweep.FillAdvancingFront=function(a,b){for(var c=b.next,d;null!=c.next;){d=tessellation.sweep.HoleAngle(c);if(d>tessellation.PI_2||d<-tessellation.PI_2)break;tessellation.sweep.Fill(a,c);c=c.next}for(c=b.prev;null!=c.prev;){d=tessellation.sweep.HoleAngle(c);
if(d>tessellation.PI_2||d<-tessellation.PI_2)break;tessellation.sweep.Fill(a,c);c=c.prev}null!=b.next&&null!=b.next.next&&(d=tessellation.sweep.BasinAngle(b),d<tessellation.PI_3div4&&tessellation.sweep.FillBasin(a,b))};tessellation.sweep.BasinAngle=function(a){return Math.atan2(a.point.y-a.next.next.point.y,a.point.x-a.next.next.point.x)};tessellation.sweep.HoleAngle=function(a){var b=a.next.point.x-a.point.x,c=a.next.point.y-a.point.y,d=a.prev.point.x-a.point.x;a=a.prev.point.y-a.point.y;return Math.atan2(b*
a-c*d,b*d+c*a)};tessellation.sweep.Legalize=function(a,b){for(var c=0;3>c;++c)if(!b.delaunay_edge[c]){var d=b.GetNeighbor(c);if(null!=d){var f=b.GetPoint(c),h=d.OppositePoint(b,f),g=d.Index(h);if(d.constrained_edge[g]||d.delaunay_edge[g])b.constrained_edge[c]=d.constrained_edge[g];else if(tessellation.sweep.Incircle(f,b.PointCCW(f),b.PointCW(f),h))return b.delaunay_edge[c]=!0,d.delaunay_edge[g]=!0,tessellation.sweep.RotateTrianglePair(b,f,d,h),(f=!tessellation.sweep.Legalize(a,b))&&a.MapTriangleToNodes(b),
(f=!tessellation.sweep.Legalize(a,d))&&a.MapTriangleToNodes(d),b.delaunay_edge[c]=!1,d.delaunay_edge[g]=!1,!0}}return!1};tessellation.sweep.Incircle=function(a,b,c,d){var f=a.x-d.x;a=a.y-d.y;var h=b.x-d.x;b=b.y-d.y;var g=f*b-h*a;if(0>=g)return!1;var m=c.x-d.x;c=c.y-d.y;d=m*a-f*c;return 0>=d?!1:0<(f*f+a*a)*(h*c-m*b)+(h*h+b*b)*d+(m*m+c*c)*g};tessellation.sweep.RotateTrianglePair=function(a,b,c,d){var f,h,g,m;f=a.NeighborCCW(b);h=a.NeighborCW(b);g=c.NeighborCCW(d);m=c.NeighborCW(d);var p,n,l,s;p=a.GetConstrainedEdgeCCW(b);
n=a.GetConstrainedEdgeCW(b);l=c.GetConstrainedEdgeCCW(d);s=c.GetConstrainedEdgeCW(d);var j,q,y,r;j=a.GetDelaunayEdgeCCW(b);q=a.GetDelaunayEdgeCW(b);y=c.GetDelaunayEdgeCCW(d);r=c.GetDelaunayEdgeCW(d);a.Legalize(b,d);c.Legalize(d,b);c.SetDelaunayEdgeCCW(b,j);a.SetDelaunayEdgeCW(b,q);a.SetDelaunayEdgeCCW(d,y);c.SetDelaunayEdgeCW(d,r);c.SetConstrainedEdgeCCW(b,p);a.SetConstrainedEdgeCW(b,n);a.SetConstrainedEdgeCCW(d,l);c.SetConstrainedEdgeCW(d,s);a.ClearNeigbors();c.ClearNeigbors();f&&c.MarkNeighbor(f);
h&&a.MarkNeighbor(h);g&&a.MarkNeighbor(g);m&&c.MarkNeighbor(m);a.MarkNeighbor(c)};tessellation.sweep.FillBasin=function(a,b){a.basin.left_node=tessellation.Orient2d(b.point,b.next.point,b.next.next.point)==tessellation.Orientation.CCW?b.next.next:b.next;for(a.basin.bottom_node=a.basin.left_node;null!=a.basin.bottom_node.next&&a.basin.bottom_node.point.y>=a.basin.bottom_node.next.point.y;)a.basin.bottom_node=a.basin.bottom_node.next;if(a.basin.bottom_node!=a.basin.left_node){for(a.basin.right_node=
a.basin.bottom_node;null!=a.basin.right_node.next&&a.basin.right_node.point.y<a.basin.right_node.next.point.y;)a.basin.right_node=a.basin.right_node.next;a.basin.right_node!=a.basin.bottom_node&&(a.basin.width=a.basin.right_node.point.x-a.basin.left_node.point.x,a.basin.left_highest=a.basin.left_node.point.y>a.basin.right_node.point.y,tessellation.sweep.FillBasinReq(a,a.basin.bottom_node))}};tessellation.sweep.FillBasinReq=function(a,b){if(!tessellation.sweep.IsShallow(a,b)){tessellation.sweep.Fill(a,
b);var c;if(!(b.prev==a.basin.left_node&&b.next==a.basin.right_node)){if(b.prev==a.basin.left_node){c=tessellation.Orient2d(b.point,b.next.point,b.next.next.point);if(c==tessellation.Orientation.CW)return;b=b.next}else if(b.next==a.basin.right_node){c=tessellation.Orient2d(b.point,b.prev.point,b.prev.prev.point);if(c==tessellation.Orientation.CCW)return;b=b.prev}else b=b.prev.point.y<b.next.point.y?b.prev:b.next;tessellation.sweep.FillBasinReq(a,b)}}};tessellation.sweep.IsShallow=function(a,b){return a.basin.width>
(a.basin.left_highest?a.basin.left_node.point.y-b.point.y:a.basin.right_node.point.y-b.point.y)?!0:!1};tessellation.sweep.FillEdgeEvent=function(a,b,c){a.edge_event.right?tessellation.sweep.FillRightAboveEdgeEvent(a,b,c):tessellation.sweep.FillLeftAboveEdgeEvent(a,b,c)};tessellation.sweep.FillRightAboveEdgeEvent=function(a,b,c){for(;c.next.point.x<b.p.x;)tessellation.Orient2d(b.q,c.next.point,b.p)==tessellation.Orientation.CCW?tessellation.sweep.FillRightBelowEdgeEvent(a,b,c):c=c.next};tessellation.sweep.FillRightBelowEdgeEvent=
function(a,b,c){c.point.x<b.p.x&&(tessellation.Orient2d(c.point,c.next.point,c.next.next.point)==tessellation.Orientation.CCW?tessellation.sweep.FillRightConcaveEdgeEvent(a,b,c):(tessellation.sweep.FillRightConvexEdgeEvent(a,b,c),tessellation.sweep.FillRightBelowEdgeEvent(a,b,c)))};tessellation.sweep.FillRightConcaveEdgeEvent=function(a,b,c){tessellation.sweep.Fill(a,c.next);c.next.point!=b.p&&(tessellation.Orient2d(b.q,c.next.point,b.p)==tessellation.Orientation.CCW&&tessellation.Orient2d(c.point,
c.next.point,c.next.next.point)==tessellation.Orientation.CCW)&&tessellation.sweep.FillRightConcaveEdgeEvent(a,b,c)};tessellation.sweep.FillRightConvexEdgeEvent=function(a,b,c){tessellation.Orient2d(c.next.point,c.next.next.point,c.next.next.next.point)==tessellation.Orientation.CCW?tessellation.sweep.FillRightConcaveEdgeEvent(a,b,c.next):tessellation.Orient2d(b.q,c.next.next.point,b.p)==tessellation.Orientation.CCW&&tessellation.sweep.FillRightConvexEdgeEvent(a,b,c.next)};tessellation.sweep.FillLeftAboveEdgeEvent=
function(a,b,c){for(;c.prev.point.x>b.p.x;)tessellation.Orient2d(b.q,c.prev.point,b.p)==tessellation.Orientation.CW?tessellation.sweep.FillLeftBelowEdgeEvent(a,b,c):c=c.prev};tessellation.sweep.FillLeftBelowEdgeEvent=function(a,b,c){c.point.x>b.p.x&&(tessellation.Orient2d(c.point,c.prev.point,c.prev.prev.point)==tessellation.Orientation.CW?tessellation.sweep.FillLeftConcaveEdgeEvent(a,b,c):(tessellation.sweep.FillLeftConvexEdgeEvent(a,b,c),tessellation.sweep.FillLeftBelowEdgeEvent(a,b,c)))};tessellation.sweep.FillLeftConvexEdgeEvent=
function(a,b,c){tessellation.Orient2d(c.prev.point,c.prev.prev.point,c.prev.prev.prev.point)==tessellation.Orientation.CW?tessellation.sweep.FillLeftConcaveEdgeEvent(a,b,c.prev):tessellation.Orient2d(b.q,c.prev.prev.point,b.p)==tessellation.Orientation.CW&&tessellation.sweep.FillLeftConvexEdgeEvent(a,b,c.prev)};tessellation.sweep.FillLeftConcaveEdgeEvent=function(a,b,c){tessellation.sweep.Fill(a,c.prev);c.prev.point!=b.p&&(tessellation.Orient2d(b.q,c.prev.point,b.p)==tessellation.Orientation.CW&&
tessellation.Orient2d(c.point,c.prev.point,c.prev.prev.point)==tessellation.Orientation.CW)&&tessellation.sweep.FillLeftConcaveEdgeEvent(a,b,c)};tessellation.sweep.FlipEdgeEvent=function(a,b,c,d,f){var h=d.NeighborAcross(f);if(null==h)alert("[BUG:FIXME] FLIP failed due to missing triangle!");else{var g=h.OppositePoint(d,f);if(tessellation.InScanArea(f,d.PointCCW(f),d.PointCW(f),g))if(tessellation.sweep.RotateTrianglePair(d,f,h,g),a.MapTriangleToNodes(d),a.MapTriangleToNodes(h),f==c&&g==b)c==a.edge_event.constrained_edge.q&&
b==a.edge_event.constrained_edge.p&&(d.MarkConstrainedEdge(b,c),h.MarkConstrainedEdge(b,c),tessellation.sweep.Legalize(a,d),tessellation.sweep.Legalize(a,h));else{var m=tessellation.Orient2d(c,g,b);d=tessellation.sweep.NextFlipTriangle(a,m,d,h,f,g);tessellation.sweep.FlipEdgeEvent(a,b,c,d,f)}else g=tessellation.sweep.NextFlipPoint(b,c,h,g),tessellation.sweep.FlipScanEdgeEvent(a,b,c,d,h,g),tessellation.sweep.EdgeEvent(a,b,c,d,f)}};tessellation.sweep.NextFlipTriangle=function(a,b,c,d,f,h){if(b==tessellation.Orientation.CCW)return b=
d.EdgeIndex(f,h),d.delaunay_edge[b]=!0,tessellation.sweep.Legalize(a,d),d.ClearDelunayEdges(),c;b=c.EdgeIndex(f,h);c.delaunay_edge[b]=!0;tessellation.sweep.Legalize(a,c);c.ClearDelunayEdges();return d};tessellation.sweep.NextFlipPoint=function(a,b,c,d){a=tessellation.Orient2d(b,d,a);if(a==tessellation.Orientation.CW)return c.PointCCW(d);if(a==tessellation.Orientation.CCW)return c.PointCW(d);alert("[Unsupported] tessellation.sweep.NextFlipPoint: opposing point on constrained edge!")};tessellation.sweep.FlipScanEdgeEvent=
function(a,b,c,d,f,h){var g=f.NeighborAcross(h);null==g?alert("[BUG:FIXME] FLIP failed due to missing triangle"):(f=g.OppositePoint(f,h),tessellation.InScanArea(c,d.PointCCW(c),d.PointCW(c),f)?tessellation.sweep.FlipEdgeEvent(a,c,f,g,f):(f=tessellation.sweep.NextFlipPoint(b,c,g,f),tessellation.sweep.FlipScanEdgeEvent(a,b,c,d,g,f)))}})();(function(){function k(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(j.Events.resize,b,a)}var a=this,b=a.Two||{},c=Math.sin,d=Math.cos,f=Math.atan2,h=Math.sqrt,g=Math.abs,m=Math.PI,p=2*m,n=m/2,l=Math.pow,s={hasEventListeners:_.isFunction(a.addEventListener),bind:function(a,b,c,d){this.hasEventListeners?a.addEventListener(b,c,!!d):a.attachEvent("on"+b,c);return this},unbind:function(a,b,c,d){this.hasEventListeners?
a.removeEventListeners(b,c,!!d):a.detachEvent("on"+b,c);return this}},j=a.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:j.Types.svg,autostart:!1});this.type=a.type;this.renderer=new j[this.type](this);this.playing=a.autostart;this.frameCount=0;a.fullscreen?(a=_.bind(k,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),s.bind(window,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=
a.width,this.height=a.height);this.scene=new j.Group;this.renderer.add(this.scene);j.Instances.push(this)};_.extend(j,{Array:a.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Properties:{hierarchy:"hierarchy"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change"},Resolution:8,Instances:[],noConflict:function(){a.Two=b;return this},Utils:{Curve:{CollinearityEpsilon:l(10,-30),RecursionLimit:32,CuspLimit:0,Tolerance:{distance:0.25,
angle:0,epsilon:0.01}},subdivide:function(a,b,c,d,l,h,s,n,q){var r=j.Utils.Curve.CollinearityEpsilon,y=j.Utils.Curve.CuspLimit,k=j.Utils.Curve.Tolerance;q=q||0;var u=(a+c)/2,t=(b+d)/2,C=(c+l)/2,x=(d+h)/2,O=(l+s)/2,P=(h+n)/2,Q=(u+C)/2,R=(t+x)/2,C=(C+O)/2,x=(x+P)/2,D=(Q+C)/2,E=(R+x)/2;if(0<q){var w=s-a,B=n-b,I=g((c-s)*B-(d-n)*w),J=g((l-s)*B-(h-n)*w);if(I>r&&J>r&&(I+J)*(I+J)<=k.distance*(w*w+B*B)){if(k.angle<k.epsilon)return[new j.Vector(D,E)];w=f(h-d,l-c);r=g(w-f(d-b,c-a));w=g(f(n-h,s-l)-w);r>=m&&(r=
p-r);w>=m&&(w=p-w);if(r+w<k.angle)return[new j.Vector(D,E)];if(0!==y){if(r>y)return[new j.Vector(c,d)];if(w>y)return[new j.Vector(l,h)]}}}else if(I>r)if(I*I<=k.distance*(w*w+B*B)){if(k.angle<k.epsilon)return[new j.Vector(D,E)];r=g(f(h-d,l-c)-f(d-b,c-a));r>=m&&(r=p-r);if(r<k.angle)return[new j.Vector(c,d),new j.Vector(l,h)];if(0!==y&&r>y)return[new j.Vector(c,d)]}else if(J>r){if(J*J<=k.distance*(w*w+B*B)){if(k.angle<k.epsilon)return[new j.Vector(D,E)];r=g(f(n-h,s-l)-f(h-d,l-c));r>=m&&(r=p-r);if(r<
k.angle)return[new j.Vector(c,d),new j.Vector(l,h)];if(0!==y&&r>y)return[new j.Vector2(l,h)]}}else if(w=D-(a+s)/2,B=E-(b+n)/2,w*w+B*B<=k.distance)return[new j.Vector(D,E)];return j.Utils.subdivide(a,b,u,t,Q,R,D,E,q+1).concat(j.Utils.subdivide(D,E,C,x,O,P,s,n,q+1))},getCurveFromPoints:function(a,b){for(var c=[],d=a.length,g=d-1,l=0;l<d;l++){var j=a[l],f={x:j.x,y:j.y};c.push(f);var j=b?t(l-1,d):Math.max(l-1,0),h=b?t(l+1,d):Math.min(l+1,g);u(a[j],f,a[h]);!f.u.x&&!f.u.y&&(f.u.x=f.x,f.u.y=f.y);!f.v.x&&
!f.v.y&&(f.v.x=f.x,f.v.y=f.y)}return c},getControlPoints:function(a,b,e){var g=r(a,b),l=r(e,b);a=q(a,b);e=q(e,b);var f=(g+l)/2;if(1E-4>a||1E-4>e)return b.u={x:b.x,y:b.y},b.v={x:b.x,y:b.y},b;a*=0.33;e*=0.33;f=l<g?f+n:f-n;g={x:b.x+d(f)*a,y:b.y+c(f)*a};f-=m;l={x:b.x+d(f)*e,y:b.y+c(f)*e};b.u=g;b.v=l;return b},angleBetween:function(a,b){return f(a.y-b.y,a.x-b.x)},distanceBetweenSquared:function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},distanceBetween:function(a,b){return h(y(a,b))},mod:function(a,
b){for(;0>a;)a+=b;return a%b},Error:function(a){this.name="two.js";this.message=a}}});j.Utils.Error.prototype=Error();j.Utils.Error.prototype.constructor=j.Utils.Error;var q=j.Utils.distanceBetween,y=j.Utils.distanceBetweenSquared,r=j.Utils.angleBetween,u=j.Utils.getControlPoints,t=j.Utils.mod;_.extend(j.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){this.playing=!0;return this.trigger(j.Events.play)},pause:function(){this.playing=
!1;return this.trigger(j.Events.pause)},update:function(){this.frameCount++;var a=this.width,b=this.height,c=this.renderer;(a!==c.width||b!==c.height)&&c.setSize(a,b);return this.trigger(j.Events.update,this.frameCount)},render:function(){this.renderer.render();return this.trigger(j.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},makeLine:function(a,b,c,d){c=(c-a)/2;d=(d-b)/2;var g=[new j.Vector(-c,-d),new j.Vector(c,d)],
g=(new j.Polygon(g)).noFill();g.translation.set(a+c,b+d);this.scene.add(g);return g},makeRectangle:function(a,b,c,d){c/=2;d/=2;d=[new j.Vector(c,d),new j.Vector(-c,d),new j.Vector(-c,-d),new j.Vector(c,-d)];d=new j.Polygon(d,!0);d.translation.set(a,b);this.scene.add(d);return d},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,g,l){var f=j.Resolution,h=_.map(_.range(f),function(a){var b=a/f*p;a=g*d(b);b=l*c(b);return new j.Vector(a,b)},this),h=new j.Polygon(h,
!0,!0);h.translation.set(a,b);this.scene.add(h);return h},makeCurve:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],d=0;d<b;d+=2){var g=arguments[d];if(!_.isNumber(g))break;c.push(new j.Vector(g,arguments[d+1]))}var b=arguments[b-1],c=new j.Polygon(c,!(_.isBoolean(b)&&b),!0),b=c.getBoundingClientRect(),l=b.left+b.width/2,f=b.top+b.height/2;_.each(c.vertices,function(a){a.x-=l;a.y-=f});c.translation.set(l,f);this.scene.add(c);return c},makePolygon:function(a){var b=arguments.length,
c=a;if(!_.isArray(a))for(var c=[],d=0;d<b;d+=2){var g=arguments[d];if(!_.isNumber(g))break;c.push(new j.Vector(g,arguments[d+1]))}var b=arguments[b-1],c=new j.Polygon(c,!(_.isBoolean(b)&&b)),b=c.getBoundingClientRect(),l=b.left+b.width/2,f=b.top+b.height/2;_.each(c.vertices,function(a){a.x-=l;a.y-=f});c.translation.set(l,f);this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new j.Group;this.scene.add(c);c.add(b);return c}});(function(){_.each(j.Instances,
function(a){a.playing&&a.update().render()});requestAnimationFrame(arguments.callee)})()})();(function(){function k(a){var b={},c=a.id,p=a.translation,n=a.rotation,l=a.scale,s=a.stroke,j=a.linewidth,q=a.fill,k=a.opacity,r=a.visible,u=a.cap,t=a.join,A=a.miter,z=a.curved,e=a.closed;a=a.vertices;c&&(b.id=f.Identifier+c);p&&(_.isNumber(l)&&_.isNumber(n))&&(b.transform="translate("+p.x+","+p.y+") scale("+l+") rotate("+n+")");s&&(b.stroke=s);q&&(b.fill=q);k&&(b["stroke-opacity"]=b["fill-opacity"]=k);b.visibility=r?"visible":"hidden";u&&(b["stroke-linecap"]=u);t&&(b["stroke-linejoin"]=t);A&&(b["stroke-miterlimit"]=
A);j&&(b["stroke-width"]=j);a&&(b.d=d.toString(a,e,z));return b}var a=0,b=Two.Utils.getCurveFromPoints,c=Two.Utils.mod,d={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(a,b){var c=a.toLowerCase(),d=document.createElementNS(this.ns,c);"svg"===c&&(b=_.defaults(b||{},{version:this.version}));_.isObject(b)&&this.setAttributes(d,b);return d},setAttributes:function(a,b){_.each(b,function(a,b){this.setAttribute(b,a)},a);return this},removeAttributes:function(a,
b){_.each(b,function(a){this.removeAttribute(a)},a);return this},toString:function(a,d,f){var p=a.length,n=p-1;if(!f)return _.map(a,function(a,b){var c;c=(0>=b?"M":"L")+(" "+a.x.toFixed(3)+" "+a.y.toFixed(3));b>=n&&d&&(c+=" Z");return c}).join(" ");var l=b(a,d);return _.map(l,function(a,b){var f,h=d?c(b-1,p):Math.max(b-1,0),m=d?c(b+1,p):Math.min(b+1,n);f=l[h];var m=l[m],h=f.v.x.toFixed(3),k=f.v.y.toFixed(3),t=a.u.x.toFixed(3),A=a.u.y.toFixed(3),z=a.x.toFixed(3),e=a.y.toFixed(3);f=0>=b?"M "+z+" "+
e:"C "+h+" "+k+" "+t+" "+A+" "+z+" "+e;b>=n&&d&&(h=a.v.x.toFixed(3),k=a.v.y.toFixed(3),t=m.u.x.toFixed(3),A=m.u.y.toFixed(3),z=m.x.toFixed(3),e=m.y.toFixed(3),f=f+(" C "+h+" "+k+" "+t+" "+A+" "+z+" "+e)+" Z");return f}).join(" ")}},f=Two[Two.Types.svg]=function(){this.domElement=d.createElement("svg");this.elements=[];this.commands=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(f,{Identifier:"two-"});_.extend(f.prototype,
Backbone.Events,{setSize:function(a,b){this.width=a;this.height=b;d.setAttributes(this.domElement,{width:a,height:b});return this},add:function(b){var c=b,f=this.elements,p=this.domElement;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(b){var c;c=b instanceof Two.Group;if(_.isUndefined(b.id)){var g=a;a++;b.id=g}c?(c="g",_.isUndefined(b.parent)&&(b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),b=k(b),delete b.stroke,delete b.fill,
delete b["fill-opacity"],delete b["stroke-opacity"],delete b["stroke-linecap"],delete b["stroke-linejoin"],delete b["stroke-miterlimit"],delete b["stroke-width"]):(c="path",b=k(b));b=d.createElement(c,b);p.appendChild(b);f.push(b)},this);return this},update:function(a,b,c){this.commands.push(arguments);return this},render:function(){this.unveil();var a=this.elements;_.each(this.commands,function(b){var c=b[1],f=b[2],n=b[3],l=b[4],s=a[b[0]];switch(c){case Two.Properties.hierarchy:_.each(f,function(b){s.appendChild(a[b])});
break;default:a:{b=c;switch(b){case "matrix":b="transform";f="matrix("+f.toString()+")";break;case "visible":b="visibility";f=f?"visible":"hidden";break;case "cap":b="stroke-linecap";break;case "join":b="stroke-linejoin";break;case "miter":b="stroke-miterlimit";break;case "linewidth":b="stroke-width";break;case "vertices":b="d";f=d.toString(f,n,l);break;case "opacity":d.setAttributes(s,{"stroke-opacity":opacity,"fill-opacity":opacity});break a}s.setAttribute(b,f)}}},this);this.commands.length=0;return this}})})();(function(){var k=0,a=Two.Utils.getCurveFromPoints,b=Two.Utils.mod,c=function(a){_.each(a,function(a,b){this[b]=a},this);this.children={}};_.extend(c.prototype,{appendChild:function(a){var b=a.parent,c=a.id;_.isUndefined(b)||delete b.children[c];this.children[c]=a;a.parent=this;return this},render:function(a){var b=this.matrix;a.save();a.transform(b[0],b[1],b[2],b[3],b[4],b[5]);_.each(this.children,function(b){b.render(a)});a.restore();return this}});var d=function(a){_.each(a,function(a,b){this[b]=
a},this)};_.extend(d.prototype,{render:function(a){var c=this.matrix,d=this.stroke,f=this.linewidth,l=this.fill,h=this.opacity,j=this.cap,q=this.join,k=this.miter,r=this.curved,u=this.closed,t=this.commands,A=t.length,z=A-1;if(!this.visible)return this;a.save();c&&a.transform(c[0],c[1],c[2],c[3],c[4],c[5]);l&&(a.fillStyle=l);d&&(a.strokeStyle=d);f&&(a.lineWidth=f);k&&(a.miterLimit=k);q&&(a.lineJoin=q);j&&(a.lineCap=j);_.isNumber(h)&&(a.globalAlpha=h);a.beginPath();_.each(t,function(c,d){var f=c.x.toFixed(3),
l=c.y.toFixed(3);if(r){var j=u?b(d-1,A):Math.max(d-1,0),h=u?b(d+1,A):Math.min(d+1,z),s=t[j],h=t[h],j=s.v.x.toFixed(3),s=s.v.y.toFixed(3),m=c.u.x.toFixed(3),q=c.u.y.toFixed(3);0>=d?a.moveTo(f,l):(a.bezierCurveTo(j,s,m,q,f,l),d>=z&&u&&(j=c.v.x.toFixed(3),s=c.v.y.toFixed(3),m=h.u.x.toFixed(3),q=h.u.y.toFixed(3),f=h.x.toFixed(3),l=h.y.toFixed(3),a.bezierCurveTo(j,s,m,q,f,l)))}else 0>=d?a.moveTo(f,l):a.lineTo(f,l)});u&&!r&&a.closePath();a.fill();a.stroke();a.restore()}});var f={toArray:function(b,c,d){return!c?
_.map(b,function(a){return{x:a.x,y:a.y}}):a(b,d)}},h=Two[Two.Types.canvas]=function(){this.domElement=document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.elements=[];this.stage=null};_.extend(h,{});_.extend(h,{Group:c,Element:d,getStyles:function(a){var b={},c=a.id,d=a._matrix,l=a.stroke,h=a.linewidth,j=a.fill,q=a.opacity,k=a.visible,r=a.cap,u=a.join,t=a.miter,A=a.curved,z=a.closed;a=a.vertices;c&&(b.id=c);_.isObject(d)&&(b.matrix=d.toArray());l&&(b.stroke=l);j&&(b.fill=
j);_.isNumber(q)&&(b.opacity=q);r&&(b.cap=r);u&&(b.join=u);t&&(b.miter=t);h&&(b.linewidth=h);a&&(b.commands=f.toArray(a,A,z));b.visible=!!k;b.curved=!!A;b.closed=!!z;return b},setStyles:function(a,b,c){switch(b){case "matrix":b="matrix";c=c.toArray();break;case "vertices":b="commands",c=f.toArray(c,a.curved,a.closed)}a[b]=c}});_.extend(h.prototype,Backbone.Events,{setSize:function(a,b){this.width=this.domElement.width=a;this.height=this.domElement.height=b;_.extend(this.domElement.style,{width:this.width+
"px",height:this.height+"px"});return this},add:function(a){constructor=Object.getPrototypeOf(this).constructor;var b=a,c=this.elements,d=constructor.Group,f=constructor.Element,h=constructor.getStyles;_.isArray(a)||(b=_.map(arguments,function(a){return a}));_.each(b,function(a){var b;b=a instanceof Two.Group;var g=_.isNull(this.stage);if(_.isUndefined(a.id)){var m=k;k++;a.id=m}b?(b=h.call(this,a),delete b.stroke,delete b.fill,delete b.opacity,delete b.cap,delete b.join,delete b.miter,delete b.linewidth,
b=new d(b),g&&(this.stage=b,this.stage.object=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):b=new f(h.call(this,a));c.push(b);g||this.stage.appendChild(b)},this);return this},update:function(a,b,c){var d=Object.getPrototypeOf(this).constructor,f=this.elements,h=f[a];switch(b){case Two.Properties.hierarchy:_.each(c,function(a){h.appendChild(f[a])});break;default:d.setStyles.call(this,h,b,c)}return this},render:function(){if(_.isNull(this.stage))return this;
this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);return this}})})();(function(){var k=Two[Two.Types.canvas],a=Two.Utils.getCurveFromPoints,b={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",
darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",
forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",
lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370D8",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",
midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#D87093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",
salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",transparent:"#000",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:'#9ACD32"'},c="(?:\\+|-)?\\d+",d="(?:\\+|-)?\\d*\\.\\d+",
f="(?:"+c+")|(?:"+d+")",c="("+c+")",d="("+d+")",f="("+f+")",d=f+"%",h=RegExp(["^hsl(a?)\\(",f,",",d,",",d,"(,",f,")?\\)$"].join("\\s*?")),g=RegExp(["^rgb(a?)\\(",c,",",c,",",c,"(,",f,")?\\)$"].join("\\s*?")),m=RegExp(["^rgb(a?)\\(",d,",",d,",",d,"(,",f,")?\\)$"].join("\\s*?")),p=[function(a){function b(c,d){var f=a.match(c);if(f&&1!==!!f[1]+!!f[5])return{r:Math.min(1,Math.max(0,f[2]/d)),g:Math.min(1,Math.max(0,f[3]/d)),b:Math.min(1,Math.max(0,f[4]/d))}}a=a.replace(/^\s+|\s+$/g,"");var c=b(g,255);
return c?c:b(m,100)},function(a){var c=a.toLowerCase();c in b&&(a=b[c]);if(a.match(/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/)){a=a.replace(/^#/,"");var c=a.length/3,d=Math.pow(16,c)-1;return{r:parseInt(a.slice(0,c),16)/d,g:parseInt(a.slice(1*c,2*c),16)/d,b:parseInt(a.slice(2*c),16)/d}}},function(a){var b=a.replace(/^\s+|\s+$/g,"").match(h);if(!b||1===!!b[1]+!!b[5])return null;a=(b[2]%360+360)%360/360;var c=Math.max(0,Math.min(parseInt(b[3],10)/100,1)),b=Math.max(0,Math.min(parseInt(b[4],10)/100,1));if(0!=
c)var d=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a},f=0.5>b?b*(1+c):b+c-b*c,g=2*b-f;return{r:d(g,f,a+1/3),g:d(g,f,a),b:d(g,f,a-1/3)}}],c=function(a){k.Group.call(this,a)};_.extend(c.prototype,k.Group.prototype,{render:function(a,b,c,d,f){_.each(this.children,function(g){g.render(a,b,c,d,f)})}});f=function(a){k.Element.call(this,a)};_.extend(f.prototype,k.Element.prototype,{render:function(a,b,c,d){if(!this.visible||!this.fillBuffer||!this.strokeBuffer)return this;
a.bindBuffer(a.ARRAY_BUFFER,this.fillBuffer);a.vertexAttribPointer(b,2,a.FLOAT,!1,0,0);a.uniformMatrix3fv(c,!1,this.matrix);a.uniform4f(d,this.fill.r,this.fill.g,this.fill.b,this.opacity);a.drawArrays(a.TRIANGLES,0,this.triangleAmount);if(0>=this.linewidth)return this;a.bindBuffer(a.ARRAY_BUFFER,this.strokeBuffer);a.vertexAttribPointer(b,2,a.FLOAT,!1,0,0);a.uniformMatrix3fv(c,!1,this.matrix);a.uniform4f(d,this.stroke.r,this.stroke.g,this.stroke.b,this.opacity);a.lineWidth(this.linewidth);a.drawArrays(a.LINES,
0,this.vertexAmount);return this}});var n={updateBuffer:function(a,b,c){_.isObject(b.fillBuffer)&&a.deleteBuffer(b.fillBuffer);b.fillBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.fillBuffer);a.enableVertexAttribArray(c);a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW);_.isObject(b.strokeBuffer)&&a.deleteBuffer(b.strokeBuffer);b.strokeBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.strokeBuffer);a.enableVertexAttribArray(c);a.bufferData(a.ARRAY_BUFFER,b.vertices,a.STATIC_DRAW)},
interpret:function(a){for(var b=0,c=p.length;b<c;b++){var d=p[b](a);if(d)return d}return{r:0,g:0,b:0}},toArray:function(b,c,d){if(!c)return b;var f=a(b,d),g=f.length,h=g-1,m=[];_.each(f,function(a,b){if(d||!d&&b<h){var c=f[(b+1)%g],c=Two.Utils.subdivide(a.x,a.y,a.v.x,a.v.y,c.u.x,c.u.y,c.x,c.y);m=m.concat(c)}});return m},tessellate:function(a,b,c,d,f){a=new tessellation.SweepContext(a);tessellation.sweep.Triangulate(a);var g=d||new Two.Array(6*a.triangles.length);_.each(a.triangles,function(a,b){var c=
a.points,d=c[0],f=c[1],c=c[2],h=6*b;g[h+0]=d.x;g[h+1]=d.y;g[h+2]=f.x;g[h+3]=f.y;g[h+4]=c.x;g[h+5]=c.y});var h=f||new Two.Array(4*a.edges.length);_.each(a.edges,function(a,b){var c=a.p,d=a.q,f=4*b;h[f]=c.x;h[f+1]=c.y;h[f+2]=d.x;h[f+3]=d.y});return{triangles:g,vertices:h}},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)});a.linkProgram(c);if(!a.getProgramParameter(c,a.LINK_STATUS))throw error=a.getProgramInfoLog(c),new Two.Utils.Error("unable to link program: "+
error);return c}},shaders:{create:function(a,b,c){c=a.createShader(a[c]);a.shaderSource(c,b);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw a=a.getShaderInfoLog(c),new Two.Utils.Error("unable to compile shader "+c+": "+a);return c},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 position;\nuniform mat3 matrix;\nuniform vec2 resolution;\n\nvoid main() {\n   vec2 projected = (matrix * vec3(position, 1)).xy;\n   vec2 normal = projected / resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n}",
fragment:"precision mediump float;\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}"}},d=Two[Two.Types.webgl]=function(){this.domElement=document.createElement("canvas");this.elements=[];this.stage=null;var a={antialias:!0,premultipliedAlpha:!1};this.ctx=this.domElement.getContext("webgl",a)||this.domElement.getContext("experimental-webgl",a);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var a=n.shaders.create(this.ctx,n.shaders.vertex,
n.shaders.types.vertex),b=n.shaders.create(this.ctx,n.shaders.fragment,n.shaders.types.fragment);this.program=n.program.create(this.ctx,[a,b]);this.ctx.useProgram(this.program);this.positionLocation=this.ctx.getAttribLocation(this.program,"position");this.colorLocation=this.ctx.getUniformLocation(this.program,"color");this.matrixLocation=this.ctx.getUniformLocation(this.program,"matrix")};_.extend(d,{Group:c,Element:f,getStyles:function(a){var b={},c=a.id,d=a._matrix,f=a.stroke,g=a.linewidth,h=a.fill,
m=a.opacity,k=a.visible,p=a.cap,e=a.join,v=a.miter,G=a.curved,H=a.closed;a=a.vertices;c&&(b.id=c);_.isObject(d)&&(b.matrix=d.toArray(!0));f&&(b.stroke=n.interpret(f));h&&(b.fill=n.interpret(h));_.isNumber(m)&&(b.opacity=m);p&&(b.cap=p);e&&(b.join=e);v&&(b.miter=v);g&&(b.linewidth=g);a&&(a=n.toArray(a,G,H),c=n.tessellate(a,G,H),b.triangles=c.triangles,b.vertices=c.vertices,b.vertexAmount=b.vertices.length/2,b.triangleAmount=b.triangles.length/2);b.visible=!!k;b.curved=!!G;b.closed=!!H;return b},setStyles:function(a,
b,c){switch(b){case "matrix":b="matrix";c=c.toArray(!0);break;case "stroke":c=n.interpret(c);break;case "fill":c=n.interpret(c);break;case "vertices":b="triangles";c=n.toArray(c,a.curved,a.closed);var d=n.tessellate(c,a.curved,a.closed,a.triangles,a.vertices);c=d.triangles;a.vertices=d.vertices;a.vertexAmount=a.vertices.length/2}a[b]=c;"triangles"===b&&(n.updateBuffer(this.ctx,a,this.positionLocation),a.triangleAmount=a.triangles.length/2)}});_.extend(d.prototype,Backbone.Events,k.prototype,{setSize:function(a,
b){k.prototype.setSize.apply(this,arguments);this.ctx.viewport(0,0,a,b);var c=this.ctx.getUniformLocation(this.program,"resolution");this.ctx.uniform2f(c,a,b);return this},render:function(){if(_.isNull(this.stage))return this;var a=this.ctx;a.clear(a.COLOR_BUFFER_BIT);this.stage.render(a,this.positionLocation,this.matrixLocation,this.colorLocation);return this}})})();(function(){var k=Two.Vector=function(a,b){a=a||0;b=b||0;Object.defineProperty(this,"x",{get:function(){return a},set:function(b){a=b;this.trigger("change","x")}});Object.defineProperty(this,"y",{get:function(){return b},set:function(a){b=a;this.trigger("change","y")}})};_.extend(k,{});_.extend(k.prototype,Backbone.Events,{set:function(a,b){this.x=a;this.y=b;return this},copy:function(a){this.x=a.x;this.y=a.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new k(this.x,
this.y)},add:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addSelf:function(a){this.x+=a.x;this.y+=a.y;return this},sub:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},subSelf:function(a){this.x-=a.x;this.y-=a.y;return this},multiplySelf:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){a?(this.x/=a,this.y/=a):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*
a.x+this.y*a.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){return this.normalize().multiplyScalar(a)},equals:function(a){return 1E-4>this.distanceTo(a)},lerp:function(a,b){return this.set((a.x-this.x)*
b+this.x,(a.y-this.y)*b+this.y)},isZero:function(){return 1E-4>this.length()}})})();(function(){_.range(6);var k=Math.cos,a=Math.sin,b=Math.tan,c=Two.Matrix=function(a,b,c,g,m,k){this.elements=new Two.Array(9);var n=a;_.isArray(n)||(n=_.toArray(arguments));this.identity().set(n)};_.extend(c,{Identity:[1,0,0,0,1,0,0,0,1]});_.extend(c.prototype,{set:function(a,b,c,g,m,k){var n=a;_.isArray(n)||(n=_.toArray(arguments));_.each(n,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this},identity:function(){this.set(c.Identity);return this},multiply:function(a,b,c,g,m,k,n,l,
s){var j=arguments,q=j.length;if(1>=q)return _.each(this.elements,function(b,c){this.elements[c]=b*a},this),this;if(3>=q)return a=a||0,b=b||0,c=c||0,m=this.elements,{x:m[0]*a+m[1]*b+m[2]*c,y:m[3]*a+m[4]*b+m[5]*c,z:m[6]*a+m[7]*b+m[8]*c};q=this.elements;A0=q[0];A1=q[1];A2=q[2];A3=q[3];A4=q[4];A5=q[5];A6=q[6];A7=q[7];A8=q[8];B0=j[0];B1=j[1];B2=j[2];B3=j[3];B4=j[4];B5=j[5];B6=j[6];B7=j[7];B8=j[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;
this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this},scale:function(a,b){1>=arguments.length&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(b){var c=k(b);b=a(b);return this.multiply(c,-b,0,b,c,0,0,0,1)},translate:function(a,b){return this.multiply(1,0,a,0,1,b,0,0,1)},skewX:function(a){a=b(a);return this.multiply(1,
a,0,0,1,0,0,0,1)},skewY:function(a){a=b(a);return this.multiply(1,0,0,a,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(a){var b=this.elements,c=parseFloat(b[0].toFixed(3)),g=parseFloat(b[1].toFixed(3)),m=parseFloat(b[2].toFixed(3)),k=parseFloat(b[3].toFixed(3)),n=parseFloat(b[4].toFixed(3)),l=parseFloat(b[5].toFixed(3));if(a){a=parseFloat(b[6].toFixed(3));var s=parseFloat(b[7].toFixed(3)),b=parseFloat(b[8].toFixed(3));return[c,k,a,g,n,s,m,l,b]}return[c,k,g,n,m,l]},
clone:function(){return new Two.Matrix(this.elements.slice(0))}})})();(function(){var k=Two.Shape=function(a){this._matrix=new Two.Matrix;var b=_.debounce(_.bind(function(){var a=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",a)},this),0);this._rotation="rotation";Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(a){this._rotation=a;b()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(a){this._scale=a;b()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,b);if(a)return this;k.MakeGetterSetter(this,k.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.miter=this.join=this.cap="round"};_.extend(k,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]);_.each(b,function(b){var d="_"+b;Object.defineProperty(a,
b,{get:function(){return this[d]},set:function(a){this[d]=a;this.trigger(Two.Events.change,this.id,b,a,this)}})})}});_.extend(k.prototype,Backbone.Events,{addTo:function(a){a.add(this);return this},noFill:function(){this.fill="none";return this},noStroke:function(){this.stroke="none";return this},clone:function(){var a=new k;a.translation.copy(this.translation);_.each(k.Properties,function(b){a[b]=this[b]},this);return this}})})();(function(){var k=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;k.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(k,{MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]);_.each(b,function(b){var d="_"+b;Object.defineProperty(a,b,{get:function(){return this[d]},set:function(a){this[d]=a;_.each(this.children,function(d){d[b]=a})}})})}});_.extend(k.prototype,
Two.Shape.prototype,{add:function(a){var b=a,c=this.children,d=this.parent,f=[];_.isArray(a)||(b=_.toArray(arguments));var h=_.bind(function(a,b,c,d,f){this.trigger(Two.Events.change,a,b,c,d,f)},this);_.each(b,function(a){var b=a.id,k=a.parent;_.isUndefined(b)&&(d.add(a),b=a.id);_.isUndefined(c[b])&&(k&&delete k.children[b],c[b]=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,h),f.push(b))},this);0<f.length&&this.trigger(Two.Events.change,this.id,"hierarchy",f);return this},getBoundingClientRect:function(){var a=
Infinity,b=-Infinity,c=Infinity,d=-Infinity;_.each(this.children,function(f){f=f.getBoundingClientRect();c=Math.min(f.top,c);a=Math.min(f.left,a);b=Math.max(f.right,b);d=Math.max(f.bottom,d)},this);var f=this._matrix.multiply(a,c,1),h=this._matrix.multiply(b,d,1);return{top:f.y,left:f.x,right:h.x,bottom:h.y,width:h.x-f.x,height:h.y-f.y}},noFill:function(){_.each(this.children,function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this}})})();(function(){var k=Math.min,a=Math.max,b=Math.round,c=Two.Polygon=function(c,f,h){Two.Shape.call(this);f=!!f;h=!!h;var g=0,m=1,p=!1,n=c.slice(0),l=_.debounce(_.bind(function(){var a,c;if(p){a=this.vertices.length;a-=1;c=b(g*a);a=b(m*a);for(n.length=0;c<a+1;c++){var d=this.vertices[c];n.push(new Two.Vector(d.x,d.y))}p=!1}this.trigger(Two.Events.change,this.id,"vertices",n,this.closed,this.curved)},this),0);Object.defineProperty(this,"closed",{get:function(){return f},set:function(a){f=!!a;l()}});Object.defineProperty(this,
"curved",{get:function(){return h},set:function(a){h=!!a;l()}});Object.defineProperty(this,"beginning",{get:function(){return g},set:function(b){g=k(a(b,0),1);p=!0;l()}});Object.defineProperty(this,"ending",{get:function(){return m},set:function(b){m=k(a(b,0),1);p=!0;l()}});this.vertices=c.slice(0);_.each(this.vertices,function(a){a.bind(Two.Events.change,l)},this);l()};_.extend(c,{});_.extend(c.prototype,Two.Shape.prototype,{clone:function(){var a=_.map(this.vertices,function(a){return new Two.Vector(a.x,
a.y)}),b=new c(a,this.closed,this.curved);_.each(Two.Shape.Properties,function(a){b[a]=this[a]},this);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},getBoundingClientRect:function(){var a=this.linewidth,b=Infinity,c=-Infinity,g=Infinity,k=-Infinity;_.each(this.vertices,function(a){var d=a.x;a=a.y;g=Math.min(a,g);b=Math.min(d,b);c=Math.max(d,c);k=Math.max(a,k)});var g=g-a,b=b-a,c=c+a,k=k+a,a=this._matrix.multiply(b,g,1),p=this._matrix.multiply(c,k,1);return{top:a.y,
left:a.x,right:p.x,bottom:p.y,width:p.x-a.x,height:p.y-a.y}}})})();
